{
  "version": 4,
  "terraform_version": "1.2.5",
  "serial": 13,
  "lineage": "62e71a5b-b04f-fdd2-f7b8-1ff4ea5a00f4",
  "outputs": {
    "objects": {
      "value": {
        "azurerm_automation_account": {
          "management": {}
        },
        "azurerm_dns_zone": {
          "connectivity": {}
        },
        "azurerm_express_route_gateway": {
          "virtual_wan": {}
        },
        "azurerm_firewall": {
          "connectivity": {},
          "virtual_wan": {}
        },
        "azurerm_firewall_policy": {
          "connectivity": {},
          "virtual_wan": {}
        },
        "azurerm_log_analytics_linked_service": {
          "management": {}
        },
        "azurerm_log_analytics_solution": {
          "management": {}
        },
        "azurerm_log_analytics_workspace": {
          "management": {}
        },
        "azurerm_management_group": {
          "level_1": {
            "/providers/Microsoft.Management/managementGroups/vcfes": {
              "display_name": "VCF OBS CAF LZ Rover",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "name": "vcfes",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
              "subscription_ids": [
                "a9c7991e-521c-4532-93a9-5a37f82ccaed"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-root": {
              "display_name": "VCF OBS CAF LZ Rover",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-root",
              "name": "vcfes-root",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
              "subscription_ids": [],
              "timeouts": null
            }
          },
          "level_2": {
            "/providers/Microsoft.Management/managementGroups/vcfes-decommissioned": {
              "display_name": "Decommissioned",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-decommissioned",
              "name": "vcfes-decommissioned",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones": {
              "display_name": "Landing Zones",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "name": "vcfes-landing-zones",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-platform": {
              "display_name": "Platform",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
              "name": "vcfes-platform",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-sandboxes": {
              "display_name": "Sandboxes",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-sandboxes",
              "name": "vcfes-sandboxes",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "subscription_ids": [],
              "timeouts": null
            }
          },
          "level_3": {
            "/providers/Microsoft.Management/managementGroups/vcfes-connectivity": {
              "display_name": "Connectivity",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity",
              "name": "vcfes-connectivity",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-corp": {
              "display_name": "Corp",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-corp",
              "name": "vcfes-corp",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-identity": {
              "display_name": "Identity",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
              "name": "vcfes-identity",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-management": {
              "display_name": "Management",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-management",
              "name": "vcfes-management",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-online": {
              "display_name": "Online",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
              "name": "vcfes-online",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "subscription_ids": [],
              "timeouts": null
            }
          },
          "level_4": {
            "/providers/Microsoft.Management/managementGroups/vcfes-corp-non-prod": {
              "display_name": "Non Production",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-corp-non-prod",
              "name": "vcfes-corp-non-prod",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-corp",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-corp-prod": {
              "display_name": "Production",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-corp-prod",
              "name": "vcfes-corp-prod",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-corp",
              "subscription_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-online-web": {
              "display_name": "Non Production",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-online-web",
              "name": "vcfes-online-web",
              "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
              "subscription_ids": [],
              "timeouts": null
            }
          },
          "level_5": {},
          "level_6": {}
        },
        "azurerm_management_group_policy_assignment": {
          "enterprise_scale": {
            "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET": {
              "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
              "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
              "enforce": false,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "e3dca87c-4eda-4839-89a8-ea94a494eb06",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:39.4016858Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Enable-DDoS-VNET",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-ddos/providers/Microsoft.Network/ddosProtectionPlans/vcfes-ddos-francecentral\"},\"effect\":{\"value\":\"Modify\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP": {
              "description": "This policy denies creation of Public IPs under the assigned scope.",
              "display_name": "Deny the creation of public IP",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:34.9144803Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-Public-IP",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet": {
              "description": "This policy denies any network security rule that allows RDP access from Internet.",
              "display_name": "RDP access from the Internet should be blocked",
              "enforce": false,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9300217Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-RDP-From-Internet",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg": {
              "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
              "display_name": "Subnets should have a Network Security Group",
              "enforce": false,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9429202Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-Subnet-Without-Nsg",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup": {
              "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
              "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
              "enforce": false,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "337397ea-629a-4e54-84ba-86f1b64a5aac",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:16.2916284Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-VM-Backup",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"effect\":{\"value\":\"deployIfNotExists\"},\"exclusionTagName\":{\"value\":\"\"},\"exclusionTagValue\":{\"value\":[]}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding": {
              "description": "This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure's check of the source and destination for a network interface. This should be reviewed by the network security team.",
              "display_name": "Network interfaces should disable IP forwarding",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9456782Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-IP-Forwarding",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS": {
              "description": "Do not allow privileged containers creation in a Kubernetes cluster. This recommendation is part of CIS 5.2.1 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
              "display_name": "Kubernetes cluster should not allow privileged containers",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:35.0992108Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-Priv-Containers-AKS",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"effect\":{\"value\":\"deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS": {
              "description": "Do not allow containers to run with privilege escalation to root in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
              "display_name": "Kubernetes clusters should not allow container privilege escalation",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:11.724707Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-Priv-Escalation-AKS",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"effect\":{\"value\":\"deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet": {
              "description": "This policy denies any network security rule that allows RDP access from Internet.",
              "display_name": "RDP access from the Internet should be blocked",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9369267Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-RDP-From-Internet",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http": {
              "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
              "display_name": "Secure transfer to storage accounts should be enabled",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.918587Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-Storage-http",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg": {
              "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
              "display_name": "Subnets should have a Network Security Group",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9299613Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-Subnet-Without-Nsg",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy": {
              "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
              "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "2670d7f6-ade2-4981-a7db-8b96887c805a",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:35.7856993Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-AKS-Policy",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing": {
              "description": "Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.",
              "display_name": "Auditing on SQL server should be enabled",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "8457a13d-58fe-491d-9e92-43304c7215f2",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:54.3246555Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-SQL-DB-Auditing",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat": {
              "description": "This policy ensures that Threat Detection is enabled on SQL Servers.",
              "display_name": "Deploy Threat Detection on SQL servers",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "95fd991f-4b44-4632-9956-ec717353044f",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:15.5739792Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-SQL-Threat",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup": {
              "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
              "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "b41dd1e8-60ba-413d-8b9e-c730f7f66a8c",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:12.233736Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-VM-Backup",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET": {
              "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
              "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
              "enforce": false,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "e5e508e4-16f8-4917-8d92-736b1713b736",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:54.2619858Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Enable-DDoS-VNET",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-ddos/providers/Microsoft.Network/ddosProtectionPlans/vcfes-ddos-francecentral\"},\"effect\":{\"value\":\"Modify\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS": {
              "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc.",
              "display_name": "Kubernetes clusters should be accessible only over HTTPS",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9152357Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Enforce-AKS-HTTPS",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"effect\":{\"value\":\"deny\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL": {
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing exsistense condition require then the combination of Audit.",
              "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "3187194f-5bd4-417f-ad65-e0249d4d9b9b",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:38.723724Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Enforce-TLS-SSL",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics": {
              "description": "Deploy-Log-Analytics.",
              "display_name": "Deploy-Log-Analytics",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "446ee1d3-e350-49d8-8959-063aa4d2869f",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-management",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:39.2609939Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-Log-Analytics",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"automationAccountName\":{\"value\":\"vcfes-automation\"},\"automationRegion\":{\"value\":\"francecentral\"},\"dataRetention\":{\"value\":\"30\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"rgName\":{\"value\":\"vcfes-mgmt\"},\"sku\":{\"value\":\"pergb2018\"},\"workspaceName\":{\"value\":\"vcfes-la\"},\"workspaceRegion\":{\"value\":\"francecentral\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations": {
              "description": "Specifies the allowed locations (regions) where Resource Groups can be deployed.",
              "display_name": "Limit allowed locations for Resource Groups",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:13:48.3327302Z\",\"updatedBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"updatedOn\":\"2022-09-18T12:57:34.1976276Z\"}",
              "name": "Deny-RSG-Locations",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"francecentral\",\"francesouth\"]}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations": {
              "description": "Specifies the allowed locations (regions) where Resources can be deployed.",
              "display_name": "Limit allowed locations for Resources",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:13:48.3810603Z\",\"updatedBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"updatedOn\":\"2022-09-18T12:57:34.1904776Z\"}",
              "name": "Deny-Resource-Locations",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"francecentral\",\"francesouth\"]}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations": {
              "description": "Specifies the allowed locations (regions) where Resource Groups can be deployed.",
              "display_name": "Limit allowed locations for Resource Groups",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-root",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T14:24:39.2662673Z\",\"updatedBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"updatedOn\":\"2022-09-18T14:30:10.5036766Z\"}",
              "name": "Deny-RSG-Locations",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"francecentral\",\"francesouth\"]}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring": {
              "description": "Enable Monitoring in Azure Security Center.",
              "display_name": "Enable Monitoring in Azure Security Center",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
              "identity": [],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:32.7113911Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-ASC-Monitoring",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"aadAuthenticationInSqlServerMonitoringEffect\":{\"value\":\"Disabled\"},\"diskEncryptionMonitoringEffect\":{\"value\":\"Disabled\"},\"encryptionOfAutomationAccountMonitoringEffect\":{\"value\":\"Disabled\"},\"identityDesignateLessThanOwnersMonitoringEffect\":{\"value\":\"Disabled\"},\"identityDesignateMoreThanOneOwnerMonitoringEffect\":{\"value\":\"Disabled\"},\"identityEnableMFAForWritePermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveDeprecatedAccountMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"jitNetworkAccessMonitoringEffect\":{\"value\":\"Disabled\"},\"networkSecurityGroupsOnSubnetsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlDbEncryptionMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlServerAdvancedDataSecurityMonitoringEffect\":{\"value\":\"Disabled\"},\"systemUpdatesMonitoringEffect\":{\"value\":\"Disabled\"},\"useRbacRulesMonitoringEffect\":{\"value\":\"Disabled\"},\"vmssSystemUpdatesMonitoringEffect\":{\"value\":\"Disabled\"},\"windowsDefenderExploitGuardMonitoringEffect\":{\"value\":\"Disabled\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log": {
              "description": "Ensures that Activity Log Diagnostics settings are set to push logs into Log Analytics workspace.",
              "display_name": "Deploy Diagnostic Settings for Activity Log to Log Analytics workspace",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "d6e1bc35-0ca2-4548-960c-7e0fd459f27c",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:35.946828Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-AzActivity-Log",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-LX-Arc-Monitoring": {
              "description": "Deploy-Linux-Arc-Monitoring.",
              "display_name": "Deploy-Linux-Arc-Monitoring",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-LX-Arc-Monitoring",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "326a98f6-e2ef-4a24-a680-4bfc73e4dd8a",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:14.0532074Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-LX-Arc-Monitoring",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config": {
              "description": "Deploy Microsoft Defender for Cloud and Security Contacts",
              "display_name": "Deploy Microsoft Defender for Cloud configuration",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "d06972c8-86ed-4280-b446-1c6f06f7f49b",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:54.3150265Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-MDFC-Config",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"ascExportResourceGroupLocation\":{\"value\":\"francecentral\"},\"ascExportResourceGroupName\":{\"value\":\"vcfes-asc-export\"},\"emailSecurityContact\":{\"value\":\"security_contact@replace_me\"},\"enableAscForAppServices\":{\"value\":\"DeployIfNotExists\"},\"enableAscForArm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForContainers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForDns\":{\"value\":\"DeployIfNotExists\"},\"enableAscForKeyVault\":{\"value\":\"DeployIfNotExists\"},\"enableAscForOssDb\":{\"value\":\"DeployIfNotExists\"},\"enableAscForServers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSql\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSqlOnVm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForStorage\":{\"value\":\"DeployIfNotExists\"},\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag": {
              "description": "Ensures that Azure resources are configured to forward diagnostic logs and metrics to an Azure Log Analytics workspace.",
              "display_name": "Deploy-Resource-Diag",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "149b5d6b-5dcf-4170-b8b6-068c64e65db1",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:13.8351139Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-Resource-Diag",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring": {
              "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
              "display_name": "Enable Azure Monitor for VMs",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "5f378ab8-6e7a-4757-b8f0-a31145b39f55",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:38.0105742Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-VM-Monitoring",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring": {
              "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
              "display_name": "Enable Azure Monitor for Virtual Machine Scale Sets",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "1f6143ea-79c0-4005-a2d6-670ec56d86e6",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:16.5153098Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-VMSS-Monitoring",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-WS-Arc-Monitoring": {
              "description": "Deploys the Log Analytics agent to Windows Azure Arc machines if the agent isn't installed.",
              "display_name": "Deploy-Windows-Arc-Monitoring",
              "enforce": true,
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-WS-Arc-Monitoring",
              "identity": [
                {
                  "identity_ids": [],
                  "principal_id": "d446ce0e-2340-49e3-8e98-014320208b3e",
                  "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                  "type": "SystemAssigned"
                }
              ],
              "location": "francecentral",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:33.642278Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deploy-WS-Arc-Monitoring",
              "non_compliance_message": [],
              "not_scopes": [],
              "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
              "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
              "timeouts": null
            }
          }
        },
        "azurerm_management_group_subscription_association": {
          "enterprise_scale": {}
        },
        "azurerm_network_ddos_protection_plan": {
          "connectivity": {}
        },
        "azurerm_policy_definition": {
          "enterprise_scale": {
            "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/VCF-Deploy-Nsg-FlowLogs": {
              "description": "VCF-Deploy-Nsg-FlowLogs Policy Definition at scope /providers/Microsoft.Management/managementGroups/vcfes-root",
              "display_name": "CAF - Enable Nsg flowlogs and traffic analytics.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/VCF-Deploy-Nsg-FlowLogs",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-root",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T16:05:39.270113Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "mode": "Indexed",
              "name": "VCF-Deploy-Nsg-FlowLogs",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"flowAnalyticsEnabled\":{\"type\":\"String\",\"defaultValue\":\"true\",\"metadata\":{\"description\":\"Enable Traffic Analytics\",\"displayName\":\"Enable Traffic Analytics\"}},\"interval\":{\"type\":\"String\",\"defaultValue\":\"60\",\"metadata\":{\"description\":\"Traffic Analytics processing interval mins (10/60)\",\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}},\"logAnalytics\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"retention\":{\"type\":\"String\",\"defaultValue\":\"2\",\"metadata\":{\"description\":\"Retention days in storage account. If you want to retain data forever and do not want to apply any retention policy, set retention (days) to 0.\",\"displayName\":\"Retention days in storage account. If you want to retain data forever and do not want to apply any retention policy, set retention (days) to 0.\"}},\"storageAccountResourceId\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Storage Account Resource Id\",\"displayName\":\"Storage Account Resource Id\",\"strongType\":\"Microsoft.Storage/storageAccounts\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"flowAnalyticsEnabled\":{\"value\":\"[bool(parameters('flowAnalyticsEnabled'))]\"},\"interval\":{\"value\":\"[int(parameters('interval'))]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"networkSecurityGroup\":{\"value\":\"[field('id')]\"},\"retention\":{\"value\":\"[int(parameters('retention'))]\"},\"storageAccountResourceId\":{\"value\":\"[parameters('storageAccountResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"location\":\"[parameters('location')]\",\"outputs\":{},\"parameters\":{\"flowAnalyticsEnabled\":{\"type\":\"bool\"},\"interval\":{\"type\":\"int\"},\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"networkSecurityGroup\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"storageAccountResourceId\":{\"type\":\"String\"},\"time\":{\"defaultValue\":\"[utcNow()]\",\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[take(concat('NetworkWatcherRG', '.', variables('securityGroupName')), 64)]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('NetworkWatcher_', toLower(parameters('location')))]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-11-01\",\"dependsOn\":[\"[concat('NetworkWatcher_', toLower(parameters('location')))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('securityGroupName'), '-Network-flowlog')]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":\"[bool(parameters('flowAnalyticsEnabled'))]\",\"trafficAnalyticsInterval\":\"[parameters('interval')]\",\"workspaceRegion\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]\",\"workspaceResourceId\":\"[parameters('logAnalytics')]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[parameters('storageAccountResourceId')]\",\"targetResourceId\":\"[parameters('networkSecurityGroup')]\"},\"type\":\"flowLogs\"}],\"type\":\"Microsoft.Network/networkWatchers\"}]}},\"resourceGroup\":\"NetworkWatcherRG\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"securityGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[8]]\"}}}},\"existenceCondition\":{\"allof\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"},{\"equals\":\"[bool(parameters('flowAnalyticsEnabled'))]\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled\"},{\"equals\":\"[parameters('interval')]\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.trafficAnalyticsInterval\"},{\"equals\":\"[parameters('retention')]\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/retentionPolicy.days\"}]},\"name\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\"resourceGroupName\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/VCF-Enforce-RG-Tags": {
              "description": "Enforce mandatory 'Owner' and 'Department' tags on Resource Groups",
              "display_name": "Resource groups must have mandatory tagging applied",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/VCF-Enforce-RG-Tags",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-root",
              "metadata": "{\"category\":\"Tags\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T16:05:39.3010516Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "VCF-Enforce-RG-Tags",
              "parameters": "{\"Department\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the Department that the Resource Group belongs to\",\"displayName\":\"Department\"}},\"Owner\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the Owner of the Resource Group'\",\"displayName\":\"Owner\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions/resourceGroups\",\"field\":\"type\"},{\"anyof\":[{\"exists\":\"false\",\"field\":\"[concat('tags[', parameters('Owner'), ']')]\"},{\"exists\":\"false\",\"field\":\"[concat('tags[', parameters('Department'), ']')]\"}]}]},\"then\":{\"effect\":\"deny\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly": {
              "description": "Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
              "display_name": "AppService append enable https only setting to enforce https setting.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.6802249Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Append-AppService-httpsonly",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"notequals\":true}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"value\":true}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS": {
              "description": "Append the AppService sites object to ensure that min Tls version is set to required minimum TLS version. Please note Append does not enforce compliance use then deny.",
              "display_name": "AppService append sites with minimum TLS version to enforce.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.3576005Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Append-AppService-latestTLS",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"Select version minimum TLS Web App config\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites/config\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"notEquals\":\"[parameters('minTlsVersion')]\"}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"value\":\"[parameters('minTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete": {
              "description": "This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added.",
              "display_name": "KeyVault SoftDelete should be enabled",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Key Vault\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.5648353Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Append-KV-SoftDelete",
              "parameters": "",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"notEquals\":true}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"value\":true}],\"effect\":\"append\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort": {
              "description": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Cache\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.386986Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Append-Redis-disableNonSslPort",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\",\"Modify\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\",\"value\":false}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement": {
              "description": "Append a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Cache for Redis Append a specific min TLS version requirement and enforce TLS.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Cache\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.8616813Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Append-Redis-sslEnforcement",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Cache for Redis to enforce\",\"displayName\":\"Select version for Redis server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"value\":\"[parameters('minimumTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId": {
              "description": "Audit private endpoints that are created in other subscriptions and/or tenants for Azure Machine Learning.",
              "display_name": "Control private endpoint connections to Azure Machine Learning",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:19.0321205Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Audit-MachineLearning-PrivateEndpointId",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections\",\"field\":\"type\"},{\"equals\":\"Approved\",\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateLinkServiceConnectionState.status\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id\"},{\"notEquals\":\"[subscription().subscriptionId]\",\"value\":\"[split(concat(field('Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id'), '//'), '/')[2]]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources": {
              "description": "This policy denies the creation of child resources on the Automation Account",
              "display_name": "No child resources in Automation Account",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Automation\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:49.8329248Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AA-child-resources",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Automation/automationAccounts/runbooks\",\"Microsoft.Automation/automationAccounts/variables\",\"Microsoft.Automation/automationAccounts/modules\",\"Microsoft.Automation/automationAccounts/credentials\",\"Microsoft.Automation/automationAccounts/connections\",\"Microsoft.Automation/automationAccounts/certificates\"]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF": {
              "description": "This policy enables you to restrict that Application Gateways is always deployed with WAF enabled",
              "display_name": "Application Gateway should be deployed with WAF enabled",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.8818907Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppGW-Without-WAF",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/applicationGateways/sku.name\",\"notequals\":\"WAF_v2\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http": {
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "display_name": "API App should only be accessible over HTTPS",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:15.6067285Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppServiceApiApp-http",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http": {
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "display_name": "Function App should only be accessible over HTTPS",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:44.3702506Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppServiceFunctionApp-http",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"functionapp*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http": {
              "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
              "display_name": "Web Application should only be accessible over HTTPS",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.9623788Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-AppServiceWebApp-http",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"app*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp": {
              "description": "Denies the deployment of workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.",
              "display_name": "Deny public IPs for Databricks cluster",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Databricks\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.8372514Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Databricks-NoPublicIp",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku": {
              "description": "Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for AAD.",
              "display_name": "Deny non-premium Databricks sku",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Databricks\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.35968Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Databricks-Sku",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/sku.name\",\"notEquals\":\"premium\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork": {
              "description": "Enforces the use of vnet injection for Databricks workspaces.",
              "display_name": "Deny Databricks workspaces without Vnet injection",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Databricks\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:10.9513932Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Databricks-VirtualNetwork",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customVirtualNetworkId.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPublicSubnetName.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPrivateSubnetName.value\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks": {
              "description": "Deny AKS cluster creation in Azure Machine Learning and enforce connecting to existing clusters.",
              "display_name": "Deny AKS cluster creation in Azure Machine Learning",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:49.6564916Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-Aks",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AKS\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/resourceId\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/resourceId'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId": {
              "description": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances.",
              "display_name": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.8262253Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-Compute-SubnetId",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/subnet.id\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize": {
              "description": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances.",
              "display_name": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Budget\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:48.2571454Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-Compute-VmSize",
              "parameters": "{\"allowedVmSizes\":{\"type\":\"Array\",\"defaultValue\":[\"Standard_D1_v2\",\"Standard_D2_v2\",\"Standard_D3_v2\",\"Standard_D4_v2\",\"Standard_D11_v2\",\"Standard_D12_v2\",\"Standard_D13_v2\",\"Standard_D14_v2\",\"Standard_DS1_v2\",\"Standard_DS2_v2\",\"Standard_DS3_v2\",\"Standard_DS4_v2\",\"Standard_DS5_v2\",\"Standard_DS11_v2\",\"Standard_DS12_v2\",\"Standard_DS13_v2\",\"Standard_DS14_v2\",\"Standard_M8-2ms\",\"Standard_M8-4ms\",\"Standard_M8ms\",\"Standard_M16-4ms\",\"Standard_M16-8ms\",\"Standard_M16ms\",\"Standard_M32-8ms\",\"Standard_M32-16ms\",\"Standard_M32ls\",\"Standard_M32ms\",\"Standard_M32ts\",\"Standard_M64-16ms\",\"Standard_M64-32ms\",\"Standard_M64ls\",\"Standard_M64ms\",\"Standard_M64s\",\"Standard_M128-32ms\",\"Standard_M128-64ms\",\"Standard_M128ms\",\"Standard_M128s\",\"Standard_M64\",\"Standard_M64m\",\"Standard_M128\",\"Standard_M128m\",\"Standard_D1\",\"Standard_D2\",\"Standard_D3\",\"Standard_D4\",\"Standard_D11\",\"Standard_D12\",\"Standard_D13\",\"Standard_D14\",\"Standard_DS15_v2\",\"Standard_NV6\",\"Standard_NV12\",\"Standard_NV24\",\"Standard_F2s_v2\",\"Standard_F4s_v2\",\"Standard_F8s_v2\",\"Standard_F16s_v2\",\"Standard_F32s_v2\",\"Standard_F64s_v2\",\"Standard_F72s_v2\",\"Standard_NC6s_v3\",\"Standard_NC12s_v3\",\"Standard_NC24rs_v3\",\"Standard_NC24s_v3\",\"Standard_NC6\",\"Standard_NC12\",\"Standard_NC24\",\"Standard_NC24r\",\"Standard_ND6s\",\"Standard_ND12s\",\"Standard_ND24rs\",\"Standard_ND24s\",\"Standard_NC6s_v2\",\"Standard_NC12s_v2\",\"Standard_NC24rs_v2\",\"Standard_NC24s_v2\",\"Standard_ND40rs_v2\",\"Standard_NV12s_v3\",\"Standard_NV24s_v3\",\"Standard_NV48s_v3\"],\"metadata\":{\"description\":\"Specifies the allowed VM Sizes for Aml Compute Clusters and Instances\",\"displayName\":\"Allowed VM Sizes for Aml Compute Clusters and Instances\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/vmSize\",\"notIn\":\"[parameters('allowedVmSizes')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess": {
              "description": "Deny public access of Azure Machine Learning clusters via SSH.",
              "display_name": "Deny public access of Azure Machine Learning clusters via SSH",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:19.1383045Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale": {
              "description": "Enforce scale settings for Azure Machine Learning compute clusters.",
              "display_name": "Enforce scale settings for Azure Machine Learning compute clusters",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Budget\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:23.0919624Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-ComputeCluster-Scale",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"maxNodeCount\":{\"type\":\"Integer\",\"defaultValue\":10,\"metadata\":{\"description\":\"Specifies the maximum node count of AML Clusters\",\"displayName\":\"Maximum Node Count\"}},\"maxNodeIdleTimeInSecondsBeforeScaleDown\":{\"type\":\"Integer\",\"defaultValue\":900,\"metadata\":{\"description\":\"Specifies the maximum node idle time in seconds before scaledown\",\"displayName\":\"Maximum Node Idle Time in Seconds Before Scaledown\"}},\"minNodeCount\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"Specifies the minimum node count of AML Clusters\",\"displayName\":\"Minimum Node Count\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.maxNodeCount\",\"greater\":\"[parameters('maxNodeCount')]\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.minNodeCount\",\"greater\":\"[parameters('minNodeCount')]\"},{\"greater\":\"[parameters('maxNodeIdleTimeInSecondsBeforeScaleDown')]\",\"value\":\"[int(last(split(replace(replace(replace(replace(replace(replace(replace(field('Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.nodeIdleTimeBeforeScaleDown'), 'P', '/'), 'Y', '/'), 'M', '/'), 'D', '/'), 'T', '/'), 'H', '/'), 'S', ''), '/')))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace": {
              "description": "Enforces high business impact Azure Machine Learning workspaces.",
              "display_name": "Enforces high business impact Azure Machine Learning Workspaces",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:38.4018458Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-HbiWorkspace",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet": {
              "description": "Deny public access behind vnet to Azure Machine Learning workspaces.",
              "display_name": "Deny public acces behind vnet to Azure Machine Learning workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.3880305Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-PublicAccessWhenBehindVnet",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\",\"notEquals\":false}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess": {
              "description": "Denies public network access for Azure Machine Learning workspaces.",
              "display_name": "Azure Machine Learning should have disabled public network access",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.9777722Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MachineLearning-PublicNetworkAccess",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http": {
              "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "MySQL database servers enforce SSL connections.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.4004421Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-MySql-http",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http": {
              "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "PostgreSQL database servers enforce SSL connection.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.3184857Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
              "mode": "Indexed",
              "name": "Deny-PostgreSql-http",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones": {
              "description": "This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
              "display_name": "Deny the creation of private DNS",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.0947279Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Private-DNS-Zones",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/privateDnsZones\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB": {
              "description": "This policy denies the creation of Maria DB accounts with exposed public endpoints",
              "display_name": "Public network access should be disabled for MariaDB",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.7674958Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-PublicEndpoint-MariaDB",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/publicNetworkAccess\",\"notequals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP": {
              "description": "This policy denies creation of Public IPs under the assigned scope.",
              "display_name": "Deny the creation of public IP",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.3577568Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-PublicIP",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet": {
              "description": "This policy denies any network security rule that allows RDP access from Internet",
              "display_name": "RDP access from the Internet should be blocked",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:46.8470894Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-RDP-From-Internet",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups/securityRules\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"3389\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"true\",\"value\":\"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]\"}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"3389\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http": {
              "description": "Audit enabling of only connections via SSL to Azure Cache for Redis. Validate both minimum TLS version and enableNonSslPort is disabled. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
              "display_name": "Azure Cache for Redis only secure connections should be enabled",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Cache\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.1264631Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Redis-http",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select minimum TLS version for Azure Cache for Redis.\",\"displayName\":\"Select minumum TLS version for Azure Cache for Redis.\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"},{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS": {
              "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
              "display_name": "Azure SQL Database should have the minimal TLS version set to the highest version",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.1457915Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Sql-minTLS",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS": {
              "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
              "display_name": "SQL Managed Instance should have the minimal TLS version set to the highest version",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.9538002Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-SqlMi-minTLS",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS": {
              "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
              "display_name": "Storage Account set to minimum TLS and Secure transfer should be enabled",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Storage\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.6806057Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deny-Storage-minTLS",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-04-01\",\"value\":\"[requestContext().apiVersion]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"}]},{\"equals\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg": {
              "description": "This policy denies the creation of a subnet without a Network Security Group. NSG help to protect traffic across subnet-level.",
              "display_name": "Subnets should have a Network Security Group",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.6447517Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
              "mode": "All",
              "name": "Deny-Subnet-Without-Nsg",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"GatewaySubnet\",\"AzureFirewallSubnet\",\"AzureFirewallManagementSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr": {
              "description": "This policy denies the creation of a subnet without a User Defined Route (UDR).",
              "display_name": "Subnets should have a User Defined Route",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:19.2955445Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
              "mode": "All",
              "name": "Deny-Subnet-Without-Udr",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"AzureBastionSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].routeTable.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/routeTable.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub": {
              "description": "This policy denies the creation of vNet Peerings outside of the same subscriptions under the assigned scope.",
              "display_name": "Deny vNet peering cross subscription.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.5187856Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
              "mode": "All",
              "name": "Deny-VNET-Peer-Cross-Sub",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"notcontains\":\"[subscription().id]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs": {
              "description": "This policy denies the creation of vNet Peerings to non-approved vNets under the assigned scope.",
              "display_name": "Deny vNet peering to non-approved vNets",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:41.0036627Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deny-VNET-Peering-To-Non-Approved-VNETs",
              "parameters": "{\"allowedVnets\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}\",\"displayName\":\"Allowed vNets to peer with\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}},{\"not\":{\"exists\":false,\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\"}}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering": {
              "description": "This policy denies the creation of vNet Peerings under the assigned scope.",
              "display_name": "Deny vNet peering ",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:17.7260765Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
              "mode": "All",
              "name": "Deny-VNet-Peering",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts": {
              "description": "Deploy Azure Security Center Security Contacts",
              "display_name": "Deploy Azure Security Center Security Contacts",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Security Center\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.3985266Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deploy-ASC-SecurityContacts",
              "parameters": "{\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Azure Security Center contact details\",\"displayName\":\"Security contacts email address\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailSecurityContact\":{\"metadata\":{\"description\":\"Security contacts email address\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-01-01-preview\",\"name\":\"default\",\"properties\":{\"alertNotifications\":{\"minimalSeverity\":\"High\",\"state\":\"On\"},\"emails\":\"[parameters('emailSecurityContact')]\",\"notificationsByRole\":{\"roles\":[\"Owner\"],\"state\":\"On\"}},\"type\":\"Microsoft.Security/securityContacts\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"contains\":\"[parameters('emailSecurityContact')]\",\"field\":\"Microsoft.Security/securityContacts/email\"},{\"equals\":\"Microsoft.Security/securityContacts\",\"field\":\"type\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertsToAdmins\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget": {
              "description": "Deploy a default budget on all subscriptions under the assigned scope",
              "display_name": "Deploy a default budget on all subscriptions under the assigned scope",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Budget\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.3816051Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Deploy-Budget",
              "parameters": "{\"amount\":{\"type\":\"String\",\"defaultValue\":\"1000\",\"metadata\":{\"description\":\"The total amount of cost or usage to track with the budget\"}},\"budgetName\":{\"type\":\"String\",\"defaultValue\":\"budget-set-by-policy\",\"metadata\":{\"description\":\"The name for the budget to be created\"}},\"contactEmails\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"contactGroups\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.\"}},\"contactRoles\":{\"type\":\"Array\",\"defaultValue\":[\"Owner\",\"Contributor\"],\"metadata\":{\"description\":\"The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\"}},\"firstThreshold\":{\"type\":\"String\",\"defaultValue\":\"90\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"secondThreshold\":{\"type\":\"String\",\"defaultValue\":\"100\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"timeGrain\":{\"type\":\"String\",\"allowedValues\":[\"Monthly\",\"Quarterly\",\"Annually\",\"BillingMonth\",\"BillingQuarter\",\"BillingAnnual\"],\"defaultValue\":\"Monthly\",\"metadata\":{\"description\":\"The time covered by a budget. Tracking of the amount will be reset based on the time grain.\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"amount\":{\"value\":\"[parameters('amount')]\"},\"budgetName\":{\"value\":\"[parameters('budgetName')]\"},\"contactEmails\":{\"value\":\"[parameters('contactEmails')]\"},\"contactGroups\":{\"value\":\"[parameters('contactGroups')]\"},\"contactRoles\":{\"value\":\"[parameters('contactRoles')]\"},\"firstThreshold\":{\"value\":\"[parameters('firstThreshold')]\"},\"secondThreshold\":{\"value\":\"[parameters('secondThreshold')]\"},\"timeGrain\":{\"value\":\"[parameters('timeGrain')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"amount\":{\"type\":\"String\"},\"budgetName\":{\"type\":\"String\"},\"contactEmails\":{\"type\":\"Array\"},\"contactGroups\":{\"type\":\"Array\"},\"contactRoles\":{\"type\":\"Array\"},\"firstThreshold\":{\"type\":\"String\"},\"secondThreshold\":{\"type\":\"String\"},\"startDate\":{\"defaultValue\":\"[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]\",\"type\":\"String\"},\"timeGrain\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[parameters('budgetName')]\",\"properties\":{\"amount\":\"[parameters('amount')]\",\"category\":\"Cost\",\"notifications\":{\"NotificationForExceededBudget1\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('firstThreshold')]\"},\"NotificationForExceededBudget2\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('secondThreshold')]\"}},\"timeGrain\":\"[parameters('timeGrain')]\",\"timePeriod\":{\"startDate\":\"[parameters('startDate')]\"}},\"type\":\"Microsoft.Consumption/budgets\"}]}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('amount')]\",\"field\":\"Microsoft.Consumption/budgets/amount\"},{\"equals\":\"[parameters('timeGrain')]\",\"field\":\"Microsoft.Consumption/budgets/timeGrain\"},{\"equals\":\"Cost\",\"field\":\"Microsoft.Consumption/budgets/category\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Consumption/budgets\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table": {
              "description": "Deploys a route table with specific user defined routes when one does not exist. The route table deployed by the policy must be manually associated to subnet(s)",
              "display_name": "Deploy a route table with specific user defined routes",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:41.8461111Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Custom-Route-Table",
              "parameters": "{\"disableBgpPropagation\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Disable BGP Propagation\",\"displayName\":\"DisableBgpPropagation\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRoutes\":{\"type\":\"Array\",\"metadata\":{\"description\":\"Routes that must exist in compliant route tables deployed by this policy\",\"displayName\":\"requiredRoutes\"}},\"routeTableName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the route table automatically deployed by this policy\",\"displayName\":\"routeTableName\"}},\"vnetRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Only VNets in this region will be evaluated against this policy\",\"displayName\":\"vnetRegion\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"equals\":\"[parameters('vnetRegion')]\",\"field\":\"location\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"routeTableDepl\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"location\":\"[[parameters('vnetRegion')]\",\"name\":\"[[parameters('routeTableName')]\",\"properties\":{\"copy\":\"[variables('copyLoop')]\",\"disableBgpRoutePropagation\":\"[[parameters('disableBgpPropagation')]\"},\"type\":\"Microsoft.Network/routeTables\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"copyLoop\":[{\"count\":\"[[length(parameters('requiredRoutes'))]\",\"input\":{\"name\":\"[[concat('route-',copyIndex('routes'))]\",\"properties\":{\"addressPrefix\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[0]]\",\"nextHopIpAddress\":\"[[if(equals(toLower(split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]),'virtualappliance'),split(parameters('requiredRoutes')[copyIndex('routes')], ';')[2], null())]\",\"nextHopType\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]]\"}},\"name\":\"routes\"}]}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('routeTableName')]\",\"field\":\"name\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"where\":{\"in\":\"[parameters('requiredRoutes')]\",\"value\":\"[concat(current('Microsoft.Network/routeTables/routes[*].addressPrefix'), ';', current('Microsoft.Network/routeTables/routes[*].nextHopType'), if(equals(toLower(current('Microsoft.Network/routeTables/routes[*].nextHopType')),'virtualappliance'), concat(';', current('Microsoft.Network/routeTables/routes[*].nextHopIpAddress')), ''))]\"}},\"equals\":\"[length(parameters('requiredRoutes'))]\"}]},\"roleDefinitionIds\":[\"/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/routeTables\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection": {
              "description": "Deploys an Azure DDoS Protection Standard plan",
              "display_name": "Deploy an Azure DDoS Protection Standard plan",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.2277031Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deploy-DDoSProtection",
              "parameters": "{\"ddosName\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet\",\"displayName\":\"ddosName\"}},\"ddosRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet location\",\"displayName\":\"ddosRegion\",\"strongType\":\"location\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"ddosname\":{\"value\":\"[parameters('ddosname')]\"},\"ddosregion\":{\"value\":\"[parameters('ddosRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"ddosRegion\":{\"type\":\"String\"},\"ddosname\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"ddosprotection\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-12-01\",\"location\":\"[parameters('ddosRegion')]\",\"name\":\"[parameters('ddosName')]\",\"properties\":{},\"type\":\"Microsoft.Network/ddosProtectionPlans\"}]}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('ddosName')]\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/ddosProtectionPlans\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA": {
              "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Automation to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.6321248Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-AA",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Automation/automationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"JobLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobStreams\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DscNodeStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Automation/automationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI": {
              "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.",
              "display_name": "Deploy Diagnostic Settings for Container Instances to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.7066742Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ACI",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerInstance/containerGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR": {
              "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.",
              "display_name": "Deploy Diagnostic Settings for Container Registry to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:17.3817881Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ACR",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ContainerRegistryLoginEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ContainerRegistryRepositoryEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerRegistry/registries/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt": {
              "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for API Management to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:12.9028486Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-APIMgmt",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"WebSocketConnectionLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ApiManagement/service/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans": {
              "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any Scaling Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
              "display_name": "Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.629783Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-AVDScalingPlans",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/scalingplans\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/scalingplans/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService": {
              "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.7548507Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-AnalysisService",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.AnalysisServices/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Service\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.AnalysisServices/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR": {
              "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.3297396Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ApiForFHIR",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HealthcareApis/services/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway": {
              "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.4199431Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ApplicationGateway",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ApplicationGatewayAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayPerformanceLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/applicationGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion": {
              "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Azure Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.741446Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Bastion",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/bastionHosts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"BastionAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/bastionHosts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints": {
              "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:48.9461895Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-CDNEndpoints",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cdn/profiles/endpoints\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"CoreAnalytics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices": {
              "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.7971105Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-CognitiveServices",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RequestResponse\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Trace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.CognitiveServices/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB": {
              "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:46.7942035Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-CosmosDB",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DataPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MongoRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyRUConsumption\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ControlPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CassandraRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"GremlinRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"Requests\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics": {
              "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:12.123882Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-DLAnalytics",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster": {
              "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.4682663Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-DataExplorerCluster",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Kusto/Clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"SucceededIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FailedIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IngestionBatching\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Command\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Query\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableUsageStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Kusto/Clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory": {
              "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Data Factory to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.38409Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-DataFactory",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataFactory/factories\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TriggerRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessages\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutableStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessageContext\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionComponentPhases\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionDataStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISIntegrationRuntimeLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataFactory/factories/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks": {
              "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Databricks to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.408338Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Databricks",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"dbfs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clusters\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"accounts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"jobs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"notebook\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ssh\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"workspace\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"secrets\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlPermissions\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"instancePools\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Databricks/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub": {
              "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.506137Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-EventGridSub",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/eventSubscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic": {
              "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.3064026Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-EventGridSystemTopic",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/systemTopics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/systemTopics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic": {
              "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.2439406Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-EventGridTopic",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/topics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PublishFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/topics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute": {
              "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:10.7332986Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-ExpressRoute",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/expressRouteCircuits\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PeeringRouteLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall": {
              "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Firewall to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.9949713Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Firewall",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/azureFirewalls\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AzureFirewallApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallDnsProxy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWThreatIntel\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWIdpsSignature\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWDnsQuery\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFqdnResolveFailure\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/azureFirewalls/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor": {
              "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Front Door to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.7688138Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-FrontDoor",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/frontDoors\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FrontdoorAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FrontdoorWebApplicationFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/frontDoors/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function": {
              "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.6236795Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Function",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FunctionAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight": {
              "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for HDInsight to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.1790743Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-HDInsight",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HDInsight/clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HDInsight/clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer": {
              "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.7485976Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-LoadBalancer",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/loadBalancers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"LoadBalancerAlertEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"LoadBalancerProbeHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/loadBalancers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE": {
              "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.362251Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-LogicAppsISE",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/integrationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"IntegrationAccountTrackingEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/integrationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB": {
              "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for MariaDB to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:46.6843839Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MariaDB",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMariaDB/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService": {
              "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.7993494Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MediaService",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Media/mediaServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"KeyDeliveryRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Media/mediaServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace": {
              "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.398413Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MlWorkspace",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AmlComputeClusterEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeClusterNodeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeJobEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeCpuGpuUtilization\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlRunStatusChangedEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsActionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ComputeInstanceEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL": {
              "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.4861736Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-MySQL",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMySQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC": {
              "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:20.1915252Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-NIC",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkInterfaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkInterfaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups": {
              "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:51.5400816Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-NetworkSecurityGroups",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"NetworkSecurityGroupEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkSecurityGroupRuleCounter\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL": {
              "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:15.1640565Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-PostgreSQL",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PostgreSQLLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded": {
              "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:10.9079465Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-PowerBIEmbedded",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.PowerBIDedicated/capacities\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache": {
              "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.0067075Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-RedisCache",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cache/redis/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay": {
              "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Relay to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.3947246Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Relay",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Relay/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"HybridConnectionsEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Relay/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools": {
              "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.6093617Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-SQLElasticPools",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/elasticPools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI": {
              "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.0106559Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-SQLMI",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ResourceUsageStats\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DevOpsOperationsAudit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/managedInstances/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR": {
              "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for SignalR to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.4170944Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-SignalR",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.SignalRService/SignalR\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AllLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.SignalRService/SignalR/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights": {
              "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:50.03583Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-TimeSeriesInsights",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.TimeSeriesInsights/environments\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Ingress\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager": {
              "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.9033275Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-TrafficManager",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/trafficManagerProfiles\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ProbeHealthStatusEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM": {
              "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.5667077Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VM",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachines/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS": {
              "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:14.3930062Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VMSS",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW": {
              "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.",
              "display_name": "Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:50.1043775Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VNetGW",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworkGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IKEDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"P2SDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TunnelDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork": {
              "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:14.2509008Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-VirtualNetwork",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"VMProtectionAlerts\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworks/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup": {
              "description": "Deploys the diagnostic settings for AVD Application group to stream to a Log Analytics workspace when any application group which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
              "display_name": "Deploy Diagnostic Settings for AVD Application group to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.9179339Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WVDAppGroup",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/applicationGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/applicationGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools": {
              "description": "Deploys the diagnostic settings for AVD Host Pools to stream to a Log Analytics workspace when any Host Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
              "display_name": "Deploy Diagnostic Settings for AVD Host Pools to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:46.2521086Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WVDHostPools",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/hostpools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Connection\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"HostRegistration\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AgentHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkData\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SessionHostManagement\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/hostpools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace": {
              "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
              "display_name": "Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.2759449Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WVDWorkspace",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Feed\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm": {
              "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.408111Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-WebServerFarm",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Web/serverfarms\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/serverfarms/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website": {
              "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for App Service to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:38.3473793Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-Website",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"notContains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AppServiceAntivirusScanAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceConsoleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceFileAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceIPSecAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServicePlatformLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub": {
              "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
              "display_name": "Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.926626Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Diagnostics-iotHub",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Devices/IotHubs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Connections\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceTelemetry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DCommands\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceIdentityOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FileUploadOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Routes\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"D2CTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TwinQueries\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobsOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DirectMethods\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DistributedTracing\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Configurations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceStreams\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Devices/IotHubs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy": {
              "description": "Deploys Azure Firewall Manager policy in subscription where the policy is assigned.",
              "display_name": "Deploy Azure Firewall Manager policy in the subscription",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.7521354Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "All",
              "name": "Deploy-FirewallPolicy",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"fwPolicyRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for Azure Firewall Policy\",\"displayName\":\"fwPolicyRegion\",\"strongType\":\"location\"}},\"fwpolicy\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Object describing Azure Firewall Policy\",\"displayName\":\"fwpolicy\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"fwPolicy\":{\"value\":\"[parameters('fwPolicy')]\"},\"fwPolicyRegion\":{\"value\":\"[parameters('fwPolicyRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"fwPolicy\":{\"type\":\"object\"},\"fwPolicyRegion\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"fwpolicies\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[],\"location\":\"[parameters('fwpolicy').location]\",\"name\":\"[parameters('fwpolicy').firewallPolicyName]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[\"[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]\"],\"name\":\"[parameters('fwpolicy').ruleGroups.name]\",\"properties\":{\"priority\":\"[parameters('fwpolicy').ruleGroups.properties.priority]\",\"rules\":\"[parameters('fwpolicy').ruleGroups.properties.rules]\"},\"type\":\"ruleGroups\"}],\"tags\":{},\"type\":\"Microsoft.Network/firewallPolicies\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/firewallPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Database for MySQL server deploy a specific min TLS version and enforce SSL.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:49.9404431Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-MySQL-sslEnforcement",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for MySQL server\",\"displayName\":\"Effect minimum TLS version Azure Database for MySQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforMySQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforMySQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs": {
              "description": "Deploys NSG flow logs and traffic analytics to a storageaccountid with a specfied retention period.",
              "display_name": "Deploys NSG flow logs and traffic analytics",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:50.2308269Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Nsg-FlowLogs",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"flowAnalyticsEnabled\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"displayName\":\"Enable Traffic Analytics\"}},\"logAnalytics\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"retention\":{\"type\":\"Integer\",\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"}},\"storageAccountResourceId\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"Storage Account Resource Id\",\"strongType\":\"Microsoft.Storage/storageAccounts\"}},\"trafficAnalyticsInterval\":{\"type\":\"Integer\",\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"flowAnalyticsEnabled\":{\"value\":\"[parameters('flowAnalyticsEnabled')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"networkSecurityGroupName\":{\"value\":\"[field('name')]\"},\"resourceGroupName\":{\"value\":\"[resourceGroup().name]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"storageAccountResourceId\":{\"value\":\"[parameters('storageAccountResourceId')]\"},\"trafficAnalyticsInterval\":{\"value\":\"[parameters('trafficAnalyticsInterval')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"flowAnalyticsEnabled\":{\"type\":\"bool\"},\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"networkSecurityGroupName\":{\"type\":\"String\"},\"resourceGroupName\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"storageAccountResourceId\":{\"type\":\"String\"},\"trafficAnalyticsInterval\":{\"type\":\"int\"}},\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[take(concat('NetworkWatcher_', toLower(parameters('location')),  '/', parameters('networkSecurityGroupName'), '-', parameters('resourceGroupName'), '-flowlog' ), 80)]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":\"[bool(parameters('flowAnalyticsEnabled'))]\",\"trafficAnalyticsInterval\":\"[parameters('trafficAnalyticsInterval')]\",\"workspaceId\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').properties.customerId, json('null')) ]\",\"workspaceRegion\":\"[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]\",\"workspaceResourceId\":\"[if(not(empty(parameters('logAnalytics'))), parameters('logAnalytics'), json('null'))]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[parameters('storageAccountResourceId')]\",\"targetResourceId\":\"[resourceId(parameters('resourceGroupName'), 'Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroupName'))]\"},\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"},{\"equals\":\"[parameters('flowAnalyticsEnabled')]\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled\"}]},\"resourceGroupName\":\"NetworkWatcherRG\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Network/networkWatchers/flowLogs\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
                "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA": {
              "description": "Deploys NSG flow logs and traffic analytics to Log Analytics with a specfied retention period.",
              "display_name": "Deploys NSG flow logs and traffic analytics to Log Analytics",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.9974683Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Nsg-FlowLogs-to-LA",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"interval\":{\"type\":\"Integer\",\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}},\"retention\":{\"type\":\"Integer\",\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"}},\"workspace\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"interval\":{\"value\":\"[parameters('interval')]\"},\"location\":{\"value\":\"[field('location')]\"},\"networkSecurityGroup\":{\"value\":\"[field('id')]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"workspace\":{\"value\":\"[parameters('workspace')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"interval\":{\"type\":\"int\"},\"location\":{\"type\":\"String\"},\"networkSecurityGroup\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"time\":{\"defaultValue\":\"[utcNow()]\",\"type\":\"String\"},\"workspace\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2019-06-01\",\"kind\":\"StorageV2\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('storageAccountName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard_LRS\",\"tier\":\"Standard\"},\"type\":\"Microsoft.Storage/storageAccounts\"}]}},\"resourceGroup\":\"[variables('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\"],\"name\":\"[concat('NetworkWatcherRG', '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('NetworkWatcher_', toLower(parameters('location')))]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-11-01\",\"dependsOn\":[\"[concat('NetworkWatcher_', toLower(parameters('location')))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('securityGroupName'), '-Network-flowlog')]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":true,\"trafficAnalyticsInterval\":\"[parameters('interval')]\",\"workspaceResourceId\":\"[parameters('workspace')]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[concat(subscription().id, '/resourceGroups/', variables('resourceGroupName'), '/providers/Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]\",\"targetResourceId\":\"[parameters('networkSecurityGroup')]\"},\"type\":\"flowLogs\"}],\"type\":\"Microsoft.Network/networkWatchers\"}]}},\"resourceGroup\":\"NetworkWatcherRG\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"resourceGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[4]]\",\"securityGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[8]]\",\"storageAccountName\":\"[concat('es', uniqueString(variables('securityGroupName'), parameters('time')))]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\"resourceGroupName\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12\",\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/networkWatchers/flowlogs\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
                "/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12",
                "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
                "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab",
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "Azure Database for PostgreSQL server deploy a specific min TLS version requirement and enforce SSL ",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.3810566Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-PostgreSQL-sslEnforcement",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for PostgreSQL server\",\"displayName\":\"Effect Azure Database for PostgreSQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Database for PostgreSQL server to enforce\",\"displayName\":\"Select version for PostgreSQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notEquals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforPostgreSQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS": {
              "description": "Deploys a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "SQL servers deploys a specific min TLS version requirement.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:46.578164Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-SQL-minTLS",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/servers\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings": {
              "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
              "display_name": "Deploy SQL database auditing settings",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.6233326Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-AuditingSettings",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"auditActionsAndGroups\":[\"BATCH_COMPLETED_GROUP\",\"DATABASE_OBJECT_CHANGE_GROUP\",\"SCHEMA_OBJECT_CHANGE_GROUP\",\"BACKUP_RESTORE_GROUP\",\"APPLICATION_ROLE_CHANGE_PASSWORD_GROUP\",\"DATABASE_PRINCIPAL_CHANGE_GROUP\",\"DATABASE_PRINCIPAL_IMPERSONATION_GROUP\",\"DATABASE_ROLE_MEMBER_CHANGE_GROUP\",\"USER_CHANGE_PASSWORD_GROUP\",\"DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP\",\"DATABASE_OBJECT_PERMISSION_CHANGE_GROUP\",\"DATABASE_PERMISSION_CHANGE_GROUP\",\"SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP\",\"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\",\"FAILED_DATABASE_AUTHENTICATION_GROUP\"],\"isAzureMonitorTargetEnabled\":true,\"state\":\"enabled\"},\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/state\"},{\"equals\":\"true\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled\"}]},\"name\":\"default\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies": {
              "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
              "display_name": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.5298274Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-SecurityAlertPolicies",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-06-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"disabledAlerts\":[\"\"],\"emailAccountAdmins\":true,\"emailAddresses\":[\"admin@contoso.com\"],\"retentionDays\":0,\"state\":\"Enabled\",\"storageAccountAccessKey\":\"\",\"storageEndpoint\":null},\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/servers/databases/securityAlertPolicies/state\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde": {
              "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment",
              "display_name": "Deploy SQL Database Transparent Data Encryption ",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.5442016Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-Tde",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2014-04-01\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]\",\"properties\":{\"status\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/transparentDataEncryption.status\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments": {
              "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters",
              "display_name": "Deploy SQL Database vulnerability Assessments",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.8476331Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Sql-vulnerabilityAssessments",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
              "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\"},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"recurringScans\":{\"emailSubscriptionAdmins\":false,\"emails\":[\"[parameters('vulnerabilityAssessmentsEmail')]\"],\"isEnabled\":true},\"storageAccountAccessKey\":\"[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\"storageContainerPath\":\"[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\"},\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails\"},{\"equals\":true,\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\"],\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
                "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL managed instances. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
              "display_name": "SQL managed instances deploy a specific min TLS version requirement.",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.737443Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-SqlMi-minTLS",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-02-02-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/managedInstances\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/managedInstances\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement": {
              "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Storage. Enables secure server to client by enforce minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your Azure Storage.",
              "display_name": "Azure Storage deploy a specific min TLS version requirement and enforce SSL/HTTPS ",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Storage\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:12.2508415Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Storage-sslEnforcement",
              "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure STorage\",\"displayName\":\"Effect Azure Storage\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure STorage to enforce\",\"displayName\":\"Select TLS version for Azure Storage server\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\"notEquals\":\"true\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notEquals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('minimumTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimumTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimumTlsVersion\":\"[parameters('minimumTlsVersion')]\",\"supportsHttpsTrafficOnly\":true},\"type\":\"Microsoft.Storage/storageAccounts\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"equals\":\"[parameters('minimumTlsVersion')]\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Storage/storageAccounts\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke": {
              "description": "This policy deploys virtual network and peer to the hub",
              "display_name": "Deploy Virtual Network with peering to the hub",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.867536Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "mode": "All",
              "name": "Deploy-VNET-HubSpoke",
              "parameters": "{\"dnsServers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Default domain servers for the vNET.\",\"displayName\":\"DNSServers\"}},\"hubResourceId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Resource ID for the HUB vNet\",\"displayName\":\"hubResourceId\"}},\"vNetCidrRange\":{\"type\":\"String\",\"metadata\":{\"description\":\"CIDR Range for the vNet\",\"displayName\":\"vNetCidrRange\"}},\"vNetLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"Location for the vNet\",\"displayName\":\"vNetLocation\"}},\"vNetName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet\",\"displayName\":\"vNetName\"}},\"vNetPeerUseRemoteGateway\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Enable gateway transit for the LZ network\",\"displayName\":\"vNetPeerUseRemoteGateway\"}},\"vNetRgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet RG\",\"displayName\":\"vNetRgName\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('vNetRgName')]\",\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"dnsServers\":{\"value\":\"[parameters('dnsServers')]\"},\"hubResourceId\":{\"value\":\"[parameters('hubResourceId')]\"},\"vNetCidrRange\":{\"value\":\"[parameters('vNetCidrRange')]\"},\"vNetLocation\":{\"value\":\"[parameters('vNetLocation')]\"},\"vNetName\":{\"value\":\"[parameters('vNetName')]\"},\"vNetPeerUseRemoteGateway\":{\"value\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"vNetRgName\":{\"value\":\"[parameters('vNetRgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"dnsServers\":{\"defaultValue\":[],\"type\":\"Array\"},\"hubResourceId\":{\"type\":\"String\"},\"vNetCidrRange\":{\"type\":\"String\"},\"vNetLocation\":{\"type\":\"String\"},\"vNetName\":{\"type\":\"String\"},\"vNetPeerUseRemoteGateway\":{\"defaultValue\":false,\"type\":\"bool\"},\"vNetRgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6),'-rg')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetRgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"}],\"variables\":{}}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6),'-rg')]\"],\"name\":\"[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetName')]\",\"properties\":{\"addressSpace\":{\"addressPrefixes\":[\"[parameters('vNetCidrRange')]\"]},\"dhcpOptions\":{\"dnsServers\":\"[parameters('dnsServers')]\"}},\"type\":\"Microsoft.Network/virtualNetworks\"},{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat(parameters('vNetName'), '/peerToHub')]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":false,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[parameters('hubResourceId')]\"},\"useRemoteGateways\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat('es-lz-hub-',substring(uniqueString(subscription().id),0,6),'-peering')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"hubName\":{\"value\":\"[split(parameters('hubResourceId'),'/')[8]]\"},\"remoteVirtualNetwork\":{\"value\":\"[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"hubName\":{\"defaultValue\":false,\"type\":\"String\"},\"remoteVirtualNetwork\":{\"defaultValue\":false,\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"name\":\"[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":true,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[[parameters('remoteVirtualNetwork')]\"},\"useRemoteGateways\":false},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"}],\"variables\":{}}},\"resourceGroup\":\"[split(parameters('hubResourceId'),'/')[4]]\",\"subscriptionId\":\"[split(parameters('hubResourceId'),'/')[2]]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('vNetRgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"field\":\"name\",\"like\":\"[parameters('vNetName')]\"},{\"equals\":\"[parameters('vNetLocation')]\",\"field\":\"location\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('vNetName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/virtualNetworks\"},\"effect\":\"deployIfNotExists\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin": {
              "description": "Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine",
              "display_name": "Deploy Windows Domain Join Extension with keyvault configuration",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Guest Configuration\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:14.6677295Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "mode": "Indexed",
              "name": "Deploy-Windows-DomainJoin",
              "parameters": "{\"domainFQDN\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainFQDN\"}},\"domainOUPath\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainOUPath\"}},\"domainPassword\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainPassword\"}},\"domainUsername\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainUsername\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"keyVaultResourceId\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"keyVaultResourceId\"}}}",
              "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2008-R2-SP1-zhcn\",\"2012-Datacenter\",\"2012-datacenter-gensecond\",\"2012-Datacenter-smalldisk\",\"2012-datacenter-smalldisk-g2\",\"2012-Datacenter-zhcn\",\"2012-datacenter-zhcn-g2\",\"2012-R2-Datacenter\",\"2012-r2-datacenter-gensecond\",\"2012-R2-Datacenter-smalldisk\",\"2012-r2-datacenter-smalldisk-g2\",\"2012-R2-Datacenter-zhcn\",\"2012-r2-datacenter-zhcn-g2\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-datacenter-gs\",\"2016-Datacenter-Server-Core\",\"2016-datacenter-server-core-g2\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-datacenter-server-core-smalldisk-g2\",\"2016-Datacenter-smalldisk\",\"2016-datacenter-smalldisk-g2\",\"2016-Datacenter-with-Containers\",\"2016-datacenter-with-containers-g2\",\"2016-Datacenter-with-RDSH\",\"2016-Datacenter-zhcn\",\"2016-datacenter-zhcn-g2\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-datacenter-core-g2\",\"2019-Datacenter-Core-smalldisk\",\"2019-datacenter-core-smalldisk-g2\",\"2019-Datacenter-Core-with-Containers\",\"2019-datacenter-core-with-containers-g2\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-datacenter-core-with-containers-smalldisk-g2\",\"2019-datacenter-gensecond\",\"2019-datacenter-gs\",\"2019-Datacenter-smalldisk\",\"2019-datacenter-smalldisk-g2\",\"2019-Datacenter-with-Containers\",\"2019-datacenter-with-containers-g2\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-datacenter-with-containers-smalldisk-g2\",\"2019-Datacenter-zhcn\",\"2019-datacenter-zhcn-g2\",\"Datacenter-Core-1803-with-Containers-smalldisk\",\"datacenter-core-1803-with-containers-smalldisk-g2\",\"Datacenter-Core-1809-with-Containers-smalldisk\",\"datacenter-core-1809-with-containers-smalldisk-g2\",\"Datacenter-Core-1903-with-Containers-smalldisk\",\"datacenter-core-1903-with-containers-smalldisk-g2\",\"datacenter-core-1909-with-containers-smalldisk\",\"datacenter-core-1909-with-containers-smalldisk-g1\",\"datacenter-core-1909-with-containers-smalldisk-g2\"]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"domainFQDN\":{\"value\":\"[parameters('domainFQDN')]\"},\"domainOUPath\":{\"value\":\"[parameters('domainOUPath')]\"},\"domainPassword\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainPassword')]\"}},\"domainUsername\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainUsername')]\"}},\"keyVaultResourceId\":{\"value\":\"[parameters('keyVaultResourceId')]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"domainFQDN\":{\"type\":\"String\"},\"domainOUPath\":{\"type\":\"String\"},\"domainPassword\":{\"type\":\"securestring\"},\"domainUsername\":{\"type\":\"String\"},\"keyVaultResourceId\":{\"type\":\"String\"},\"location\":{\"type\":\"String\"},\"vmName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2015-06-15\",\"location\":\"[resourceGroup().location]\",\"name\":\"[concat(variables('vmName'),'/joindomain')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"Password\":\"[parameters('domainPassword')]\"},\"publisher\":\"Microsoft.Compute\",\"settings\":{\"Name\":\"[parameters('domainFQDN')]\",\"OUPath\":\"[parameters('domainOUPath')]\",\"Options\":\"[variables('domainJoinOptions')]\",\"Restart\":\"true\",\"User\":\"[parameters('domainUserName')]\"},\"type\":\"JsonADDomainExtension\",\"typeHandlerVersion\":\"1.3\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"domainJoinOptions\":3,\"vmName\":\"[parameters('vmName')]\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"JsonADDomainExtension\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Compute\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
              "policy_type": "Custom",
              "role_definition_ids": [
                "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
              ],
              "timeouts": null
            }
          }
        },
        "azurerm_policy_set_definition": {
          "enterprise_scale": {
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints": {
              "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
              "display_name": "Public network access should be disabled for PaaS services",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.295052Z\",\"updatedBy\":null,\"updatedOn\":null}",
              "name": "Deny-PublicPaaSEndpoints",
              "parameters": "{\"ACRPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure Container Registires with exposed public endpoints \",\"displayName\":\"Public network access on Azure Container Registry disabled\"}},\"AFSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure File Sync instances with exposed public endpoints \",\"displayName\":\"Public network access on Azure File Sync disabled\"}},\"AKSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies  the creation of  Azure Kubernetes Service non-private clusters\",\"displayName\":\"Public network access on AKS API should be disabled\"}},\"BatchPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Batch Instances with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Batch Instances\"}},\"CosmosPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies that  Cosmos database accounts  are created with out public network access is disabled.\",\"displayName\":\"Public network access should be disabled for CosmosDB\"}},\"KeyVaultPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access should be disabled for KeyVault\"}},\"MySQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of MySql Flexible Server DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for MySQL Flexible Server\"}},\"PostgreSQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Postgre SQL Flexible DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for PostgreSql Flexible Server\"}},\"SqlServerPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Sql servers with exposed public endpoints\",\"displayName\":\"Public network access on Azure SQL Database should be disabled\"}},\"StoragePublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access onStorage accounts should be disabled\"}}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                  "policy_group_names": [],
                  "reference_id": "CosmosDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                  "policy_group_names": [],
                  "reference_id": "KeyVaultDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                  "policy_group_names": [],
                  "reference_id": "SqlServerDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StoragePublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                  "policy_group_names": [],
                  "reference_id": "StorageDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                  "policy_group_names": [],
                  "reference_id": "AKSDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                  "policy_group_names": [],
                  "reference_id": "ACRDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AFSPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                  "policy_group_names": [],
                  "reference_id": "AFSDenyPaasPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLFlexPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
                  "policy_group_names": [],
                  "reference_id": "PostgreSQLFlexDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLFlexPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
                  "policy_group_names": [],
                  "reference_id": "MySQLFlexDenyPublicIP"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchPublicIpDenyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                  "policy_group_names": [],
                  "reference_id": "BatchDenyPublicIP"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics": {
              "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. See the list of policies of the services that are included ",
              "display_name": "Deploy Diagnostic Settings to Azure Services",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.353357Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
              "name": "Deploy-Diagnostics-LogAnalytics",
              "parameters": "{\"ACILogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Instances to Log Analytics workspace\"}},\"ACRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Registry to Log Analytics workspace\"}},\"AKSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace\"}},\"APIMgmtLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for API Management to Log Analytics workspace\"}},\"APIforFHIRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace\"}},\"AVDScalingPlansLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace\"}},\"AnalysisServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace\"}},\"AppServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace\"}},\"AppServiceWebappLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service to Log Analytics workspace\"}},\"ApplicationGatewayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace\"}},\"AutomationLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Automation to Log Analytics workspace\"}},\"BastionLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace\"}},\"BatchLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Batch to Log Analytics workspace\"}},\"CDNEndpointsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace\"}},\"CognitiveServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace\"}},\"CosmosLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace\"}},\"DataExplorerClusterLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace\"}},\"DataFactoryLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Factory to Log Analytics workspace\"}},\"DataLakeAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace\"}},\"DataLakeStoreLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace\"}},\"DatabricksLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Databricks to Log Analytics workspace\"}},\"EventGridSubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace\"}},\"EventGridTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace\"}},\"EventHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace\"}},\"EventSystemTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace\"}},\"ExpressRouteLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace\"}},\"FirewallLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Firewall to Log Analytics workspace\"}},\"FrontDoorLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Front Door to Log Analytics workspace\"}},\"FunctionAppLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace\"}},\"HDInsightLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for HDInsight to Log Analytics workspace\"}},\"IotHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace\"}},\"KeyVaultLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Key Vault to Log Analytics workspace\"}},\"LoadBalancerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace\"}},\"LogicAppsISELogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace\"}},\"LogicAppsWFLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps Workflows to stream to a Log Analytics workspace when any Logic Apps Workflows which are missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps Workflows to Log Analytics workspace\"}},\"MariaDBLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for MariaDB to Log Analytics workspace\"}},\"MediaServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace\"}},\"MlWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace\"}},\"MySQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace\"}},\"NetworkNICLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace\"}},\"NetworkPublicIPNicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace\"}},\"NetworkSecurityGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace\"}},\"PostgreSQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace\"}},\"PowerBIEmbeddedLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace\"}},\"RedisCacheLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace\"}},\"RelayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Relay to Log Analytics workspace\"}},\"SQLDBsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace\"}},\"SQLElasticPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace\"}},\"SQLMLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace\"}},\"SearchServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Search Services to Log Analytics workspace\"}},\"ServiceBusLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace\"}},\"SignalRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SignalR to Log Analytics workspace\"}},\"StorageAccountsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Storage Accounts to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Storage Accounts to Log Analytics workspace\"}},\"StreamAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\"}},\"TimeSeriesInsightsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace\"}},\"TrafficManagerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace\"}},\"VMSSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace\"}},\"VNetGWLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace\"}},\"VirtualMachinesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace\"}},\"VirtualNetworkLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace\"}},\"WVDAppGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Application groups to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Application Groups to Log Analytics workspace\"}},\"WVDHostPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Host pools to stream to a Log Analytics workspace when any host pool which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Host pools to Log Analytics workspace\"}},\"WVDWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6f8f98a4-f108-47cb-8e98-91a0d85cd474",
                  "policy_group_names": [],
                  "reference_id": "StorageAccountDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AVDScalingPlansLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
                  "policy_group_names": [],
                  "reference_id": "AVDScalingPlansDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDAppGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
                  "policy_group_names": [],
                  "reference_id": "WVDAppGroupDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
                  "policy_group_names": [],
                  "reference_id": "WVDWorkspaceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDHostPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
                  "policy_group_names": [],
                  "reference_id": "WVDHostPoolsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACILogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
                  "policy_group_names": [],
                  "reference_id": "ACIDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
                  "policy_group_names": [],
                  "reference_id": "ACRDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('AKSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
                  "policy_group_names": [],
                  "reference_id": "AKSDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AnalysisServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
                  "policy_group_names": [],
                  "reference_id": "AnalysisServiceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIforFHIRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
                  "policy_group_names": [],
                  "reference_id": "APIforFHIRDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIMgmtLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
                  "policy_group_names": [],
                  "reference_id": "APIMgmtDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ApplicationGatewayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
                  "policy_group_names": [],
                  "reference_id": "ApplicationGatewayDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
                  "policy_group_names": [],
                  "reference_id": "AutomationDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BastionLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
                  "policy_group_names": [],
                  "reference_id": "BastionDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
                  "policy_group_names": [],
                  "reference_id": "BatchDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CDNEndpointsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
                  "policy_group_names": [],
                  "reference_id": "CDNEndpointsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
                  "policy_group_names": [],
                  "reference_id": "CognitiveServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
                  "policy_group_names": [],
                  "reference_id": "CosmosDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DatabricksLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
                  "policy_group_names": [],
                  "reference_id": "DatabricksDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataExplorerClusterLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
                  "policy_group_names": [],
                  "reference_id": "DataExplorerClusterDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataFactoryLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
                  "policy_group_names": [],
                  "reference_id": "DataFactoryDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeStoreLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
                  "policy_group_names": [],
                  "reference_id": "DataLakeStoreDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
                  "policy_group_names": [],
                  "reference_id": "DataLakeAnalyticsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridSubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
                  "policy_group_names": [],
                  "reference_id": "EventGridSubDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
                  "policy_group_names": [],
                  "reference_id": "EventGridTopicDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
                  "policy_group_names": [],
                  "reference_id": "EventHubDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventSystemTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
                  "policy_group_names": [],
                  "reference_id": "EventSystemTopicDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ExpressRouteLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
                  "policy_group_names": [],
                  "reference_id": "ExpressRouteDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FirewallLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
                  "policy_group_names": [],
                  "reference_id": "FirewallDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FrontDoorLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
                  "policy_group_names": [],
                  "reference_id": "FrontDoorDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionAppLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
                  "policy_group_names": [],
                  "reference_id": "FunctionAppDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('HDInsightLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
                  "policy_group_names": [],
                  "reference_id": "HDInsightDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('IotHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
                  "policy_group_names": [],
                  "reference_id": "IotHubDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
                  "policy_group_names": [],
                  "reference_id": "KeyVaultDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LoadBalancerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
                  "policy_group_names": [],
                  "reference_id": "LoadBalancerDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsISELogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
                  "policy_group_names": [],
                  "reference_id": "LogicAppsISEDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsWFLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
                  "policy_group_names": [],
                  "reference_id": "LogicAppsWFDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MariaDBLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
                  "policy_group_names": [],
                  "reference_id": "MariaDBDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MediaServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
                  "policy_group_names": [],
                  "reference_id": "MediaServiceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MlWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
                  "policy_group_names": [],
                  "reference_id": "MlWorkspaceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
                  "policy_group_names": [],
                  "reference_id": "MySQLDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkSecurityGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
                  "policy_group_names": [],
                  "reference_id": "NetworkSecurityGroupsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkNICLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
                  "policy_group_names": [],
                  "reference_id": "NetworkNICDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
                  "policy_group_names": [],
                  "reference_id": "PostgreSQLDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PowerBIEmbeddedLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
                  "policy_group_names": [],
                  "reference_id": "PowerBIEmbeddedDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkPublicIPNicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"True\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
                  "policy_group_names": [],
                  "reference_id": "NetworkPublicIPNicDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
                  "policy_group_names": [],
                  "reference_id": "RecoveryVaultDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisCacheLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
                  "policy_group_names": [],
                  "reference_id": "RedisCacheDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RelayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
                  "policy_group_names": [],
                  "reference_id": "RelayDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SearchServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
                  "policy_group_names": [],
                  "reference_id": "SearchServicesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ServiceBusLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
                  "policy_group_names": [],
                  "reference_id": "ServiceBusDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SignalRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
                  "policy_group_names": [],
                  "reference_id": "SignalRDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('SQLDBsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
                  "policy_group_names": [],
                  "reference_id": "SQLDatabaseDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLElasticPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
                  "policy_group_names": [],
                  "reference_id": "SQLElasticPoolsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLMLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
                  "policy_group_names": [],
                  "reference_id": "SQLMDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
                  "policy_group_names": [],
                  "reference_id": "StreamAnalyticsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('TimeSeriesInsightsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
                  "policy_group_names": [],
                  "reference_id": "TimeSeriesInsightsDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('TrafficManagerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
                  "policy_group_names": [],
                  "reference_id": "TrafficManagerDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualNetworkLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
                  "policy_group_names": [],
                  "reference_id": "VirtualNetworkDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualMachinesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
                  "policy_group_names": [],
                  "reference_id": "VirtualMachinesDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VMSSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
                  "policy_group_names": [],
                  "reference_id": "VMSSDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('VNetGWLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
                  "policy_group_names": [],
                  "reference_id": "VNetGWDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
                  "policy_group_names": [],
                  "reference_id": "AppServiceDeployDiagnosticLogDeployLogAnalytics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceWebappLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
                  "policy_group_names": [],
                  "reference_id": "AppServiceWebappDeployDiagnosticLogDeployLogAnalytics"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config": {
              "description": "Deploy Microsoft Defender for Cloud configuration",
              "display_name": "Deploy Microsoft Defender for Cloud configuration",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Security Center\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.2398675Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"3.0.0\"}",
              "name": "Deploy-MDFC-Config",
              "parameters": "{\"ascExportResourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource Group location for the export to Log Analytics workspace configuration\"}},\"ascExportResourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource Group name for the export to Log Analytics workspace configuration\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Microsoft Defender for Cloud contact details\",\"displayName\":\"Security contacts email address\"}},\"enableAscForAppServices\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForArm\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForContainers\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForDns\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForKeyVault\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForOssDb\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForServers\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSql\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSqlOnVm\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForStorage\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForOssDb')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                  "policy_group_names": [],
                  "reference_id": "defenderForOssDb"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                  "policy_group_names": [],
                  "reference_id": "defenderForVM"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSqlOnVm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                  "policy_group_names": [],
                  "reference_id": "defenderForSqlServerVirtualMachines"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForAppServices')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                  "policy_group_names": [],
                  "reference_id": "defenderForAppServices"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForStorage')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
                  "policy_group_names": [],
                  "reference_id": "defenderForStorageAccounts"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                  "policy_group_names": [],
                  "reference_id": "defenderforContainers"
                },
                {
                  "parameter_values": "{\"Effect\":{\"value\":\"[parameters('enableAscForKeyVault')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                  "policy_group_names": [],
                  "reference_id": "defenderForKeyVaults"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForDns')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
                  "policy_group_names": [],
                  "reference_id": "defenderForDns"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForArm')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                  "policy_group_names": [],
                  "reference_id": "defenderForArm"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSql')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                  "policy_group_names": [],
                  "reference_id": "defenderForSqlPaas"
                },
                {
                  "parameter_values": "{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                  "policy_group_names": [],
                  "reference_id": "securityEmailContact"
                },
                {
                  "parameter_values": "{\"resourceGroupLocation\":{\"value\":\"[parameters('ascExportResourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('ascExportResourceGroupName')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                  "policy_group_names": [],
                  "reference_id": "ascExport"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones": {
              "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
              "display_name": "Configure Azure PaaS services to use private DNS zones",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.3947574Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "name": "Deploy-Private-DNS-Zones",
              "parameters": "{\"azureAcrPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAcrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppServicesPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAsrPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAsrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureBatchPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureBatchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveSearchPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveSearchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveServicesPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDiskAccessPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDiskAccessPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridDomainsPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridDomainsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridTopicsPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridTopicsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventHubNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventHubNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureFilePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotHubsPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotHubsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureKeyVaultPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureKeyVaultPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMachineLearningWorkspacePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMachineLearningWorkspacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureRedisCachePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureRedisCachePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureServiceBusNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureServiceBusNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSignalRPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSignalRPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureWebPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effect1\":{\"type\":\"string\",\"allowedValues\":[\"deployIfNotExists\",\"Disabled\"],\"defaultValue\":\"deployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureFileprivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-File-Sync"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureWebPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-Web"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureBatchPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-Batch"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-App"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAsrPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-Site-Recovery"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-IoT"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureKeyVaultPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-KeyVault"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSignalRPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-SignalR"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppServicesPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-AppServices"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridTopicsPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-EventGridTopics"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDiskAccessPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-DiskAccess"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveServicesPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-CognitiveServices"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotHubsPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-IoTHubs"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridDomainsPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-EventGridDomains"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureRedisCachePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-RedisCache"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAcrPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-ACR"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventHubNamespacePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-EventHubNamespace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMachineLearningWorkspacePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-MachineLearningWorkspace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureServiceBusNamespacePrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-ServiceBusNamespace"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveSearchPrivateDnsZoneId')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
                  "policy_group_names": [],
                  "reference_id": "DINE-Private-DNS-Azure-CognitiveSearch"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security": {
              "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment",
              "display_name": "Deploy SQL Database built-in SQL security configuration",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:51.6155236Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "name": "Deploy-Sql-Security",
              "parameters": "{\"SqlDbAuditingSettingsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy auditing settings to SQL Database when it not exist in the deployment\",\"displayName\":\"Deploy SQL database auditing settings\"}},\"SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration\",\"displayName\":\"Deploy SQL Database security Alert Policies configuration with email admin accounts\"}},\"SqlDbTdeDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the Transparent Data Encryption when it is not enabled in the deployment\",\"displayName\":\"Deploy SQL Database Transparent Data Encryption \"}},\"SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters\",\"displayName\":\"Deploy SQL Database vulnerability Assessments\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbTdeDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
                  "policy_group_names": [],
                  "reference_id": "SqlDbTdeDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                  "policy_group_names": [],
                  "reference_id": "SqlDbSecurityAlertPoliciesDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                  "policy_group_names": [],
                  "reference_id": "SqlDbAuditingSettingsDeploySqlSecurity"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
                  "policy_group_names": [],
                  "reference_id": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit": {
              "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing exsistense condition require then the combination of Audit. ",
              "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Encryption\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.3892497Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "name": "Enforce-EncryptTransit",
              "parameters": "{\"AKSIngressHttpsOnlyEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\",\"displayName\":\"AKS Service. Enforce HTTPS ingress in Kubernetes cluster\"}},\"APIAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"APIAppServiceLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"App Service API App. Only Audit, deny not possible as it is a related resource.  Upgrade to the latest TLS version.\",\"displayName\":\"App Service API App. Latest TLS version should be used in your API App\"}},\"AppServiceHttpEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below\"}},\"AppServiceTlsVersionEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService WebApp, APIApp, Function App to enable https only\"}},\"AppServiceminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"App Service. Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"App Service. Select version minimum TLS Web App config\"}},\"FunctionLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Function App. Latest TLS version should be used in your Function App\"}},\"FunctionServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"MySQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server\"}},\"MySQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers\"}},\"MySQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"MySQL database servers. Select version minimum TLS for MySQL server\"}},\"PostgreSQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server\"}},\"PostgreSQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers\"}},\"PostgreSQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"PostgreSQL database servers. Select version minimum TLS for MySQL server\"}},\"RedisMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a Azure Cache for Redis to enforce\",\"displayName\":\"Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis\"}},\"RedisTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis\"}},\"RedisTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.\",\"displayName\":\"Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled\"}},\"SQLManagedInstanceMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure Managed Instanceto to  enforce\",\"displayName\":\"Azure Managed Instance.Select version minimum TLS for Azure Managed Instance\"}},\"SQLManagedInstanceTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLManagedInstanceTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"SQL Managed Instance should have the minimal TLS version of 1.2\"}},\"SQLServerTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLServerTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"Azure SQL Database should have the minimal TLS version of 1.2\"}},\"SQLServerminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure SQL Database to enforce\",\"displayName\":\"Azure SQL Database.Select version minimum TLS for Azure SQL Database\"}},\"StorageDeployHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled\"}},\"StorageHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Secure transfer to storage accounts should be enabled\"}},\"StorageminimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}},\"WebAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"WebAppServiceLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Web App. Latest TLS version should be used in your Web App\"}}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceHttpEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                  "policy_group_names": [],
                  "reference_id": "AppServiceHttpEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceTlsVersionEffect')]\"},\"minTlsVersion\":{\"value\":\"[parameters('AppServiceminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                  "policy_group_names": [],
                  "reference_id": "AppServiceminTlsVersion"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceLatestTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
                  "policy_group_names": [],
                  "reference_id": "APIAppServiceLatestTlsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionLatestTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                  "policy_group_names": [],
                  "reference_id": "FunctionLatestTlsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceLatestTlsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                  "policy_group_names": [],
                  "reference_id": "WebAppServiceLatestTlsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                  "policy_group_names": [],
                  "reference_id": "APIAppServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                  "policy_group_names": [],
                  "reference_id": "FunctionServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceHttpsEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                  "policy_group_names": [],
                  "reference_id": "WebAppServiceHttpsEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSIngressHttpsOnlyEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                  "policy_group_names": [],
                  "reference_id": "AKSIngressHttpsOnlyEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                  "policy_group_names": [],
                  "reference_id": "MySQLEnableSSLDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                  "policy_group_names": [],
                  "reference_id": "MySQLEnableSSLEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                  "policy_group_names": [],
                  "reference_id": "PostgreSQLEnableSSLDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                  "policy_group_names": [],
                  "reference_id": "PostgreSQLEnableSSLEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                  "policy_group_names": [],
                  "reference_id": "RedisTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                  "policy_group_names": [],
                  "reference_id": "RedisdisableNonSslPort"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                  "policy_group_names": [],
                  "reference_id": "RedisDenyhttps"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                  "policy_group_names": [],
                  "reference_id": "SQLManagedInstanceTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                  "policy_group_names": [],
                  "reference_id": "SQLManagedInstanceTLSEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                  "policy_group_names": [],
                  "reference_id": "SQLServerTLSDeployEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                  "policy_group_names": [],
                  "reference_id": "SQLServerTLSEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
                  "policy_group_names": [],
                  "reference_id": "StorageHttpsEnabledEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageDeployHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                  "policy_group_names": [],
                  "reference_id": "StorageDeployHttpsEnabledEffect"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK": {
              "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
              "display_name": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
              "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
              "metadata": "{\"category\":\"Encryption\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.3073887Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
              "name": "Enforce-Encryption-CMK",
              "parameters": "{\"ACRCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK.\",\"displayName\":\"Container registries should be encrypted with a customer-managed key (CMK)\"}},\"AksCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.\",\"displayName\":\"Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys\"}},\"AzureBatchCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK.\",\"displayName\":\"Azure Batch account should use customer-managed keys to encrypt data\"}},\"CognitiveServicesCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)\"}},\"CosmosCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\"}},\"DataBoxCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.\",\"displayName\":\"Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password\"}},\"EncryptedVMDisksEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\"displayName\":\"Disk encryption should be applied on virtual machines\"}},\"HealthcareAPIsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.\",\"displayName\":\"Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest\"}},\"MySQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure MySQL servers bring your own key data protection should be enabled\"}},\"PostgreSQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure PostgreSQL servers bring your own key data protection should be enabled\"}},\"SqlServerTDECMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\"displayName\":\"SQL servers should use customer-managed keys to encrypt data at rest\"}},\"StorageCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.\",\"displayName\":\"Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption\"}},\"StreamAnalyticsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.\",\"displayName\":\"Azure Stream Analytics jobs should use customer-managed keys to encrypt data\"}},\"SynapseWorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.\",\"displayName\":\"Azure Synapse workspaces should use customer-managed keys to encrypt data at rest\"}},\"WorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk.\",\"displayName\":\"Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)\"}}}",
              "policy_definition_group": [],
              "policy_definition_reference": [
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRCmkEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                  "policy_group_names": [],
                  "reference_id": "ACRCmkDeny"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AksCmkEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                  "policy_group_names": [],
                  "reference_id": "AksCmkDeny"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('WorkspaceCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                  "policy_group_names": [],
                  "reference_id": "WorkspaceCMK"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                  "policy_group_names": [],
                  "reference_id": "CognitiveServicesCMK"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                  "policy_group_names": [],
                  "reference_id": "CosmosCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataBoxCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                  "policy_group_names": [],
                  "reference_id": "DataBoxCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                  "policy_group_names": [],
                  "reference_id": "StreamAnalyticsCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SynapseWorkspaceCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                  "policy_group_names": [],
                  "reference_id": "SynapseWorkspaceCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                  "policy_group_names": [],
                  "reference_id": "StorageCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                  "policy_group_names": [],
                  "reference_id": "MySQLCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                  "policy_group_names": [],
                  "reference_id": "PostgreSQLCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerTDECMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
                  "policy_group_names": [],
                  "reference_id": "SqlServerTDECMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('HealthcareAPIsCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                  "policy_group_names": [],
                  "reference_id": "HealthcareAPIsCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureBatchCMKEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                  "policy_group_names": [],
                  "reference_id": "AzureBatchCMKEffect"
                },
                {
                  "parameter_values": "{\"effect\":{\"value\":\"[parameters('EncryptedVMDisksEffect')]\"}}",
                  "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                  "policy_group_names": [],
                  "reference_id": "EncryptedVMDisksEffect"
                }
              ],
              "policy_type": "Custom",
              "timeouts": null
            }
          }
        },
        "azurerm_private_dns_zone": {
          "connectivity": {}
        },
        "azurerm_private_dns_zone_virtual_network_link": {
          "connectivity": {}
        },
        "azurerm_public_ip": {
          "connectivity": {}
        },
        "azurerm_resource_group": {
          "connectivity": {},
          "management": {},
          "virtual_wan": {}
        },
        "azurerm_role_assignment": {
          "enterprise_scale": {},
          "policy_assignment": {
            "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/roleAssignments/028e4ae6-a922-5301-a205-e87a31f52028": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/roleAssignments/028e4ae6-a922-5301-a205-e87a31f52028",
              "name": "028e4ae6-a922-5301-a205-e87a31f52028",
              "principal_id": "e3dca87c-4eda-4839-89a8-ea94a494eb06",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "role_definition_name": "Network Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/3f191ce5-8482-58ee-a7c6-3e9b73c12bd7": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/3f191ce5-8482-58ee-a7c6-3e9b73c12bd7",
              "name": "3f191ce5-8482-58ee-a7c6-3e9b73c12bd7",
              "principal_id": "337397ea-629a-4e54-84ba-86f1b64a5aac",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
              "role_definition_name": "Backup Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/5917d705-5588-5e72-af0a-6839056caac1": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/5917d705-5588-5e72-af0a-6839056caac1",
              "name": "5917d705-5588-5e72-af0a-6839056caac1",
              "principal_id": "337397ea-629a-4e54-84ba-86f1b64a5aac",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
              "role_definition_name": "Virtual Machine Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/077a6b5a-1486-53b9-bf53-ccdc66e4c97d": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/077a6b5a-1486-53b9-bf53-ccdc66e4c97d",
              "name": "077a6b5a-1486-53b9-bf53-ccdc66e4c97d",
              "principal_id": "e5e508e4-16f8-4917-8d92-736b1713b736",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "role_definition_name": "Network Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/10d0f6f2-2551-5965-80d0-788f9756b4e4": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/10d0f6f2-2551-5965-80d0-788f9756b4e4",
              "name": "10d0f6f2-2551-5965-80d0-788f9756b4e4",
              "principal_id": "2670d7f6-ade2-4981-a7db-8b96887c805a",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064",
              "role_definition_name": "Azure Kubernetes Service Policy Add-on Deployment",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/132d36b5-3244-5877-bc0f-eff7b5e025e8": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/132d36b5-3244-5877-bc0f-eff7b5e025e8",
              "name": "132d36b5-3244-5877-bc0f-eff7b5e025e8",
              "principal_id": "2670d7f6-ade2-4981-a7db-8b96887c805a",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
              "role_definition_name": "Azure Kubernetes Service Contributor Role",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/3765ef65-d837-589b-bcb7-f80fd9e06ae5": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/3765ef65-d837-589b-bcb7-f80fd9e06ae5",
              "name": "3765ef65-d837-589b-bcb7-f80fd9e06ae5",
              "principal_id": "b41dd1e8-60ba-413d-8b9e-c730f7f66a8c",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
              "role_definition_name": "Virtual Machine Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/386e08bd-4951-5610-8481-4efa031400b9": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/386e08bd-4951-5610-8481-4efa031400b9",
              "name": "386e08bd-4951-5610-8481-4efa031400b9",
              "principal_id": "3187194f-5bd4-417f-ad65-e0249d4d9b9b",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
              "role_definition_name": "Owner",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/9d0082f2-c983-5321-b25e-f1e82e52dfdb": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/9d0082f2-c983-5321-b25e-f1e82e52dfdb",
              "name": "9d0082f2-c983-5321-b25e-f1e82e52dfdb",
              "principal_id": "b41dd1e8-60ba-413d-8b9e-c730f7f66a8c",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
              "role_definition_name": "Backup Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/cceb009d-6f8c-5e2a-8a97-2ed5ba42d98a": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/cceb009d-6f8c-5e2a-8a97-2ed5ba42d98a",
              "name": "cceb009d-6f8c-5e2a-8a97-2ed5ba42d98a",
              "principal_id": "95fd991f-4b44-4632-9956-ec717353044f",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
              "role_definition_name": "SQL Security Manager",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/roleAssignments/755732f5-ad4f-503f-8b6d-87a7eb9cf3c7": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/roleAssignments/755732f5-ad4f-503f-8b6d-87a7eb9cf3c7",
              "name": "755732f5-ad4f-503f-8b6d-87a7eb9cf3c7",
              "principal_id": "446ee1d3-e350-49d8-8959-063aa4d2869f",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
              "role_definition_name": "Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes-management",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/016bfe06-1570-5466-b41b-60d812bd394c": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/016bfe06-1570-5466-b41b-60d812bd394c",
              "name": "016bfe06-1570-5466-b41b-60d812bd394c",
              "principal_id": "d6e1bc35-0ca2-4548-960c-7e0fd459f27c",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "role_definition_name": "Monitoring Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/1ffdcdde-4093-5b0d-88a2-89a7dfa9e8d5": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/1ffdcdde-4093-5b0d-88a2-89a7dfa9e8d5",
              "name": "1ffdcdde-4093-5b0d-88a2-89a7dfa9e8d5",
              "principal_id": "326a98f6-e2ef-4a24-a680-4bfc73e4dd8a",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "role_definition_name": "Log Analytics Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/384d3363-057a-5faf-8f04-1861554dd8b3": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/384d3363-057a-5faf-8f04-1861554dd8b3",
              "name": "384d3363-057a-5faf-8f04-1861554dd8b3",
              "principal_id": "149b5d6b-5dcf-4170-b8b6-068c64e65db1",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "role_definition_name": "Monitoring Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/4c06a3b1-cc33-5720-8e41-731989c6065f": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/4c06a3b1-cc33-5720-8e41-731989c6065f",
              "name": "4c06a3b1-cc33-5720-8e41-731989c6065f",
              "principal_id": "d6e1bc35-0ca2-4548-960c-7e0fd459f27c",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "role_definition_name": "Log Analytics Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/7d7071a2-cea0-5785-8e35-bc134e360f1a": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/7d7071a2-cea0-5785-8e35-bc134e360f1a",
              "name": "7d7071a2-cea0-5785-8e35-bc134e360f1a",
              "principal_id": "149b5d6b-5dcf-4170-b8b6-068c64e65db1",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "role_definition_name": "Log Analytics Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/869b0b16-638a-5689-8c10-396418361fce": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/869b0b16-638a-5689-8c10-396418361fce",
              "name": "869b0b16-638a-5689-8c10-396418361fce",
              "principal_id": "d446ce0e-2340-49e3-8e98-014320208b3e",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "role_definition_name": "Log Analytics Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/91995f36-f926-55d1-beff-11f099a406c3": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/91995f36-f926-55d1-beff-11f099a406c3",
              "name": "91995f36-f926-55d1-beff-11f099a406c3",
              "principal_id": "d06972c8-86ed-4280-b446-1c6f06f7f49b",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
              "role_definition_name": "Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/bb1fb7b2-d6ad-548a-92d5-05e0104b0dcb": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/bb1fb7b2-d6ad-548a-92d5-05e0104b0dcb",
              "name": "bb1fb7b2-d6ad-548a-92d5-05e0104b0dcb",
              "principal_id": "1f6143ea-79c0-4005-a2d6-670ec56d86e6",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
              "role_definition_name": "Virtual Machine Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/ccde9c1e-f66c-5db2-8b76-6b1aefce5725": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/ccde9c1e-f66c-5db2-8b76-6b1aefce5725",
              "name": "ccde9c1e-f66c-5db2-8b76-6b1aefce5725",
              "principal_id": "d06972c8-86ed-4280-b446-1c6f06f7f49b",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd",
              "role_definition_name": "Security Admin",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e1be750f-59c4-52f6-a958-c8508fe2c3f0": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e1be750f-59c4-52f6-a958-c8508fe2c3f0",
              "name": "e1be750f-59c4-52f6-a958-c8508fe2c3f0",
              "principal_id": "5f378ab8-6e7a-4757-b8f0-a31145b39f55",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "role_definition_name": "Log Analytics Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            },
            "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e825572c-42bd-5f1d-8c21-9a351b37b98e": {
              "condition": "",
              "condition_version": "",
              "delegated_managed_identity_resource_id": "",
              "description": "",
              "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e825572c-42bd-5f1d-8c21-9a351b37b98e",
              "name": "e825572c-42bd-5f1d-8c21-9a351b37b98e",
              "principal_id": "1f6143ea-79c0-4005-a2d6-670ec56d86e6",
              "principal_type": "ServicePrincipal",
              "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "role_definition_name": "Log Analytics Contributor",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "skip_service_principal_aad_check": null,
              "timeouts": null
            }
          }
        },
        "azurerm_role_definition": {
          "enterprise_scale": {
            "/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/vcfes"
              ],
              "description": "Contributor role granted for application/operations team at resource group level",
              "id": "/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8|/providers/Microsoft.Management/managementGroups/vcfes",
              "name": "[VCFES] Application-Owners",
              "permissions": [
                {
                  "actions": [
                    "*"
                  ],
                  "data_actions": [],
                  "not_actions": [
                    "Microsoft.Authorization/*/write",
                    "Microsoft.Network/publicIPAddresses/write",
                    "Microsoft.Network/virtualNetworks/write",
                    "Microsoft.KeyVault/locations/deletedVaults/purge/action"
                  ],
                  "not_data_actions": []
                }
              ],
              "role_definition_id": "24206246-503f-51f2-b19d-2beb6a57fcb8",
              "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "timeouts": null
            },
            "/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/vcfes"
              ],
              "description": "Security Administrator role with a horizontal view across the entire Azure estate and the Azure Key Vault purge policy.",
              "id": "/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d|/providers/Microsoft.Management/managementGroups/vcfes",
              "name": "[VCFES] Security-Operations",
              "permissions": [
                {
                  "actions": [
                    "*/read",
                    "*/register/action",
                    "Microsoft.KeyVault/locations/deletedVaults/purge/action",
                    "Microsoft.PolicyInsights/*",
                    "Microsoft.Authorization/policyAssignments/*",
                    "Microsoft.Authorization/policyDefinitions/*",
                    "Microsoft.Authorization/policyExemptions/*",
                    "Microsoft.Authorization/policySetDefinitions/*",
                    "Microsoft.Insights/alertRules/*",
                    "Microsoft.Resources/deployments/*",
                    "Microsoft.Security/*",
                    "Microsoft.Support/*"
                  ],
                  "data_actions": [],
                  "not_actions": [],
                  "not_data_actions": []
                }
              ],
              "role_definition_id": "db98be45-ff1e-5a92-81fb-14fd94ec162d",
              "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "timeouts": null
            },
            "/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/vcfes"
              ],
              "description": "Platform-wide global connectivity management: virtual networks, UDRs, NSGs, NVAs, VPN, Azure ExpressRoute, and others",
              "id": "/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a|/providers/Microsoft.Management/managementGroups/vcfes",
              "name": "[VCFES] Network-Management",
              "permissions": [
                {
                  "actions": [
                    "*/read",
                    "Microsoft.Network/*",
                    "Microsoft.Resources/deployments/*",
                    "Microsoft.Support/*"
                  ],
                  "data_actions": [],
                  "not_actions": [],
                  "not_data_actions": []
                }
              ],
              "role_definition_id": "f9521a0d-afd3-581b-be01-62b7f06c2d2a",
              "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "timeouts": null
            },
            "/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/vcfes"
              ],
              "description": "Delegated role for subscription owner generated from subscription Owner role",
              "id": "/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99|/providers/Microsoft.Management/managementGroups/vcfes",
              "name": "[VCFES] Subscription-Owner",
              "permissions": [
                {
                  "actions": [
                    "*"
                  ],
                  "data_actions": [],
                  "not_actions": [
                    "Microsoft.Authorization/*/write",
                    "Microsoft.Network/vpnGateways/*",
                    "Microsoft.Network/expressRouteCircuits/*",
                    "Microsoft.Network/routeTables/write",
                    "Microsoft.Network/vpnSites/*"
                  ],
                  "not_data_actions": []
                }
              ],
              "role_definition_id": "fb0a57af-518e-57b6-98c0-62ab07f3ca99",
              "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "timeouts": null
            },
            "/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9": {
              "assignable_scopes": [
                "/providers/Microsoft.Management/managementGroups/vcfes"
              ],
              "description": "Enterprise-scale custom Role Definition. Grants full access to manage Virtual Network subnets, but no other network resources.",
              "id": "/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9|/providers/Microsoft.Management/managementGroups/vcfes",
              "name": "[VCFES] Network-Subnet-Contributor",
              "permissions": [
                {
                  "actions": [
                    "Microsoft.Authorization/*/read",
                    "Microsoft.Insights/alertRules/*",
                    "Microsoft.ResourceHealth/availabilityStatuses/read",
                    "Microsoft.Resources/deployments/*",
                    "Microsoft.Resources/subscriptions/resourceGroups/read",
                    "Microsoft.Support/*",
                    "Microsoft.Network/*/read",
                    "Microsoft.Network/virtualNetworks/subnets/*"
                  ],
                  "data_actions": [],
                  "not_actions": [],
                  "not_data_actions": []
                }
              ],
              "role_definition_id": "fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9",
              "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9",
              "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
              "timeouts": null
            }
          }
        },
        "azurerm_subnet": {
          "connectivity": {}
        },
        "azurerm_virtual_hub": {
          "virtual_wan": {}
        },
        "azurerm_virtual_hub_connection": {
          "virtual_wan": {}
        },
        "azurerm_virtual_network": {
          "connectivity": {}
        },
        "azurerm_virtual_network_gateway": {
          "connectivity": {}
        },
        "azurerm_virtual_network_peering": {
          "connectivity": {}
        },
        "azurerm_virtual_wan": {
          "virtual_wan": {}
        },
        "azurerm_vpn_gateway": {
          "virtual_wan": {}
        }
      },
      "type": [
        "object",
        {
          "azurerm_automation_account": [
            "object",
            {
              "management": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_dns_zone": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_express_route_gateway": [
            "object",
            {
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_firewall": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ],
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_firewall_policy": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ],
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_log_analytics_linked_service": [
            "object",
            {
              "management": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_log_analytics_solution": [
            "object",
            {
              "management": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_log_analytics_workspace": [
            "object",
            {
              "management": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_management_group": [
            "object",
            {
              "level_1": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-root": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ],
              "level_2": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes-decommissioned": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-platform": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-sandboxes": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ],
              "level_3": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes-connectivity": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-corp": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-identity": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-management": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-online": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ],
              "level_4": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes-corp-non-prod": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-corp-prod": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-online-web": [
                    "object",
                    {
                      "display_name": "string",
                      "id": "string",
                      "name": "string",
                      "parent_management_group_id": "string",
                      "subscription_ids": [
                        "set",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ],
              "level_5": [
                "object",
                {}
              ],
              "level_6": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_management_group_policy_assignment": [
            "object",
            {
              "enterprise_scale": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-LX-Arc-Monitoring": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-WS-Arc-Monitoring": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "enforce": "bool",
                      "id": "string",
                      "identity": [
                        "list",
                        [
                          "object",
                          {
                            "identity_ids": [
                              "set",
                              "string"
                            ],
                            "principal_id": "string",
                            "tenant_id": "string",
                            "type": "string"
                          }
                        ]
                      ],
                      "location": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "non_compliance_message": [
                        "list",
                        [
                          "object",
                          {
                            "content": "string",
                            "policy_definition_reference_id": "string"
                          }
                        ]
                      ],
                      "not_scopes": [
                        "list",
                        "string"
                      ],
                      "parameters": "string",
                      "policy_definition_id": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "azurerm_management_group_subscription_association": [
            "object",
            {
              "enterprise_scale": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_network_ddos_protection_plan": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_policy_definition": [
            "object",
            {
              "enterprise_scale": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/VCF-Deploy-Nsg-FlowLogs": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/VCF-Enforce-RG-Tags": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "mode": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_rule": "string",
                      "policy_type": "string",
                      "role_definition_ids": [
                        "list",
                        "string"
                      ],
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "azurerm_policy_set_definition": [
            "object",
            {
              "enterprise_scale": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_definition_group": [
                        "set",
                        [
                          "object",
                          {
                            "additional_metadata_resource_id": "string",
                            "category": "string",
                            "description": "string",
                            "display_name": "string",
                            "name": "string"
                          }
                        ]
                      ],
                      "policy_definition_reference": [
                        "list",
                        [
                          "object",
                          {
                            "parameter_values": "string",
                            "policy_definition_id": "string",
                            "policy_group_names": [
                              "set",
                              "string"
                            ],
                            "reference_id": "string"
                          }
                        ]
                      ],
                      "policy_type": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_definition_group": [
                        "set",
                        [
                          "object",
                          {
                            "additional_metadata_resource_id": "string",
                            "category": "string",
                            "description": "string",
                            "display_name": "string",
                            "name": "string"
                          }
                        ]
                      ],
                      "policy_definition_reference": [
                        "list",
                        [
                          "object",
                          {
                            "parameter_values": "string",
                            "policy_definition_id": "string",
                            "policy_group_names": [
                              "set",
                              "string"
                            ],
                            "reference_id": "string"
                          }
                        ]
                      ],
                      "policy_type": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_definition_group": [
                        "set",
                        [
                          "object",
                          {
                            "additional_metadata_resource_id": "string",
                            "category": "string",
                            "description": "string",
                            "display_name": "string",
                            "name": "string"
                          }
                        ]
                      ],
                      "policy_definition_reference": [
                        "list",
                        [
                          "object",
                          {
                            "parameter_values": "string",
                            "policy_definition_id": "string",
                            "policy_group_names": [
                              "set",
                              "string"
                            ],
                            "reference_id": "string"
                          }
                        ]
                      ],
                      "policy_type": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_definition_group": [
                        "set",
                        [
                          "object",
                          {
                            "additional_metadata_resource_id": "string",
                            "category": "string",
                            "description": "string",
                            "display_name": "string",
                            "name": "string"
                          }
                        ]
                      ],
                      "policy_definition_reference": [
                        "list",
                        [
                          "object",
                          {
                            "parameter_values": "string",
                            "policy_definition_id": "string",
                            "policy_group_names": [
                              "set",
                              "string"
                            ],
                            "reference_id": "string"
                          }
                        ]
                      ],
                      "policy_type": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_definition_group": [
                        "set",
                        [
                          "object",
                          {
                            "additional_metadata_resource_id": "string",
                            "category": "string",
                            "description": "string",
                            "display_name": "string",
                            "name": "string"
                          }
                        ]
                      ],
                      "policy_definition_reference": [
                        "list",
                        [
                          "object",
                          {
                            "parameter_values": "string",
                            "policy_definition_id": "string",
                            "policy_group_names": [
                              "set",
                              "string"
                            ],
                            "reference_id": "string"
                          }
                        ]
                      ],
                      "policy_type": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_definition_group": [
                        "set",
                        [
                          "object",
                          {
                            "additional_metadata_resource_id": "string",
                            "category": "string",
                            "description": "string",
                            "display_name": "string",
                            "name": "string"
                          }
                        ]
                      ],
                      "policy_definition_reference": [
                        "list",
                        [
                          "object",
                          {
                            "parameter_values": "string",
                            "policy_definition_id": "string",
                            "policy_group_names": [
                              "set",
                              "string"
                            ],
                            "reference_id": "string"
                          }
                        ]
                      ],
                      "policy_type": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK": [
                    "object",
                    {
                      "description": "string",
                      "display_name": "string",
                      "id": "string",
                      "management_group_id": "string",
                      "metadata": "string",
                      "name": "string",
                      "parameters": "string",
                      "policy_definition_group": [
                        "set",
                        [
                          "object",
                          {
                            "additional_metadata_resource_id": "string",
                            "category": "string",
                            "description": "string",
                            "display_name": "string",
                            "name": "string"
                          }
                        ]
                      ],
                      "policy_definition_reference": [
                        "list",
                        [
                          "object",
                          {
                            "parameter_values": "string",
                            "policy_definition_id": "string",
                            "policy_group_names": [
                              "set",
                              "string"
                            ],
                            "reference_id": "string"
                          }
                        ]
                      ],
                      "policy_type": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "azurerm_private_dns_zone": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_private_dns_zone_virtual_network_link": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_public_ip": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_resource_group": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ],
              "management": [
                "object",
                {}
              ],
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_role_assignment": [
            "object",
            {
              "enterprise_scale": [
                "object",
                {}
              ],
              "policy_assignment": [
                "object",
                {
                  "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/roleAssignments/028e4ae6-a922-5301-a205-e87a31f52028": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/3f191ce5-8482-58ee-a7c6-3e9b73c12bd7": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/5917d705-5588-5e72-af0a-6839056caac1": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/077a6b5a-1486-53b9-bf53-ccdc66e4c97d": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/10d0f6f2-2551-5965-80d0-788f9756b4e4": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/132d36b5-3244-5877-bc0f-eff7b5e025e8": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/3765ef65-d837-589b-bcb7-f80fd9e06ae5": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/386e08bd-4951-5610-8481-4efa031400b9": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/9d0082f2-c983-5321-b25e-f1e82e52dfdb": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/cceb009d-6f8c-5e2a-8a97-2ed5ba42d98a": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/roleAssignments/755732f5-ad4f-503f-8b6d-87a7eb9cf3c7": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/016bfe06-1570-5466-b41b-60d812bd394c": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/1ffdcdde-4093-5b0d-88a2-89a7dfa9e8d5": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/384d3363-057a-5faf-8f04-1861554dd8b3": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/4c06a3b1-cc33-5720-8e41-731989c6065f": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/7d7071a2-cea0-5785-8e35-bc134e360f1a": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/869b0b16-638a-5689-8c10-396418361fce": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/91995f36-f926-55d1-beff-11f099a406c3": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/bb1fb7b2-d6ad-548a-92d5-05e0104b0dcb": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/ccde9c1e-f66c-5db2-8b76-6b1aefce5725": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e1be750f-59c4-52f6-a958-c8508fe2c3f0": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e825572c-42bd-5f1d-8c21-9a351b37b98e": [
                    "object",
                    {
                      "condition": "string",
                      "condition_version": "string",
                      "delegated_managed_identity_resource_id": "string",
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "principal_id": "string",
                      "principal_type": "string",
                      "role_definition_id": "string",
                      "role_definition_name": "string",
                      "scope": "string",
                      "skip_service_principal_aad_check": "bool",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "azurerm_role_definition": [
            "object",
            {
              "enterprise_scale": [
                "object",
                {
                  "/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8": [
                    "object",
                    {
                      "assignable_scopes": [
                        "list",
                        "string"
                      ],
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "permissions": [
                        "list",
                        [
                          "object",
                          {
                            "actions": [
                              "list",
                              "string"
                            ],
                            "data_actions": [
                              "set",
                              "string"
                            ],
                            "not_actions": [
                              "list",
                              "string"
                            ],
                            "not_data_actions": [
                              "set",
                              "string"
                            ]
                          }
                        ]
                      ],
                      "role_definition_id": "string",
                      "role_definition_resource_id": "string",
                      "scope": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d": [
                    "object",
                    {
                      "assignable_scopes": [
                        "list",
                        "string"
                      ],
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "permissions": [
                        "list",
                        [
                          "object",
                          {
                            "actions": [
                              "list",
                              "string"
                            ],
                            "data_actions": [
                              "set",
                              "string"
                            ],
                            "not_actions": [
                              "list",
                              "string"
                            ],
                            "not_data_actions": [
                              "set",
                              "string"
                            ]
                          }
                        ]
                      ],
                      "role_definition_id": "string",
                      "role_definition_resource_id": "string",
                      "scope": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a": [
                    "object",
                    {
                      "assignable_scopes": [
                        "list",
                        "string"
                      ],
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "permissions": [
                        "list",
                        [
                          "object",
                          {
                            "actions": [
                              "list",
                              "string"
                            ],
                            "data_actions": [
                              "set",
                              "string"
                            ],
                            "not_actions": [
                              "list",
                              "string"
                            ],
                            "not_data_actions": [
                              "set",
                              "string"
                            ]
                          }
                        ]
                      ],
                      "role_definition_id": "string",
                      "role_definition_resource_id": "string",
                      "scope": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99": [
                    "object",
                    {
                      "assignable_scopes": [
                        "list",
                        "string"
                      ],
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "permissions": [
                        "list",
                        [
                          "object",
                          {
                            "actions": [
                              "list",
                              "string"
                            ],
                            "data_actions": [
                              "set",
                              "string"
                            ],
                            "not_actions": [
                              "list",
                              "string"
                            ],
                            "not_data_actions": [
                              "set",
                              "string"
                            ]
                          }
                        ]
                      ],
                      "role_definition_id": "string",
                      "role_definition_resource_id": "string",
                      "scope": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ],
                  "/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9": [
                    "object",
                    {
                      "assignable_scopes": [
                        "list",
                        "string"
                      ],
                      "description": "string",
                      "id": "string",
                      "name": "string",
                      "permissions": [
                        "list",
                        [
                          "object",
                          {
                            "actions": [
                              "list",
                              "string"
                            ],
                            "data_actions": [
                              "set",
                              "string"
                            ],
                            "not_actions": [
                              "list",
                              "string"
                            ],
                            "not_data_actions": [
                              "set",
                              "string"
                            ]
                          }
                        ]
                      ],
                      "role_definition_id": "string",
                      "role_definition_resource_id": "string",
                      "scope": "string",
                      "timeouts": [
                        "object",
                        {
                          "create": "string",
                          "delete": "string",
                          "read": "string",
                          "update": "string"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "azurerm_subnet": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_virtual_hub": [
            "object",
            {
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_virtual_hub_connection": [
            "object",
            {
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_virtual_network": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_virtual_network_gateway": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_virtual_network_peering": [
            "object",
            {
              "connectivity": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_virtual_wan": [
            "object",
            {
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ],
          "azurerm_vpn_gateway": [
            "object",
            {
              "virtual_wan": [
                "object",
                {}
              ]
            }
          ]
        }
      ],
      "sensitive": true
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "9a6290b3-6b33-419f-a634-6a94b7cdbce7",
            "id": "2022-09-18 17:27:01.435404262 +0000 UTC",
            "object_id": "fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3",
            "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
            "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "external",
      "name": "reconcile_susbscription_ids_from_management_groups",
      "provider": "provider[\"registry.terraform.io/hashicorp/external\"]",
      "instances": [
        {
          "index_key": "vcfes-corp",
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "bash",
              "-c",
              "az rest --method GET --url https://management.azure.com/providers/Microsoft.Management/managementGroups/vcfes-corp/subscriptions?api-version=2020-05-01 --query \"[value][].name | sort(@) | {subscription_ids: join(',', @)}\" -o json 2\u003e/dev/null || echo '{\"subscription_ids\":\"\"}' | jq -r"
            ],
            "query": null,
            "result": {
              "subscription_ids": ""
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "vcfes-corp-non-prod",
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "bash",
              "-c",
              "az rest --method GET --url https://management.azure.com/providers/Microsoft.Management/managementGroups/vcfes-corp-non-prod/subscriptions?api-version=2020-05-01 --query \"[value][].name | sort(@) | {subscription_ids: join(',', @)}\" -o json 2\u003e/dev/null || echo '{\"subscription_ids\":\"\"}' | jq -r"
            ],
            "query": null,
            "result": {
              "subscription_ids": ""
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "vcfes-corp-prod",
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "bash",
              "-c",
              "az rest --method GET --url https://management.azure.com/providers/Microsoft.Management/managementGroups/vcfes-corp-prod/subscriptions?api-version=2020-05-01 --query \"[value][].name | sort(@) | {subscription_ids: join(',', @)}\" -o json 2\u003e/dev/null || echo '{\"subscription_ids\":\"\"}' | jq -r"
            ],
            "query": null,
            "result": {
              "subscription_ids": ""
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "vcfes-online",
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "bash",
              "-c",
              "az rest --method GET --url https://management.azure.com/providers/Microsoft.Management/managementGroups/vcfes-online/subscriptions?api-version=2020-05-01 --query \"[value][].name | sort(@) | {subscription_ids: join(',', @)}\" -o json 2\u003e/dev/null || echo '{\"subscription_ids\":\"\"}' | jq -r"
            ],
            "query": null,
            "result": {
              "subscription_ids": ""
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "vcfes-online-web",
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "bash",
              "-c",
              "az rest --method GET --url https://management.azure.com/providers/Microsoft.Management/managementGroups/vcfes-online-web/subscriptions?api-version=2020-05-01 --query \"[value][].name | sort(@) | {subscription_ids: join(',', @)}\" -o json 2\u003e/dev/null || echo '{\"subscription_ids\":\"\"}' | jq -r"
            ],
            "query": null,
            "result": {
              "subscription_ids": ""
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "vcfes-root",
          "schema_version": 0,
          "attributes": {
            "id": "-",
            "program": [
              "bash",
              "-c",
              "az rest --method GET --url https://management.azure.com/providers/Microsoft.Management/managementGroups/vcfes-root/subscriptions?api-version=2020-05-01 --query \"[value][].name | sort(@) | {subscription_ids: join(',', @)}\" -o json 2\u003e/dev/null || echo '{\"subscription_ids\":\"\"}' | jq -r"
            ],
            "query": null,
            "result": {
              "subscription_ids": ""
            },
            "working_dir": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "terraform_remote_state",
      "name": "remote",
      "provider": "provider[\"terraform.io/builtin/terraform\"]",
      "instances": [
        {
          "index_key": "identity",
          "schema_version": 0,
          "attributes": {
            "backend": "azurerm",
            "config": {
              "value": {
                "container_name": "tfstate",
                "key": "identity.tfstate",
                "resource_group_name": "vcf-rg-caf-level1-giv",
                "storage_account_name": "vcfstl1rsy",
                "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
              },
              "type": [
                "object",
                {
                  "container_name": "string",
                  "key": "string",
                  "resource_group_name": "string",
                  "storage_account_name": "string",
                  "subscription_id": "string",
                  "tenant_id": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "connectivity_subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                "connectivity_tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "custom_variables": {},
                "diagnostics": {
                  "diagnostics_definition": {},
                  "diagnostics_destinations": {
                    "event_hub_namespaces": {},
                    "log_analytics": {},
                    "storage": {}
                  },
                  "event_hub_namespaces": {},
                  "log_analytics": {},
                  "storage_accounts": {}
                },
                "global_settings": {
                  "default_region": "region1",
                  "environment": "vcfobs",
                  "inherit_tags": false,
                  "passthrough": false,
                  "prefix": "vcf",
                  "prefix_with_hyphen": "vcf",
                  "prefixes": [
                    "vcf"
                  ],
                  "random_length": 3,
                  "regions": {
                    "region1": "francecentral",
                    "region2": "francesouth"
                  },
                  "tags": {},
                  "use_slug": true
                },
                "launchpad_identities": {},
                "objects": {
                  "identity": {
                    "client_config": {
                      "landingzone_key": "identity",
                      "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                      "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                    },
                    "diagnostics": {
                      "diagnostics_definition": {},
                      "diagnostics_destinations": {
                        "event_hub_namespaces": {},
                        "log_analytics": {},
                        "storage": {}
                      },
                      "event_hub_namespaces": {},
                      "log_analytics": {},
                      "storage_accounts": {}
                    },
                    "global_settings": {
                      "default_region": "region1",
                      "environment": "vcfobs",
                      "inherit_tags": false,
                      "passthrough": false,
                      "prefix": "vcf",
                      "prefix_with_hyphen": "vcf",
                      "prefixes": [
                        "vcf"
                      ],
                      "random_length": 3,
                      "regions": {
                        "region1": "francecentral",
                        "region2": "francesouth"
                      },
                      "tags": {},
                      "use_slug": true
                    },
                    "recovery_vaults": {
                      "asr": {
                        "backup_policies": {
                          "file_shares": {},
                          "virtual_machines": {
                            "default": {
                              "backup": [
                                {
                                  "frequency": "Daily",
                                  "time": "23:00",
                                  "weekdays": null
                                }
                              ],
                              "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-few/providers/Microsoft.RecoveryServices/vaults/vcf-rsv-asr-jnx/backupPolicies/vm-default-policy",
                              "instant_restore_retention_days": 2,
                              "name": "vm-default-policy",
                              "recovery_vault_name": "vcf-rsv-asr-jnx",
                              "resource_group_name": "vcf-rg-management-few",
                              "retention_daily": [
                                {
                                  "count": 7
                                }
                              ],
                              "retention_monthly": [
                                {
                                  "count": 2,
                                  "weekdays": [
                                    "Sunday"
                                  ],
                                  "weeks": [
                                    "First"
                                  ]
                                }
                              ],
                              "retention_weekly": [
                                {
                                  "count": 2,
                                  "weekdays": [
                                    "Sunday"
                                  ]
                                }
                              ],
                              "retention_yearly": [
                                {
                                  "count": 1,
                                  "months": [
                                    "January"
                                  ],
                                  "weekdays": [
                                    "Sunday"
                                  ],
                                  "weeks": [
                                    "First"
                                  ]
                                }
                              ],
                              "tags": null,
                              "timeouts": null,
                              "timezone": "Romance Standard Time"
                            }
                          }
                        },
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-few/providers/Microsoft.RecoveryServices/vaults/vcf-rsv-asr-jnx",
                        "name": "vcf-rsv-asr-jnx",
                        "rbac_id": "9666de16-1c19-4c64-b597-6e04addcca75",
                        "replication_policies": {},
                        "resource_group_name": "vcf-rg-management-few",
                        "soft_delete_enabled": true
                      }
                    },
                    "resource_groups": {
                      "alerts": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-alerts-iea",
                        "location": "francecentral",
                        "name": "vcf-rg-alerts-iea",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-alerts-iea",
                        "tags": {
                          "environment": "vcfobs",
                          "level": "level1",
                          "rover_version": "rhadi2005/rover:1.2.5-2209"
                        }
                      },
                      "management": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-few",
                        "location": "francecentral",
                        "name": "vcf-rg-management-few",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-few",
                        "tags": {
                          "environment": "vcfobs",
                          "level": "level1",
                          "rover_version": "rhadi2005/rover:1.2.5-2209"
                        }
                      }
                    }
                  }
                },
                "tfstates": {
                  "identity": {
                    "container_name": "tfstate",
                    "key": "identity.tfstate",
                    "level": "level1",
                    "resource_group_name": "vcf-rg-caf-level1-giv",
                    "storage_account_name": "vcfstl1rsy",
                    "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                    "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                  },
                  "launchpad": {
                    "container_name": "tfstate",
                    "key": "caf_launchpad.tfstate",
                    "level": "level0",
                    "resource_group_name": "vcf-rg-caf-level0-ytn",
                    "storage_account_name": "vcfstl0pag",
                    "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                    "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                  }
                }
              },
              "type": [
                "object",
                {
                  "connectivity_subscription_id": "string",
                  "connectivity_tenant_id": "string",
                  "custom_variables": [
                    "object",
                    {}
                  ],
                  "diagnostics": [
                    "object",
                    {
                      "diagnostics_definition": [
                        "object",
                        {}
                      ],
                      "diagnostics_destinations": [
                        "object",
                        {
                          "event_hub_namespaces": [
                            "object",
                            {}
                          ],
                          "log_analytics": [
                            "object",
                            {}
                          ],
                          "storage": [
                            "object",
                            {}
                          ]
                        }
                      ],
                      "event_hub_namespaces": [
                        "object",
                        {}
                      ],
                      "log_analytics": [
                        "object",
                        {}
                      ],
                      "storage_accounts": [
                        "object",
                        {}
                      ]
                    }
                  ],
                  "global_settings": [
                    "object",
                    {
                      "default_region": "string",
                      "environment": "string",
                      "inherit_tags": "bool",
                      "passthrough": "bool",
                      "prefix": "string",
                      "prefix_with_hyphen": "string",
                      "prefixes": [
                        "tuple",
                        [
                          "string"
                        ]
                      ],
                      "random_length": "number",
                      "regions": [
                        "map",
                        "string"
                      ],
                      "tags": [
                        "map",
                        "dynamic"
                      ],
                      "use_slug": "bool"
                    }
                  ],
                  "launchpad_identities": [
                    "map",
                    [
                      "object",
                      {
                        "azuread_groups": [
                          "object",
                          {
                            "alz": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_contributors": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_maintainers": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "connectivity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "identity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "level0": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_landingzones": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_platform": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ]
                          }
                        ],
                        "managed_identities": [
                          "object",
                          {}
                        ]
                      }
                    ]
                  ],
                  "objects": [
                    "map",
                    [
                      "object",
                      {
                        "client_config": [
                          "object",
                          {
                            "landingzone_key": "string",
                            "subscription_id": "string",
                            "tenant_id": "string"
                          }
                        ],
                        "diagnostics": [
                          "object",
                          {
                            "diagnostics_definition": [
                              "object",
                              {}
                            ],
                            "diagnostics_destinations": [
                              "object",
                              {
                                "event_hub_namespaces": [
                                  "object",
                                  {}
                                ],
                                "log_analytics": [
                                  "object",
                                  {}
                                ],
                                "storage": [
                                  "object",
                                  {}
                                ]
                              }
                            ],
                            "event_hub_namespaces": [
                              "object",
                              {}
                            ],
                            "log_analytics": [
                              "object",
                              {}
                            ],
                            "storage_accounts": [
                              "object",
                              {}
                            ]
                          }
                        ],
                        "global_settings": [
                          "object",
                          {
                            "default_region": "string",
                            "environment": "string",
                            "inherit_tags": "bool",
                            "passthrough": "bool",
                            "prefix": "string",
                            "prefix_with_hyphen": "string",
                            "prefixes": [
                              "tuple",
                              [
                                "string"
                              ]
                            ],
                            "random_length": "number",
                            "regions": [
                              "map",
                              "string"
                            ],
                            "tags": [
                              "map",
                              "dynamic"
                            ],
                            "use_slug": "bool"
                          }
                        ],
                        "recovery_vaults": [
                          "object",
                          {
                            "asr": [
                              "object",
                              {
                                "backup_policies": [
                                  "object",
                                  {
                                    "file_shares": [
                                      "object",
                                      {}
                                    ],
                                    "virtual_machines": [
                                      "object",
                                      {
                                        "default": [
                                          "object",
                                          {
                                            "backup": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "frequency": "string",
                                                  "time": "string",
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "id": "string",
                                            "instant_restore_retention_days": "number",
                                            "name": "string",
                                            "recovery_vault_name": "string",
                                            "resource_group_name": "string",
                                            "retention_daily": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number"
                                                }
                                              ]
                                            ],
                                            "retention_monthly": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number",
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ],
                                                  "weeks": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "retention_weekly": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number",
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "retention_yearly": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number",
                                                  "months": [
                                                    "set",
                                                    "string"
                                                  ],
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ],
                                                  "weeks": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "tags": [
                                              "map",
                                              "string"
                                            ],
                                            "timeouts": [
                                              "object",
                                              {
                                                "create": "string",
                                                "delete": "string",
                                                "read": "string",
                                                "update": "string"
                                              }
                                            ],
                                            "timezone": "string"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ],
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "replication_policies": [
                                  "object",
                                  {}
                                ],
                                "resource_group_name": "string",
                                "soft_delete_enabled": "bool"
                              }
                            ]
                          }
                        ],
                        "resource_groups": [
                          "object",
                          {
                            "alerts": [
                              "object",
                              {
                                "id": "string",
                                "location": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tags": [
                                  "map",
                                  "string"
                                ]
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "id": "string",
                                "location": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tags": [
                                  "map",
                                  "string"
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  ],
                  "tfstates": [
                    "map",
                    [
                      "object",
                      {
                        "container_name": "string",
                        "key": "string",
                        "level": "string",
                        "resource_group_name": "string",
                        "storage_account_name": "string",
                        "subscription_id": "string",
                        "tenant_id": "string"
                      }
                    ]
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "launchpad",
          "schema_version": 0,
          "attributes": {
            "backend": "azurerm",
            "config": {
              "value": {
                "container_name": "tfstate",
                "key": "caf_launchpad.tfstate",
                "resource_group_name": "vcf-rg-caf-level0-ytn",
                "storage_account_name": "vcfstl0pag",
                "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
              },
              "type": [
                "object",
                {
                  "container_name": "string",
                  "key": "string",
                  "resource_group_name": "string",
                  "storage_account_name": "string",
                  "subscription_id": "string",
                  "tenant_id": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "diagnostics": {
                  "diagnostics_definition": {},
                  "diagnostics_destinations": {},
                  "event_hub_namespaces": {},
                  "log_analytics": {},
                  "storage_accounts": {}
                },
                "global_settings": {
                  "default_region": "region1",
                  "environment": "vcfobs",
                  "inherit_tags": false,
                  "passthrough": false,
                  "prefix": "vcf",
                  "prefix_with_hyphen": "vcf",
                  "prefixes": [
                    "vcf"
                  ],
                  "random_length": 3,
                  "regions": {
                    "region1": "francecentral",
                    "region2": "francesouth"
                  },
                  "tags": {},
                  "use_slug": true
                },
                "launchpad_identities": {},
                "objects": {
                  "launchpad": {
                    "azuread_applications": {
                      "alz": {
                        "application_id": "9a6290b3-6b33-419f-a634-6a94b7cdbce7",
                        "available_to_other_tenants": false,
                        "display_name": "vcf-sp-caf-alz",
                        "group_membership_claims": "All",
                        "homepage": "",
                        "id": "fb3181f3-bfd0-4b5b-9ce1-8b7ffbf127f7",
                        "identifier_uris": [],
                        "logout_url": "",
                        "oauth2_allow_implicit_flow": false,
                        "object_id": "fb3181f3-bfd0-4b5b-9ce1-8b7ffbf127f7",
                        "owners": [
                          "e54349a4-efbf-45b9-af02-34623f763bc8"
                        ],
                        "prevent_duplicate_names": false,
                        "public_client": false,
                        "reply_urls": [],
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                        "type": "webapp/api"
                      },
                      "connectivity": {
                        "application_id": "a2dcb441-3169-44ba-97df-ba7ee124e3a8",
                        "available_to_other_tenants": false,
                        "display_name": "vcf-sp-caf-connectivity",
                        "group_membership_claims": "All",
                        "homepage": "",
                        "id": "6046ae83-fda4-4c08-aa54-05e3f152c65b",
                        "identifier_uris": [],
                        "logout_url": "",
                        "oauth2_allow_implicit_flow": false,
                        "object_id": "6046ae83-fda4-4c08-aa54-05e3f152c65b",
                        "owners": [
                          "e54349a4-efbf-45b9-af02-34623f763bc8"
                        ],
                        "prevent_duplicate_names": false,
                        "public_client": false,
                        "reply_urls": [],
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                        "type": "webapp/api"
                      },
                      "identity": {
                        "application_id": "25db877e-95eb-4da3-b2e5-0e6335170367",
                        "available_to_other_tenants": false,
                        "display_name": "vcf-sp-caf-identity",
                        "group_membership_claims": "All",
                        "homepage": "",
                        "id": "df1b6536-ed7c-440d-a289-370be21a6344",
                        "identifier_uris": [],
                        "logout_url": "",
                        "oauth2_allow_implicit_flow": false,
                        "object_id": "df1b6536-ed7c-440d-a289-370be21a6344",
                        "owners": [
                          "e54349a4-efbf-45b9-af02-34623f763bc8"
                        ],
                        "prevent_duplicate_names": false,
                        "public_client": false,
                        "reply_urls": [],
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                        "type": "webapp/api"
                      },
                      "level0": {
                        "application_id": "a23729bb-925d-44e2-95ed-754d4d68a0ad",
                        "available_to_other_tenants": false,
                        "display_name": "vcf-sp-caf-level0",
                        "group_membership_claims": "All",
                        "homepage": "",
                        "id": "877be758-71ac-453d-811e-1b6c184ffc05",
                        "identifier_uris": [],
                        "logout_url": "",
                        "oauth2_allow_implicit_flow": false,
                        "object_id": "877be758-71ac-453d-811e-1b6c184ffc05",
                        "owners": [
                          "e54349a4-efbf-45b9-af02-34623f763bc8"
                        ],
                        "prevent_duplicate_names": false,
                        "public_client": false,
                        "reply_urls": [],
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                        "type": "webapp/api"
                      },
                      "management": {
                        "application_id": "c9474d3e-b002-48bd-89d0-45510e68c430",
                        "available_to_other_tenants": false,
                        "display_name": "vcf-sp-caf-management",
                        "group_membership_claims": "All",
                        "homepage": "",
                        "id": "f1b17eb9-eaa1-41f8-a3b3-3d644e7f001d",
                        "identifier_uris": [],
                        "logout_url": "",
                        "oauth2_allow_implicit_flow": false,
                        "object_id": "f1b17eb9-eaa1-41f8-a3b3-3d644e7f001d",
                        "owners": [
                          "e54349a4-efbf-45b9-af02-34623f763bc8"
                        ],
                        "prevent_duplicate_names": false,
                        "public_client": false,
                        "reply_urls": [],
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                        "type": "webapp/api"
                      },
                      "subscription_creation_landingzones": {
                        "application_id": "46ec2bdf-c29b-4442-9228-65e659f6a39a",
                        "available_to_other_tenants": false,
                        "display_name": "vcf-sp-caf-subscription_creation_landingzones",
                        "group_membership_claims": "All",
                        "homepage": "",
                        "id": "2c5c5871-aa0d-424c-88fd-8a31c415462a",
                        "identifier_uris": [],
                        "logout_url": "",
                        "oauth2_allow_implicit_flow": false,
                        "object_id": "2c5c5871-aa0d-424c-88fd-8a31c415462a",
                        "owners": [
                          "e54349a4-efbf-45b9-af02-34623f763bc8"
                        ],
                        "prevent_duplicate_names": false,
                        "public_client": false,
                        "reply_urls": [],
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                        "type": "webapp/api"
                      },
                      "subscription_creation_platform": {
                        "application_id": "e0f2e016-3eec-4800-a603-4a0367202092",
                        "available_to_other_tenants": false,
                        "display_name": "vcf-sp-caf-subscription_creation_platform",
                        "group_membership_claims": "All",
                        "homepage": "",
                        "id": "ca5fdccf-b3b9-4393-a96b-4af8c2bf8888",
                        "identifier_uris": [],
                        "logout_url": "",
                        "oauth2_allow_implicit_flow": false,
                        "object_id": "ca5fdccf-b3b9-4393-a96b-4af8c2bf8888",
                        "owners": [
                          "e54349a4-efbf-45b9-af02-34623f763bc8"
                        ],
                        "prevent_duplicate_names": false,
                        "public_client": false,
                        "reply_urls": [],
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                        "type": "webapp/api"
                      }
                    },
                    "azuread_groups": {
                      "alz": {
                        "id": "276981f5-9284-4ed2-a066-4669ee85bcef",
                        "name": "vcf-caf-alz",
                        "rbac_id": "276981f5-9284-4ed2-a066-4669ee85bcef",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "caf_platform_contributors": {
                        "id": "848e2fc7-90f6-4e02-ae4c-61ef9bae98a2",
                        "name": "vcf-caf-platform-contributors",
                        "rbac_id": "848e2fc7-90f6-4e02-ae4c-61ef9bae98a2",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "caf_platform_maintainers": {
                        "id": "d910cd29-b322-442a-8a06-bd2f2e6e278f",
                        "name": "vcf-caf-platform-maintainers",
                        "rbac_id": "d910cd29-b322-442a-8a06-bd2f2e6e278f",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "connectivity": {
                        "id": "00099ceb-6ea7-4962-85fb-d64038e9641a",
                        "name": "vcf-caf-connectivity",
                        "rbac_id": "00099ceb-6ea7-4962-85fb-d64038e9641a",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "identity": {
                        "id": "c06d0136-beb3-42ca-bd00-9db460eedb2b",
                        "name": "vcf-caf-identity",
                        "rbac_id": "c06d0136-beb3-42ca-bd00-9db460eedb2b",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "level0": {
                        "id": "dedb33cd-29c9-49bf-b90f-94a33277ff00",
                        "name": "vcf-caf-level0",
                        "rbac_id": "dedb33cd-29c9-49bf-b90f-94a33277ff00",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "management": {
                        "id": "299b6f41-6403-40a0-b567-0856fbfb4f65",
                        "name": "vcf-caf-management",
                        "rbac_id": "299b6f41-6403-40a0-b567-0856fbfb4f65",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "subscription_creation_landingzones": {
                        "id": "f63074e1-6d89-4bfd-ae25-141ce5f4727b",
                        "name": "vcf-caf-subscription_creation_landingzones",
                        "rbac_id": "f63074e1-6d89-4bfd-ae25-141ce5f4727b",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "subscription_creation_platform": {
                        "id": "19e5f297-31d9-44d8-bc5a-c82823bf24ea",
                        "name": "vcf-caf-subscription_creation_platform",
                        "rbac_id": "19e5f297-31d9-44d8-bc5a-c82823bf24ea",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      }
                    },
                    "azuread_service_principals": {
                      "alz": {
                        "application_id": "9a6290b3-6b33-419f-a634-6a94b7cdbce7",
                        "display_name": "fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3",
                        "id": "fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3",
                        "oauth2_permissions": [
                          {
                            "admin_consent_description": "Allow the application to access vcf-sp-caf-alz on behalf of the signed-in user.",
                            "admin_consent_display_name": "Access vcf-sp-caf-alz",
                            "id": "09c3d118-6a6e-4bc3-8b63-697967549be2",
                            "is_enabled": true,
                            "type": "User",
                            "user_consent_description": "Allow the application to access vcf-sp-caf-alz on your behalf.",
                            "user_consent_display_name": "Access vcf-sp-caf-alz",
                            "value": "user_impersonation"
                          }
                        ],
                        "object_id": "fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3",
                        "rbac_id": "fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "connectivity": {
                        "application_id": "a2dcb441-3169-44ba-97df-ba7ee124e3a8",
                        "display_name": "18b14e50-51f2-4ed9-91a2-96ffe5755226",
                        "id": "18b14e50-51f2-4ed9-91a2-96ffe5755226",
                        "oauth2_permissions": [
                          {
                            "admin_consent_description": "Allow the application to access vcf-sp-caf-connectivity on behalf of the signed-in user.",
                            "admin_consent_display_name": "Access vcf-sp-caf-connectivity",
                            "id": "c886afa8-1676-495a-914a-769f686ce7ef",
                            "is_enabled": true,
                            "type": "User",
                            "user_consent_description": "Allow the application to access vcf-sp-caf-connectivity on your behalf.",
                            "user_consent_display_name": "Access vcf-sp-caf-connectivity",
                            "value": "user_impersonation"
                          }
                        ],
                        "object_id": "18b14e50-51f2-4ed9-91a2-96ffe5755226",
                        "rbac_id": "18b14e50-51f2-4ed9-91a2-96ffe5755226",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "identity": {
                        "application_id": "25db877e-95eb-4da3-b2e5-0e6335170367",
                        "display_name": "f7750332-7cdd-448b-ba5f-e9ac8da7bffc",
                        "id": "f7750332-7cdd-448b-ba5f-e9ac8da7bffc",
                        "oauth2_permissions": [
                          {
                            "admin_consent_description": "Allow the application to access vcf-sp-caf-identity on behalf of the signed-in user.",
                            "admin_consent_display_name": "Access vcf-sp-caf-identity",
                            "id": "9f135411-6947-4219-b9eb-bfb82d5b3361",
                            "is_enabled": true,
                            "type": "User",
                            "user_consent_description": "Allow the application to access vcf-sp-caf-identity on your behalf.",
                            "user_consent_display_name": "Access vcf-sp-caf-identity",
                            "value": "user_impersonation"
                          }
                        ],
                        "object_id": "f7750332-7cdd-448b-ba5f-e9ac8da7bffc",
                        "rbac_id": "f7750332-7cdd-448b-ba5f-e9ac8da7bffc",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "level0": {
                        "application_id": "a23729bb-925d-44e2-95ed-754d4d68a0ad",
                        "display_name": "91e0b171-12d8-40e4-ad10-598f0cf6f757",
                        "id": "91e0b171-12d8-40e4-ad10-598f0cf6f757",
                        "oauth2_permissions": [
                          {
                            "admin_consent_description": "Allow the application to access vcf-sp-caf-level0 on behalf of the signed-in user.",
                            "admin_consent_display_name": "Access vcf-sp-caf-level0",
                            "id": "f24b9862-c3d4-4d26-a371-f40a3f885606",
                            "is_enabled": true,
                            "type": "User",
                            "user_consent_description": "Allow the application to access vcf-sp-caf-level0 on your behalf.",
                            "user_consent_display_name": "Access vcf-sp-caf-level0",
                            "value": "user_impersonation"
                          }
                        ],
                        "object_id": "91e0b171-12d8-40e4-ad10-598f0cf6f757",
                        "rbac_id": "91e0b171-12d8-40e4-ad10-598f0cf6f757",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "management": {
                        "application_id": "c9474d3e-b002-48bd-89d0-45510e68c430",
                        "display_name": "304ef883-592d-44f1-b040-ef14d8cb32b4",
                        "id": "304ef883-592d-44f1-b040-ef14d8cb32b4",
                        "oauth2_permissions": [
                          {
                            "admin_consent_description": "Allow the application to access vcf-sp-caf-management on behalf of the signed-in user.",
                            "admin_consent_display_name": "Access vcf-sp-caf-management",
                            "id": "7ff0c65b-ab21-4221-bbce-5316ad74f4a8",
                            "is_enabled": true,
                            "type": "User",
                            "user_consent_description": "Allow the application to access vcf-sp-caf-management on your behalf.",
                            "user_consent_display_name": "Access vcf-sp-caf-management",
                            "value": "user_impersonation"
                          }
                        ],
                        "object_id": "304ef883-592d-44f1-b040-ef14d8cb32b4",
                        "rbac_id": "304ef883-592d-44f1-b040-ef14d8cb32b4",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "subscription_creation_landingzones": {
                        "application_id": "46ec2bdf-c29b-4442-9228-65e659f6a39a",
                        "display_name": "78a54238-9d26-4b96-ad38-0683ee8de2fe",
                        "id": "78a54238-9d26-4b96-ad38-0683ee8de2fe",
                        "oauth2_permissions": [
                          {
                            "admin_consent_description": "Allow the application to access vcf-sp-caf-subscription_creation_landingzones on behalf of the signed-in user.",
                            "admin_consent_display_name": "Access vcf-sp-caf-subscription_creation_landingzones",
                            "id": "9d5a30bd-9bb9-4265-8c4a-44fde7036808",
                            "is_enabled": true,
                            "type": "User",
                            "user_consent_description": "Allow the application to access vcf-sp-caf-subscription_creation_landingzones on your behalf.",
                            "user_consent_display_name": "Access vcf-sp-caf-subscription_creation_landingzones",
                            "value": "user_impersonation"
                          }
                        ],
                        "object_id": "78a54238-9d26-4b96-ad38-0683ee8de2fe",
                        "rbac_id": "78a54238-9d26-4b96-ad38-0683ee8de2fe",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "subscription_creation_platform": {
                        "application_id": "e0f2e016-3eec-4800-a603-4a0367202092",
                        "display_name": "3a53ef97-a0ec-4b15-8ec8-b627660c6633",
                        "id": "3a53ef97-a0ec-4b15-8ec8-b627660c6633",
                        "oauth2_permissions": [
                          {
                            "admin_consent_description": "Allow the application to access vcf-sp-caf-subscription_creation_platform on behalf of the signed-in user.",
                            "admin_consent_display_name": "Access vcf-sp-caf-subscription_creation_platform",
                            "id": "7d1c9255-1ad1-4e9c-8d83-1b25eaf271bf",
                            "is_enabled": true,
                            "type": "User",
                            "user_consent_description": "Allow the application to access vcf-sp-caf-subscription_creation_platform on your behalf.",
                            "user_consent_display_name": "Access vcf-sp-caf-subscription_creation_platform",
                            "value": "user_impersonation"
                          }
                        ],
                        "object_id": "3a53ef97-a0ec-4b15-8ec8-b627660c6633",
                        "rbac_id": "3a53ef97-a0ec-4b15-8ec8-b627660c6633",
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      }
                    },
                    "client_config": {
                      "landingzone_key": "launchpad",
                      "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                      "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                    },
                    "diagnostics": {
                      "diagnostics_definition": {},
                      "diagnostics_destinations": {},
                      "event_hub_namespaces": {},
                      "log_analytics": {},
                      "storage_accounts": {}
                    },
                    "global_settings": {
                      "default_region": "region1",
                      "environment": "vcfobs",
                      "inherit_tags": false,
                      "passthrough": false,
                      "prefix": "vcf",
                      "prefix_with_hyphen": "vcf",
                      "prefixes": [
                        "vcf"
                      ],
                      "random_length": 3,
                      "regions": {
                        "region1": "francecentral",
                        "region2": "francesouth"
                      },
                      "tags": {},
                      "use_slug": true
                    },
                    "keyvaults": {
                      "level0": {
                        "base_tags": {},
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level0-ytn/providers/Microsoft.KeyVault/vaults/vcf-kv-l0-xix",
                        "name": "vcf-kv-l0-xix",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level0-ytn/providers/Microsoft.KeyVault/vaults/vcf-kv-l0-xix",
                        "vault_uri": "https://vcf-kv-l0-xix.vault.azure.net/"
                      },
                      "level1": {
                        "base_tags": {},
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level1-giv/providers/Microsoft.KeyVault/vaults/vcf-kv-l1-gbx",
                        "name": "vcf-kv-l1-gbx",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level1-giv/providers/Microsoft.KeyVault/vaults/vcf-kv-l1-gbx",
                        "vault_uri": "https://vcf-kv-l1-gbx.vault.azure.net/"
                      },
                      "level2": {
                        "base_tags": {},
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level2-aqm/providers/Microsoft.KeyVault/vaults/vcf-kv-l2-inr",
                        "name": "vcf-kv-l2-inr",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level2-aqm/providers/Microsoft.KeyVault/vaults/vcf-kv-l2-inr",
                        "vault_uri": "https://vcf-kv-l2-inr.vault.azure.net/"
                      }
                    },
                    "resource_groups": {
                      "level0": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level0-ytn",
                        "location": "francecentral",
                        "name": "vcf-rg-caf-level0-ytn",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level0-ytn",
                        "tags": {
                          "environment": "vcfobs",
                          "landingzone": "launchpad",
                          "level": "level0",
                          "rover_version": "rhadi2005/rover:1.2.5-2209"
                        }
                      },
                      "level1": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level1-giv",
                        "location": "francecentral",
                        "name": "vcf-rg-caf-level1-giv",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level1-giv",
                        "tags": {
                          "environment": "vcfobs",
                          "landingzone": "launchpad",
                          "level": "level0",
                          "rover_version": "rhadi2005/rover:1.2.5-2209"
                        }
                      },
                      "level2": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level2-aqm",
                        "location": "francecentral",
                        "name": "vcf-rg-caf-level2-aqm",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level2-aqm",
                        "tags": {
                          "environment": "vcfobs",
                          "landingzone": "launchpad",
                          "level": "level0",
                          "rover_version": "rhadi2005/rover:1.2.5-2209"
                        }
                      }
                    },
                    "storage_accounts": {
                      "level0": {
                        "backup_container_id": null,
                        "containers": {
                          "tfstate": {
                            "blobs": {},
                            "has_immutability_policy": false,
                            "has_legal_hold": false,
                            "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level0-ytn/providers/Microsoft.Storage/storageAccounts/vcfstl0pag/blobServices/default/containers/tfstate",
                            "name": "tfstate",
                            "resource_manager_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level0-ytn/providers/Microsoft.Storage/storageAccounts/vcfstl0pag/blobServices/default/containers/tfstate",
                            "url": "https://vcfstl0pag.blob.core.windows.net/tfstate"
                          }
                        },
                        "data_lake_filesystems": {},
                        "file_share": {},
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level0-ytn/providers/Microsoft.Storage/storageAccounts/vcfstl0pag",
                        "identity": [],
                        "location": "francecentral",
                        "name": "vcfstl0pag",
                        "primary_access_key": "VZFUzycnQp60KiTYV8hvoDwQ/ylVE3EvWaYryG5qM7Bzjb+jb+SQEmzMkFsErRZjfciAXbQx+VmD+AStYCrCVw==",
                        "primary_blob_connection_string": "DefaultEndpointsProtocol=https;BlobEndpoint=https://vcfstl0pag.blob.core.windows.net/;AccountName=vcfstl0pag;AccountKey=VZFUzycnQp60KiTYV8hvoDwQ/ylVE3EvWaYryG5qM7Bzjb+jb+SQEmzMkFsErRZjfciAXbQx+VmD+AStYCrCVw==",
                        "primary_blob_endpoint": "https://vcfstl0pag.blob.core.windows.net/",
                        "primary_connection_string": "DefaultEndpointsProtocol=https;AccountName=vcfstl0pag;AccountKey=VZFUzycnQp60KiTYV8hvoDwQ/ylVE3EvWaYryG5qM7Bzjb+jb+SQEmzMkFsErRZjfciAXbQx+VmD+AStYCrCVw==;EndpointSuffix=core.windows.net",
                        "primary_web_host": "",
                        "queues": {},
                        "rbac_id": null,
                        "resource_group_name": "vcf-rg-caf-level0-ytn"
                      },
                      "level1": {
                        "backup_container_id": null,
                        "containers": {
                          "tfstate": {
                            "blobs": {},
                            "has_immutability_policy": false,
                            "has_legal_hold": false,
                            "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level1-giv/providers/Microsoft.Storage/storageAccounts/vcfstl1rsy/blobServices/default/containers/tfstate",
                            "name": "tfstate",
                            "resource_manager_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level1-giv/providers/Microsoft.Storage/storageAccounts/vcfstl1rsy/blobServices/default/containers/tfstate",
                            "url": "https://vcfstl1rsy.blob.core.windows.net/tfstate"
                          }
                        },
                        "data_lake_filesystems": {},
                        "file_share": {},
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level1-giv/providers/Microsoft.Storage/storageAccounts/vcfstl1rsy",
                        "identity": [],
                        "location": "francecentral",
                        "name": "vcfstl1rsy",
                        "primary_access_key": "O0s6koGXYAbeQa6uyry/1yIjHtz18DwlfMNkySrk6j/0ijcHANQBCHV2ntQfCUcEyJesedv3wl/R+AStP6EI5g==",
                        "primary_blob_connection_string": "DefaultEndpointsProtocol=https;BlobEndpoint=https://vcfstl1rsy.blob.core.windows.net/;AccountName=vcfstl1rsy;AccountKey=O0s6koGXYAbeQa6uyry/1yIjHtz18DwlfMNkySrk6j/0ijcHANQBCHV2ntQfCUcEyJesedv3wl/R+AStP6EI5g==",
                        "primary_blob_endpoint": "https://vcfstl1rsy.blob.core.windows.net/",
                        "primary_connection_string": "DefaultEndpointsProtocol=https;AccountName=vcfstl1rsy;AccountKey=O0s6koGXYAbeQa6uyry/1yIjHtz18DwlfMNkySrk6j/0ijcHANQBCHV2ntQfCUcEyJesedv3wl/R+AStP6EI5g==;EndpointSuffix=core.windows.net",
                        "primary_web_host": "",
                        "queues": {},
                        "rbac_id": null,
                        "resource_group_name": "vcf-rg-caf-level1-giv"
                      },
                      "level2": {
                        "backup_container_id": null,
                        "containers": {
                          "tfstate": {
                            "blobs": {},
                            "has_immutability_policy": false,
                            "has_legal_hold": false,
                            "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level2-aqm/providers/Microsoft.Storage/storageAccounts/vcfstl2vhg/blobServices/default/containers/tfstate",
                            "name": "tfstate",
                            "resource_manager_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level2-aqm/providers/Microsoft.Storage/storageAccounts/vcfstl2vhg/blobServices/default/containers/tfstate",
                            "url": "https://vcfstl2vhg.blob.core.windows.net/tfstate"
                          }
                        },
                        "data_lake_filesystems": {},
                        "file_share": {},
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-caf-level2-aqm/providers/Microsoft.Storage/storageAccounts/vcfstl2vhg",
                        "identity": [],
                        "location": "francecentral",
                        "name": "vcfstl2vhg",
                        "primary_access_key": "CrHpXl8/qzYttweYSwEnytnDGv1DJ6lqagMmKdXEeY6VhE8LNIpX6uzPdadqYQDYlTZtzZAujsE++AStt2e0QA==",
                        "primary_blob_connection_string": "DefaultEndpointsProtocol=https;BlobEndpoint=https://vcfstl2vhg.blob.core.windows.net/;AccountName=vcfstl2vhg;AccountKey=CrHpXl8/qzYttweYSwEnytnDGv1DJ6lqagMmKdXEeY6VhE8LNIpX6uzPdadqYQDYlTZtzZAujsE++AStt2e0QA==",
                        "primary_blob_endpoint": "https://vcfstl2vhg.blob.core.windows.net/",
                        "primary_connection_string": "DefaultEndpointsProtocol=https;AccountName=vcfstl2vhg;AccountKey=CrHpXl8/qzYttweYSwEnytnDGv1DJ6lqagMmKdXEeY6VhE8LNIpX6uzPdadqYQDYlTZtzZAujsE++AStt2e0QA==;EndpointSuffix=core.windows.net",
                        "primary_web_host": "",
                        "queues": {},
                        "rbac_id": null,
                        "resource_group_name": "vcf-rg-caf-level2-aqm"
                      }
                    }
                  }
                },
                "tfstates": {
                  "launchpad": {
                    "container_name": "tfstate",
                    "key": "caf_launchpad.tfstate",
                    "level": "level0",
                    "resource_group_name": "vcf-rg-caf-level0-ytn",
                    "storage_account_name": "vcfstl0pag",
                    "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                    "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                  }
                }
              },
              "type": [
                "object",
                {
                  "diagnostics": [
                    "object",
                    {
                      "diagnostics_definition": [
                        "object",
                        {}
                      ],
                      "diagnostics_destinations": [
                        "object",
                        {}
                      ],
                      "event_hub_namespaces": [
                        "object",
                        {}
                      ],
                      "log_analytics": [
                        "object",
                        {}
                      ],
                      "storage_accounts": [
                        "object",
                        {}
                      ]
                    }
                  ],
                  "global_settings": [
                    "object",
                    {
                      "default_region": "string",
                      "environment": "string",
                      "inherit_tags": "bool",
                      "passthrough": "bool",
                      "prefix": "string",
                      "prefix_with_hyphen": "string",
                      "prefixes": [
                        "tuple",
                        [
                          "string"
                        ]
                      ],
                      "random_length": "number",
                      "regions": [
                        "map",
                        "string"
                      ],
                      "tags": [
                        "map",
                        "dynamic"
                      ],
                      "use_slug": "bool"
                    }
                  ],
                  "launchpad_identities": [
                    "map",
                    [
                      "object",
                      {
                        "azuread_groups": [
                          "object",
                          {
                            "alz": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_contributors": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_maintainers": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "connectivity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "identity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "level0": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_landingzones": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_platform": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ]
                          }
                        ],
                        "managed_identities": [
                          "object",
                          {}
                        ]
                      }
                    ]
                  ],
                  "objects": [
                    "map",
                    [
                      "object",
                      {
                        "azuread_applications": [
                          "object",
                          {
                            "alz": [
                              "object",
                              {
                                "application_id": "string",
                                "available_to_other_tenants": "bool",
                                "display_name": "string",
                                "group_membership_claims": "string",
                                "homepage": "string",
                                "id": "string",
                                "identifier_uris": [
                                  "list",
                                  "string"
                                ],
                                "logout_url": "string",
                                "oauth2_allow_implicit_flow": "bool",
                                "object_id": "string",
                                "owners": [
                                  "set",
                                  "string"
                                ],
                                "prevent_duplicate_names": "bool",
                                "public_client": "bool",
                                "reply_urls": [
                                  "set",
                                  "string"
                                ],
                                "tenant_id": "string",
                                "type": "string"
                              }
                            ],
                            "connectivity": [
                              "object",
                              {
                                "application_id": "string",
                                "available_to_other_tenants": "bool",
                                "display_name": "string",
                                "group_membership_claims": "string",
                                "homepage": "string",
                                "id": "string",
                                "identifier_uris": [
                                  "list",
                                  "string"
                                ],
                                "logout_url": "string",
                                "oauth2_allow_implicit_flow": "bool",
                                "object_id": "string",
                                "owners": [
                                  "set",
                                  "string"
                                ],
                                "prevent_duplicate_names": "bool",
                                "public_client": "bool",
                                "reply_urls": [
                                  "set",
                                  "string"
                                ],
                                "tenant_id": "string",
                                "type": "string"
                              }
                            ],
                            "identity": [
                              "object",
                              {
                                "application_id": "string",
                                "available_to_other_tenants": "bool",
                                "display_name": "string",
                                "group_membership_claims": "string",
                                "homepage": "string",
                                "id": "string",
                                "identifier_uris": [
                                  "list",
                                  "string"
                                ],
                                "logout_url": "string",
                                "oauth2_allow_implicit_flow": "bool",
                                "object_id": "string",
                                "owners": [
                                  "set",
                                  "string"
                                ],
                                "prevent_duplicate_names": "bool",
                                "public_client": "bool",
                                "reply_urls": [
                                  "set",
                                  "string"
                                ],
                                "tenant_id": "string",
                                "type": "string"
                              }
                            ],
                            "level0": [
                              "object",
                              {
                                "application_id": "string",
                                "available_to_other_tenants": "bool",
                                "display_name": "string",
                                "group_membership_claims": "string",
                                "homepage": "string",
                                "id": "string",
                                "identifier_uris": [
                                  "list",
                                  "string"
                                ],
                                "logout_url": "string",
                                "oauth2_allow_implicit_flow": "bool",
                                "object_id": "string",
                                "owners": [
                                  "set",
                                  "string"
                                ],
                                "prevent_duplicate_names": "bool",
                                "public_client": "bool",
                                "reply_urls": [
                                  "set",
                                  "string"
                                ],
                                "tenant_id": "string",
                                "type": "string"
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "application_id": "string",
                                "available_to_other_tenants": "bool",
                                "display_name": "string",
                                "group_membership_claims": "string",
                                "homepage": "string",
                                "id": "string",
                                "identifier_uris": [
                                  "list",
                                  "string"
                                ],
                                "logout_url": "string",
                                "oauth2_allow_implicit_flow": "bool",
                                "object_id": "string",
                                "owners": [
                                  "set",
                                  "string"
                                ],
                                "prevent_duplicate_names": "bool",
                                "public_client": "bool",
                                "reply_urls": [
                                  "set",
                                  "string"
                                ],
                                "tenant_id": "string",
                                "type": "string"
                              }
                            ],
                            "subscription_creation_landingzones": [
                              "object",
                              {
                                "application_id": "string",
                                "available_to_other_tenants": "bool",
                                "display_name": "string",
                                "group_membership_claims": "string",
                                "homepage": "string",
                                "id": "string",
                                "identifier_uris": [
                                  "list",
                                  "string"
                                ],
                                "logout_url": "string",
                                "oauth2_allow_implicit_flow": "bool",
                                "object_id": "string",
                                "owners": [
                                  "set",
                                  "string"
                                ],
                                "prevent_duplicate_names": "bool",
                                "public_client": "bool",
                                "reply_urls": [
                                  "set",
                                  "string"
                                ],
                                "tenant_id": "string",
                                "type": "string"
                              }
                            ],
                            "subscription_creation_platform": [
                              "object",
                              {
                                "application_id": "string",
                                "available_to_other_tenants": "bool",
                                "display_name": "string",
                                "group_membership_claims": "string",
                                "homepage": "string",
                                "id": "string",
                                "identifier_uris": [
                                  "list",
                                  "string"
                                ],
                                "logout_url": "string",
                                "oauth2_allow_implicit_flow": "bool",
                                "object_id": "string",
                                "owners": [
                                  "set",
                                  "string"
                                ],
                                "prevent_duplicate_names": "bool",
                                "public_client": "bool",
                                "reply_urls": [
                                  "set",
                                  "string"
                                ],
                                "tenant_id": "string",
                                "type": "string"
                              }
                            ]
                          }
                        ],
                        "azuread_groups": [
                          "object",
                          {
                            "alz": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_contributors": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_maintainers": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "connectivity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "identity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "level0": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_landingzones": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_platform": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ]
                          }
                        ],
                        "azuread_service_principals": [
                          "object",
                          {
                            "alz": [
                              "object",
                              {
                                "application_id": "string",
                                "display_name": "string",
                                "id": "string",
                                "oauth2_permissions": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "admin_consent_description": "string",
                                      "admin_consent_display_name": "string",
                                      "id": "string",
                                      "is_enabled": "bool",
                                      "type": "string",
                                      "user_consent_description": "string",
                                      "user_consent_display_name": "string",
                                      "value": "string"
                                    }
                                  ]
                                ],
                                "object_id": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "connectivity": [
                              "object",
                              {
                                "application_id": "string",
                                "display_name": "string",
                                "id": "string",
                                "oauth2_permissions": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "admin_consent_description": "string",
                                      "admin_consent_display_name": "string",
                                      "id": "string",
                                      "is_enabled": "bool",
                                      "type": "string",
                                      "user_consent_description": "string",
                                      "user_consent_display_name": "string",
                                      "value": "string"
                                    }
                                  ]
                                ],
                                "object_id": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "identity": [
                              "object",
                              {
                                "application_id": "string",
                                "display_name": "string",
                                "id": "string",
                                "oauth2_permissions": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "admin_consent_description": "string",
                                      "admin_consent_display_name": "string",
                                      "id": "string",
                                      "is_enabled": "bool",
                                      "type": "string",
                                      "user_consent_description": "string",
                                      "user_consent_display_name": "string",
                                      "value": "string"
                                    }
                                  ]
                                ],
                                "object_id": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "level0": [
                              "object",
                              {
                                "application_id": "string",
                                "display_name": "string",
                                "id": "string",
                                "oauth2_permissions": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "admin_consent_description": "string",
                                      "admin_consent_display_name": "string",
                                      "id": "string",
                                      "is_enabled": "bool",
                                      "type": "string",
                                      "user_consent_description": "string",
                                      "user_consent_display_name": "string",
                                      "value": "string"
                                    }
                                  ]
                                ],
                                "object_id": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "application_id": "string",
                                "display_name": "string",
                                "id": "string",
                                "oauth2_permissions": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "admin_consent_description": "string",
                                      "admin_consent_display_name": "string",
                                      "id": "string",
                                      "is_enabled": "bool",
                                      "type": "string",
                                      "user_consent_description": "string",
                                      "user_consent_display_name": "string",
                                      "value": "string"
                                    }
                                  ]
                                ],
                                "object_id": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_landingzones": [
                              "object",
                              {
                                "application_id": "string",
                                "display_name": "string",
                                "id": "string",
                                "oauth2_permissions": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "admin_consent_description": "string",
                                      "admin_consent_display_name": "string",
                                      "id": "string",
                                      "is_enabled": "bool",
                                      "type": "string",
                                      "user_consent_description": "string",
                                      "user_consent_display_name": "string",
                                      "value": "string"
                                    }
                                  ]
                                ],
                                "object_id": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_platform": [
                              "object",
                              {
                                "application_id": "string",
                                "display_name": "string",
                                "id": "string",
                                "oauth2_permissions": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "admin_consent_description": "string",
                                      "admin_consent_display_name": "string",
                                      "id": "string",
                                      "is_enabled": "bool",
                                      "type": "string",
                                      "user_consent_description": "string",
                                      "user_consent_display_name": "string",
                                      "value": "string"
                                    }
                                  ]
                                ],
                                "object_id": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ]
                          }
                        ],
                        "client_config": [
                          "object",
                          {
                            "landingzone_key": "string",
                            "subscription_id": "string",
                            "tenant_id": "string"
                          }
                        ],
                        "diagnostics": [
                          "object",
                          {
                            "diagnostics_definition": [
                              "object",
                              {}
                            ],
                            "diagnostics_destinations": [
                              "object",
                              {}
                            ],
                            "event_hub_namespaces": [
                              "object",
                              {}
                            ],
                            "log_analytics": [
                              "object",
                              {}
                            ],
                            "storage_accounts": [
                              "object",
                              {}
                            ]
                          }
                        ],
                        "global_settings": [
                          "object",
                          {
                            "default_region": "string",
                            "environment": "string",
                            "inherit_tags": "bool",
                            "passthrough": "bool",
                            "prefix": "string",
                            "prefix_with_hyphen": "string",
                            "prefixes": [
                              "tuple",
                              [
                                "string"
                              ]
                            ],
                            "random_length": "number",
                            "regions": [
                              "map",
                              "string"
                            ],
                            "tags": [
                              "map",
                              "dynamic"
                            ],
                            "use_slug": "bool"
                          }
                        ],
                        "keyvaults": [
                          "object",
                          {
                            "level0": [
                              "object",
                              {
                                "base_tags": [
                                  "map",
                                  "string"
                                ],
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "vault_uri": "string"
                              }
                            ],
                            "level1": [
                              "object",
                              {
                                "base_tags": [
                                  "map",
                                  "string"
                                ],
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "vault_uri": "string"
                              }
                            ],
                            "level2": [
                              "object",
                              {
                                "base_tags": [
                                  "map",
                                  "string"
                                ],
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "vault_uri": "string"
                              }
                            ]
                          }
                        ],
                        "resource_groups": [
                          "object",
                          {
                            "level0": [
                              "object",
                              {
                                "id": "string",
                                "location": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tags": [
                                  "map",
                                  "string"
                                ]
                              }
                            ],
                            "level1": [
                              "object",
                              {
                                "id": "string",
                                "location": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tags": [
                                  "map",
                                  "string"
                                ]
                              }
                            ],
                            "level2": [
                              "object",
                              {
                                "id": "string",
                                "location": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tags": [
                                  "map",
                                  "string"
                                ]
                              }
                            ]
                          }
                        ],
                        "storage_accounts": [
                          "object",
                          {
                            "level0": [
                              "object",
                              {
                                "backup_container_id": "dynamic",
                                "containers": [
                                  "object",
                                  {
                                    "tfstate": [
                                      "object",
                                      {
                                        "blobs": [
                                          "object",
                                          {}
                                        ],
                                        "has_immutability_policy": "bool",
                                        "has_legal_hold": "bool",
                                        "id": "string",
                                        "name": "string",
                                        "resource_manager_id": "string",
                                        "url": "string"
                                      }
                                    ]
                                  }
                                ],
                                "data_lake_filesystems": [
                                  "object",
                                  {}
                                ],
                                "file_share": [
                                  "object",
                                  {}
                                ],
                                "id": "string",
                                "identity": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "identity_ids": [
                                        "set",
                                        "string"
                                      ],
                                      "principal_id": "string",
                                      "tenant_id": "string",
                                      "type": "string"
                                    }
                                  ]
                                ],
                                "location": "string",
                                "name": "string",
                                "primary_access_key": "string",
                                "primary_blob_connection_string": "string",
                                "primary_blob_endpoint": "string",
                                "primary_connection_string": "string",
                                "primary_web_host": "string",
                                "queues": [
                                  "object",
                                  {}
                                ],
                                "rbac_id": "dynamic",
                                "resource_group_name": "string"
                              }
                            ],
                            "level1": [
                              "object",
                              {
                                "backup_container_id": "dynamic",
                                "containers": [
                                  "object",
                                  {
                                    "tfstate": [
                                      "object",
                                      {
                                        "blobs": [
                                          "object",
                                          {}
                                        ],
                                        "has_immutability_policy": "bool",
                                        "has_legal_hold": "bool",
                                        "id": "string",
                                        "name": "string",
                                        "resource_manager_id": "string",
                                        "url": "string"
                                      }
                                    ]
                                  }
                                ],
                                "data_lake_filesystems": [
                                  "object",
                                  {}
                                ],
                                "file_share": [
                                  "object",
                                  {}
                                ],
                                "id": "string",
                                "identity": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "identity_ids": [
                                        "set",
                                        "string"
                                      ],
                                      "principal_id": "string",
                                      "tenant_id": "string",
                                      "type": "string"
                                    }
                                  ]
                                ],
                                "location": "string",
                                "name": "string",
                                "primary_access_key": "string",
                                "primary_blob_connection_string": "string",
                                "primary_blob_endpoint": "string",
                                "primary_connection_string": "string",
                                "primary_web_host": "string",
                                "queues": [
                                  "object",
                                  {}
                                ],
                                "rbac_id": "dynamic",
                                "resource_group_name": "string"
                              }
                            ],
                            "level2": [
                              "object",
                              {
                                "backup_container_id": "dynamic",
                                "containers": [
                                  "object",
                                  {
                                    "tfstate": [
                                      "object",
                                      {
                                        "blobs": [
                                          "object",
                                          {}
                                        ],
                                        "has_immutability_policy": "bool",
                                        "has_legal_hold": "bool",
                                        "id": "string",
                                        "name": "string",
                                        "resource_manager_id": "string",
                                        "url": "string"
                                      }
                                    ]
                                  }
                                ],
                                "data_lake_filesystems": [
                                  "object",
                                  {}
                                ],
                                "file_share": [
                                  "object",
                                  {}
                                ],
                                "id": "string",
                                "identity": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "identity_ids": [
                                        "set",
                                        "string"
                                      ],
                                      "principal_id": "string",
                                      "tenant_id": "string",
                                      "type": "string"
                                    }
                                  ]
                                ],
                                "location": "string",
                                "name": "string",
                                "primary_access_key": "string",
                                "primary_blob_connection_string": "string",
                                "primary_blob_endpoint": "string",
                                "primary_connection_string": "string",
                                "primary_web_host": "string",
                                "queues": [
                                  "object",
                                  {}
                                ],
                                "rbac_id": "dynamic",
                                "resource_group_name": "string"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  ],
                  "tfstates": [
                    "map",
                    [
                      "object",
                      {
                        "container_name": "string",
                        "key": "string",
                        "level": "string",
                        "resource_group_name": "string",
                        "storage_account_name": "string",
                        "subscription_id": "string",
                        "tenant_id": "string"
                      }
                    ]
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "management",
          "schema_version": 0,
          "attributes": {
            "backend": "azurerm",
            "config": {
              "value": {
                "container_name": "tfstate",
                "key": "management.tfstate",
                "resource_group_name": "vcf-rg-caf-level1-giv",
                "storage_account_name": "vcfstl1rsy",
                "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
              },
              "type": [
                "object",
                {
                  "container_name": "string",
                  "key": "string",
                  "resource_group_name": "string",
                  "storage_account_name": "string",
                  "subscription_id": "string",
                  "tenant_id": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "connectivity_subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                "connectivity_tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "custom_variables": {},
                "diagnostics": {
                  "diagnostics_definition": {},
                  "diagnostics_destinations": {
                    "event_hub_namespaces": {},
                    "log_analytics": {},
                    "storage": {}
                  },
                  "event_hub_namespaces": {},
                  "log_analytics": {
                    "region1": {
                      "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx/providers/Microsoft.OperationalInsights/workspaces/vcf-log-logre1-dgb",
                      "location": "francecentral",
                      "name": "vcf-log-logre1-dgb",
                      "resource_group_name": "vcf-rg-management-inx",
                      "workspace_id": "cd32a042-40d8-4533-bc49-22761e3321cc"
                    }
                  },
                  "storage_accounts": {}
                },
                "global_settings": {
                  "default_region": "region1",
                  "environment": "vcfobs",
                  "inherit_tags": false,
                  "passthrough": false,
                  "prefix": "vcf",
                  "prefix_with_hyphen": "vcf",
                  "prefixes": [
                    "vcf"
                  ],
                  "random_length": 3,
                  "regions": {
                    "region1": "francecentral",
                    "region2": "francesouth"
                  },
                  "tags": {},
                  "use_slug": true
                },
                "launchpad_identities": {},
                "objects": {
                  "management": {
                    "automations": {
                      "account1": {
                        "dsc_server_endpoint": "https://4516e0fe-c388-45dd-9faa-fcf8dca70bae.agentsvc.fc.azure-automation.net/accounts/4516e0fe-c388-45dd-9faa-fcf8dca70bae",
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx/providers/Microsoft.Automation/automationAccounts/vcf-aa-automationAccount1-dyx",
                        "name": "vcf-aa-automationAccount1-dyx"
                      }
                    },
                    "client_config": {
                      "landingzone_key": "management",
                      "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                      "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                    },
                    "diagnostics": {
                      "diagnostics_definition": {},
                      "diagnostics_destinations": {
                        "event_hub_namespaces": {},
                        "log_analytics": {},
                        "storage": {}
                      },
                      "event_hub_namespaces": {},
                      "log_analytics": {
                        "region1": {
                          "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx/providers/Microsoft.OperationalInsights/workspaces/vcf-log-logre1-dgb",
                          "location": "francecentral",
                          "name": "vcf-log-logre1-dgb",
                          "resource_group_name": "vcf-rg-management-inx",
                          "workspace_id": "cd32a042-40d8-4533-bc49-22761e3321cc"
                        }
                      },
                      "storage_accounts": {}
                    },
                    "global_settings": {
                      "default_region": "region1",
                      "environment": "vcfobs",
                      "inherit_tags": false,
                      "passthrough": false,
                      "prefix": "vcf",
                      "prefix_with_hyphen": "vcf",
                      "prefixes": [
                        "vcf"
                      ],
                      "random_length": 3,
                      "regions": {
                        "region1": "francecentral",
                        "region2": "francesouth"
                      },
                      "tags": {},
                      "use_slug": true
                    },
                    "monitor_action_groups": {
                      "networking_operations": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-alerts-dib/providers/Microsoft.Insights/actionGroups/vcf-amag-Networking Operations-uen"
                      }
                    },
                    "recovery_vaults": {
                      "asr": {
                        "backup_policies": {
                          "file_shares": {},
                          "virtual_machines": {
                            "default": {
                              "backup": [
                                {
                                  "frequency": "Daily",
                                  "time": "23:00",
                                  "weekdays": null
                                }
                              ],
                              "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx/providers/Microsoft.RecoveryServices/vaults/vcf-rsv-asr-yew/backupPolicies/vm-default-policy",
                              "instant_restore_retention_days": 2,
                              "name": "vm-default-policy",
                              "recovery_vault_name": "vcf-rsv-asr-yew",
                              "resource_group_name": "vcf-rg-management-inx",
                              "retention_daily": [
                                {
                                  "count": 7
                                }
                              ],
                              "retention_monthly": [
                                {
                                  "count": 2,
                                  "weekdays": [
                                    "Sunday"
                                  ],
                                  "weeks": [
                                    "First"
                                  ]
                                }
                              ],
                              "retention_weekly": [
                                {
                                  "count": 2,
                                  "weekdays": [
                                    "Sunday"
                                  ]
                                }
                              ],
                              "retention_yearly": [
                                {
                                  "count": 1,
                                  "months": [
                                    "January"
                                  ],
                                  "weekdays": [
                                    "Sunday"
                                  ],
                                  "weeks": [
                                    "First"
                                  ]
                                }
                              ],
                              "tags": null,
                              "timeouts": null,
                              "timezone": "SE Asia Standard Time"
                            }
                          }
                        },
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx/providers/Microsoft.RecoveryServices/vaults/vcf-rsv-asr-yew",
                        "name": "vcf-rsv-asr-yew",
                        "rbac_id": "0ba44276-970c-4f74-91ae-82b62a525455",
                        "replication_policies": {},
                        "resource_group_name": "vcf-rg-management-inx",
                        "soft_delete_enabled": true
                      }
                    },
                    "resource_groups": {
                      "alerts": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-alerts-dib",
                        "location": "francecentral",
                        "name": "vcf-rg-alerts-dib",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-alerts-dib",
                        "tags": {
                          "environment": "vcfobs",
                          "level": "level1",
                          "rover_version": "rhadi2005/rover:1.2.5-2209"
                        }
                      },
                      "management": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx",
                        "location": "francecentral",
                        "name": "vcf-rg-management-inx",
                        "rbac_id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx",
                        "tags": {
                          "environment": "vcfobs",
                          "level": "level1",
                          "rover_version": "rhadi2005/rover:1.2.5-2209"
                        }
                      }
                    },
                    "storage_accounts": {
                      "nsgflogs": {
                        "backup_container_id": null,
                        "containers": {},
                        "data_lake_filesystems": {},
                        "file_share": {},
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/resourceGroups/vcf-rg-management-inx/providers/Microsoft.Storage/storageAccounts/vcfstnsglogsgla",
                        "identity": [],
                        "location": "francecentral",
                        "name": "vcfstnsglogsgla",
                        "primary_access_key": "gzwfGPf8rtA5M9uL6DIDhUNheYSRiaJGVXVCBV4PlDDgOnkKaBMHhGP5Tx1p4bLMv1dRJR7zdax9+ASt3fmLHw==",
                        "primary_blob_connection_string": "DefaultEndpointsProtocol=https;BlobEndpoint=https://vcfstnsglogsgla.blob.core.windows.net/;AccountName=vcfstnsglogsgla;AccountKey=gzwfGPf8rtA5M9uL6DIDhUNheYSRiaJGVXVCBV4PlDDgOnkKaBMHhGP5Tx1p4bLMv1dRJR7zdax9+ASt3fmLHw==",
                        "primary_blob_endpoint": "https://vcfstnsglogsgla.blob.core.windows.net/",
                        "primary_connection_string": "DefaultEndpointsProtocol=https;AccountName=vcfstnsglogsgla;AccountKey=gzwfGPf8rtA5M9uL6DIDhUNheYSRiaJGVXVCBV4PlDDgOnkKaBMHhGP5Tx1p4bLMv1dRJR7zdax9+ASt3fmLHw==;EndpointSuffix=core.windows.net",
                        "primary_web_host": "",
                        "queues": {},
                        "rbac_id": null,
                        "resource_group_name": "vcf-rg-management-inx"
                      }
                    }
                  }
                },
                "tfstates": {
                  "launchpad": {
                    "container_name": "tfstate",
                    "key": "caf_launchpad.tfstate",
                    "level": "level0",
                    "resource_group_name": "vcf-rg-caf-level0-ytn",
                    "storage_account_name": "vcfstl0pag",
                    "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                    "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                  },
                  "management": {
                    "container_name": "tfstate",
                    "key": "management.tfstate",
                    "level": "level1",
                    "resource_group_name": "vcf-rg-caf-level1-giv",
                    "storage_account_name": "vcfstl1rsy",
                    "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                    "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                  }
                }
              },
              "type": [
                "object",
                {
                  "connectivity_subscription_id": "string",
                  "connectivity_tenant_id": "string",
                  "custom_variables": [
                    "object",
                    {}
                  ],
                  "diagnostics": [
                    "object",
                    {
                      "diagnostics_definition": [
                        "object",
                        {}
                      ],
                      "diagnostics_destinations": [
                        "object",
                        {
                          "event_hub_namespaces": [
                            "object",
                            {}
                          ],
                          "log_analytics": [
                            "object",
                            {}
                          ],
                          "storage": [
                            "object",
                            {}
                          ]
                        }
                      ],
                      "event_hub_namespaces": [
                        "object",
                        {}
                      ],
                      "log_analytics": [
                        "object",
                        {
                          "region1": [
                            "object",
                            {
                              "id": "string",
                              "location": "string",
                              "name": "string",
                              "resource_group_name": "string",
                              "workspace_id": "string"
                            }
                          ]
                        }
                      ],
                      "storage_accounts": [
                        "object",
                        {}
                      ]
                    }
                  ],
                  "global_settings": [
                    "object",
                    {
                      "default_region": "string",
                      "environment": "string",
                      "inherit_tags": "bool",
                      "passthrough": "bool",
                      "prefix": "string",
                      "prefix_with_hyphen": "string",
                      "prefixes": [
                        "tuple",
                        [
                          "string"
                        ]
                      ],
                      "random_length": "number",
                      "regions": [
                        "map",
                        "string"
                      ],
                      "tags": [
                        "map",
                        "dynamic"
                      ],
                      "use_slug": "bool"
                    }
                  ],
                  "launchpad_identities": [
                    "map",
                    [
                      "object",
                      {
                        "azuread_groups": [
                          "object",
                          {
                            "alz": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_contributors": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "caf_platform_maintainers": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "connectivity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "identity": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "level0": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_landingzones": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ],
                            "subscription_creation_platform": [
                              "object",
                              {
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tenant_id": "string"
                              }
                            ]
                          }
                        ],
                        "managed_identities": [
                          "object",
                          {}
                        ]
                      }
                    ]
                  ],
                  "objects": [
                    "map",
                    [
                      "object",
                      {
                        "automations": [
                          "object",
                          {
                            "account1": [
                              "object",
                              {
                                "dsc_server_endpoint": "string",
                                "id": "string",
                                "name": "string"
                              }
                            ]
                          }
                        ],
                        "client_config": [
                          "object",
                          {
                            "landingzone_key": "string",
                            "subscription_id": "string",
                            "tenant_id": "string"
                          }
                        ],
                        "diagnostics": [
                          "object",
                          {
                            "diagnostics_definition": [
                              "object",
                              {}
                            ],
                            "diagnostics_destinations": [
                              "object",
                              {
                                "event_hub_namespaces": [
                                  "object",
                                  {}
                                ],
                                "log_analytics": [
                                  "object",
                                  {}
                                ],
                                "storage": [
                                  "object",
                                  {}
                                ]
                              }
                            ],
                            "event_hub_namespaces": [
                              "object",
                              {}
                            ],
                            "log_analytics": [
                              "object",
                              {
                                "region1": [
                                  "object",
                                  {
                                    "id": "string",
                                    "location": "string",
                                    "name": "string",
                                    "resource_group_name": "string",
                                    "workspace_id": "string"
                                  }
                                ]
                              }
                            ],
                            "storage_accounts": [
                              "object",
                              {}
                            ]
                          }
                        ],
                        "global_settings": [
                          "object",
                          {
                            "default_region": "string",
                            "environment": "string",
                            "inherit_tags": "bool",
                            "passthrough": "bool",
                            "prefix": "string",
                            "prefix_with_hyphen": "string",
                            "prefixes": [
                              "tuple",
                              [
                                "string"
                              ]
                            ],
                            "random_length": "number",
                            "regions": [
                              "map",
                              "string"
                            ],
                            "tags": [
                              "map",
                              "dynamic"
                            ],
                            "use_slug": "bool"
                          }
                        ],
                        "monitor_action_groups": [
                          "object",
                          {
                            "networking_operations": [
                              "object",
                              {
                                "id": "string"
                              }
                            ]
                          }
                        ],
                        "recovery_vaults": [
                          "object",
                          {
                            "asr": [
                              "object",
                              {
                                "backup_policies": [
                                  "object",
                                  {
                                    "file_shares": [
                                      "object",
                                      {}
                                    ],
                                    "virtual_machines": [
                                      "object",
                                      {
                                        "default": [
                                          "object",
                                          {
                                            "backup": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "frequency": "string",
                                                  "time": "string",
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "id": "string",
                                            "instant_restore_retention_days": "number",
                                            "name": "string",
                                            "recovery_vault_name": "string",
                                            "resource_group_name": "string",
                                            "retention_daily": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number"
                                                }
                                              ]
                                            ],
                                            "retention_monthly": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number",
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ],
                                                  "weeks": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "retention_weekly": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number",
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "retention_yearly": [
                                              "list",
                                              [
                                                "object",
                                                {
                                                  "count": "number",
                                                  "months": [
                                                    "set",
                                                    "string"
                                                  ],
                                                  "weekdays": [
                                                    "set",
                                                    "string"
                                                  ],
                                                  "weeks": [
                                                    "set",
                                                    "string"
                                                  ]
                                                }
                                              ]
                                            ],
                                            "tags": [
                                              "map",
                                              "string"
                                            ],
                                            "timeouts": [
                                              "object",
                                              {
                                                "create": "string",
                                                "delete": "string",
                                                "read": "string",
                                                "update": "string"
                                              }
                                            ],
                                            "timezone": "string"
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ],
                                "id": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "replication_policies": [
                                  "object",
                                  {}
                                ],
                                "resource_group_name": "string",
                                "soft_delete_enabled": "bool"
                              }
                            ]
                          }
                        ],
                        "resource_groups": [
                          "object",
                          {
                            "alerts": [
                              "object",
                              {
                                "id": "string",
                                "location": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tags": [
                                  "map",
                                  "string"
                                ]
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "id": "string",
                                "location": "string",
                                "name": "string",
                                "rbac_id": "string",
                                "tags": [
                                  "map",
                                  "string"
                                ]
                              }
                            ]
                          }
                        ],
                        "storage_accounts": [
                          "object",
                          {
                            "nsgflogs": [
                              "object",
                              {
                                "backup_container_id": "dynamic",
                                "containers": [
                                  "object",
                                  {}
                                ],
                                "data_lake_filesystems": [
                                  "object",
                                  {}
                                ],
                                "file_share": [
                                  "object",
                                  {}
                                ],
                                "id": "string",
                                "identity": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "identity_ids": [
                                        "set",
                                        "string"
                                      ],
                                      "principal_id": "string",
                                      "tenant_id": "string",
                                      "type": "string"
                                    }
                                  ]
                                ],
                                "location": "string",
                                "name": "string",
                                "primary_access_key": "string",
                                "primary_blob_connection_string": "string",
                                "primary_blob_endpoint": "string",
                                "primary_connection_string": "string",
                                "primary_web_host": "string",
                                "queues": [
                                  "object",
                                  {}
                                ],
                                "rbac_id": "dynamic",
                                "resource_group_name": "string"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  ],
                  "tfstates": [
                    "map",
                    [
                      "object",
                      {
                        "container_name": "string",
                        "key": "string",
                        "level": "string",
                        "resource_group_name": "string",
                        "storage_account_name": "string",
                        "subscription_id": "string",
                        "tenant_id": "string"
                      }
                    ]
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "subscriptions",
          "schema_version": 0,
          "attributes": {
            "backend": "azurerm",
            "config": {
              "value": {
                "container_name": "tfstate",
                "key": "platform_subscriptions.tfstate",
                "resource_group_name": "vcf-rg-caf-level1-giv",
                "storage_account_name": "vcfstl1rsy",
                "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
              },
              "type": [
                "object",
                {
                  "container_name": "string",
                  "key": "string",
                  "resource_group_name": "string",
                  "storage_account_name": "string",
                  "subscription_id": "string",
                  "tenant_id": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "connectivity_subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                "connectivity_tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "custom_variables": {},
                "diagnostics": {
                  "diagnostics_definition": {},
                  "diagnostics_destinations": {
                    "event_hub_namespaces": {},
                    "log_analytics": {},
                    "storage": {}
                  },
                  "event_hub_namespaces": {},
                  "log_analytics": {},
                  "storage_accounts": {}
                },
                "global_settings": {},
                "launchpad_identities": {},
                "objects": {
                  "subscriptions": {
                    "client_config": {
                      "landingzone_key": "subscriptions",
                      "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                      "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                    },
                    "diagnostics": {
                      "diagnostics_definition": {},
                      "diagnostics_destinations": {
                        "event_hub_namespaces": {},
                        "log_analytics": {},
                        "storage": {}
                      },
                      "event_hub_namespaces": {},
                      "log_analytics": {},
                      "storage_accounts": {}
                    },
                    "global_settings": {
                      "default_region": "region1",
                      "environment": "sandpit",
                      "inherit_tags": false,
                      "passthrough": false,
                      "prefix": null,
                      "prefix_with_hyphen": "vjkh-",
                      "prefixes": [
                        "vjkh"
                      ],
                      "random_length": 0,
                      "regions": null,
                      "tags": null,
                      "use_slug": true
                    },
                    "subscriptions": {
                      "connectivity": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "tags": null,
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "identity": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "tags": null,
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "launchpad": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "tags": null,
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      },
                      "management": {
                        "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                        "tags": null,
                        "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                      }
                    }
                  }
                },
                "tfstates": {
                  "subscriptions": {
                    "container_name": "tfstate",
                    "key": "platform_subscriptions.tfstate",
                    "level": "level1",
                    "resource_group_name": "vcf-rg-caf-level1-giv",
                    "storage_account_name": "vcfstl1rsy",
                    "subscription_id": "a9c7991e-521c-4532-93a9-5a37f82ccaed",
                    "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003"
                  }
                }
              },
              "type": [
                "object",
                {
                  "connectivity_subscription_id": "string",
                  "connectivity_tenant_id": "string",
                  "custom_variables": [
                    "object",
                    {}
                  ],
                  "diagnostics": [
                    "object",
                    {
                      "diagnostics_definition": [
                        "object",
                        {}
                      ],
                      "diagnostics_destinations": [
                        "object",
                        {
                          "event_hub_namespaces": [
                            "object",
                            {}
                          ],
                          "log_analytics": [
                            "object",
                            {}
                          ],
                          "storage": [
                            "object",
                            {}
                          ]
                        }
                      ],
                      "event_hub_namespaces": [
                        "object",
                        {}
                      ],
                      "log_analytics": [
                        "object",
                        {}
                      ],
                      "storage_accounts": [
                        "object",
                        {}
                      ]
                    }
                  ],
                  "global_settings": [
                    "object",
                    {}
                  ],
                  "launchpad_identities": [
                    "object",
                    {}
                  ],
                  "objects": [
                    "map",
                    [
                      "object",
                      {
                        "client_config": [
                          "object",
                          {
                            "landingzone_key": "string",
                            "subscription_id": "string",
                            "tenant_id": "string"
                          }
                        ],
                        "diagnostics": [
                          "object",
                          {
                            "diagnostics_definition": [
                              "object",
                              {}
                            ],
                            "diagnostics_destinations": [
                              "object",
                              {
                                "event_hub_namespaces": [
                                  "object",
                                  {}
                                ],
                                "log_analytics": [
                                  "object",
                                  {}
                                ],
                                "storage": [
                                  "object",
                                  {}
                                ]
                              }
                            ],
                            "event_hub_namespaces": [
                              "object",
                              {}
                            ],
                            "log_analytics": [
                              "object",
                              {}
                            ],
                            "storage_accounts": [
                              "object",
                              {}
                            ]
                          }
                        ],
                        "global_settings": [
                          "object",
                          {
                            "default_region": "string",
                            "environment": "string",
                            "inherit_tags": "bool",
                            "passthrough": "bool",
                            "prefix": "dynamic",
                            "prefix_with_hyphen": "string",
                            "prefixes": [
                              "tuple",
                              [
                                "string"
                              ]
                            ],
                            "random_length": "number",
                            "regions": "dynamic",
                            "tags": "dynamic",
                            "use_slug": "bool"
                          }
                        ],
                        "subscriptions": [
                          "object",
                          {
                            "connectivity": [
                              "object",
                              {
                                "id": "string",
                                "subscription_id": "string",
                                "tags": "dynamic",
                                "tenant_id": "string"
                              }
                            ],
                            "identity": [
                              "object",
                              {
                                "id": "string",
                                "subscription_id": "string",
                                "tags": "dynamic",
                                "tenant_id": "string"
                              }
                            ],
                            "launchpad": [
                              "object",
                              {
                                "id": "string",
                                "subscription_id": "string",
                                "tags": "dynamic",
                                "tenant_id": "string"
                              }
                            ],
                            "management": [
                              "object",
                              {
                                "id": "string",
                                "subscription_id": "string",
                                "tags": "dynamic",
                                "tenant_id": "string"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  ],
                  "tfstates": [
                    "object",
                    {
                      "subscriptions": [
                        "object",
                        {
                          "container_name": "string",
                          "key": "string",
                          "level": "string",
                          "resource_group_name": "string",
                          "storage_account_name": "string",
                          "subscription_id": "string",
                          "tenant_id": "string"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_definition",
      "name": "external_lookup",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the private cluster feature for your Azure Kubernetes Service cluster to ensure network traffic between your API server and your node pools remains on the private network only. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Azure Kubernetes Service Private Clusters should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.0\"}",
            "name": "040732e8-d947-40b8-95d6-854c95024bf8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Service Bus to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "04d53d87-841c-4f23-8a5b-21564380b55e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ServiceBus/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"VNetAndIPFilteringLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.",
            "display_name": "Azure API for FHIR should use a customer-managed key to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
            "management_group_name": null,
            "metadata": "{\"category\":\"API for FHIR\",\"version\":\"1.1.0\"}",
            "name": "051cba44-2429-45b9-9649-46cec11c7119",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.HealthcareApis/services/cosmosDbConfiguration.keyVaultKeyUri\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux VMs if the VM Image (OS) is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux VMs. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "053d3325-282c-4e5c-b944-24faffd30d77",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
          "schema_version": 0,
          "attributes": {
            "description": "To access the private endpoint(s) for Storage Sync Service resource interfaces from a registered server, you need to configure your DNS to resolve the correct names to your private endpoint's private IP addresses. This policy creates the requisite Azure Private DNS Zone and A records for the interfaces of your Storage Sync Service private endpoint(s).",
            "display_name": "Configure Azure File Sync to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.0\"}",
            "name": "06695360-db88-47f6-b976-7500d4297475",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"privateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"afs\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-afs\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f\",\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f",
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machines if the virtual machine image is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.1\"}",
            "name": "0868462e-646c-4fe3-9ced-a733534b6a2c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example values: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Search Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "08ba64b8-738f-4918-9686-730d2ed79c7d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Search/searchServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"OperationLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Search/searchServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
          "schema_version": 0,
          "attributes": {
            "description": "By default, a virtual machine's OS and data disks are encrypted-at-rest using platform-managed keys. Temp disks, data caches and data flowing between compute and storage aren't encrypted. Disregard this recommendation if: 1. using encryption-at-host, or 2. server-side encryption on Managed Disks meets your security requirements. Learn more in: Server-side encryption of Azure Disk Storage: https://aka.ms/disksse, Different disk encryption offerings: https://aka.ms/diskencryptioncomparison",
            "display_name": "Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"2.0.3\"}",
            "name": "0961003e-5a0a-4549-abde-af6a37f2724d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"Microsoft.ClassicCompute/virtualMachines\",\"Microsoft.Compute/virtualMachines\"]},\"then\":{\"details\":{\"existenceCondition\":{\"field\":\"Microsoft.Security/assessments/status.code\",\"in\":[\"NotApplicable\",\"Healthy\"]},\"name\":\"d57a4221-a804-52ca-3dea-768284f06bb7\",\"type\":\"Microsoft.Security/assessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Web PubSub service. Learn more at: https://aka.ms/awps/privatelink.",
            "display_name": "Configure Azure Web PubSub Service to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Web PubSub\",\"version\":\"1.0.0\"}",
            "name": "0b026355-49cb-467b-8ac4-f777874e175a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"webpubsub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-webpubsub-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
          "schema_version": 0,
          "attributes": {
            "description": "This policy is deprecated. Please use /providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8 instead.",
            "display_name": "[Deprecated]: SQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"deprecated\":true,\"version\":\"2.0.1-deprecated\"}",
            "name": "0d134df8-db83-46fb-ad72-fe0c9428c8dd",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.Sql/servers/encryptionProtector/serverKeyType\"},{\"field\":\"Microsoft.Sql/servers/encryptionProtector/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.Sql/servers/encryptionProtector/uri\"}]},\"name\":\"current\",\"type\":\"Microsoft.Sql/servers/encryptionProtector\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that container registries are not exposed on the public internet. Creating private endpoints can limit exposure of container registry resources. Learn more at: https://aka.ms/acr/portal/public-network and https://aka.ms/acr/private-link.",
            "display_name": "Public network access should be disabled for Container registries",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.0\"}",
            "name": "0fdf0491-d080-4575-b627-ad0e843cba0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "11ac78e3-31bc-4f0c-8434-37ab963cea07",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "PostgreSQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "name": "18adea5e-f416-4d0f-8aa8-d24321e3e274",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforPostgreSQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforPostgreSQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
            "display_name": "Kubernetes clusters should be accessible only over HTTPS",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"7.0.0\"}",
            "name": "1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created, but flags it as non-compliant. 'Deny' blocks the resource creation. 'Disable' turns off the policy.\",\"displayName\":\"Effect\"}},\"excludedNamespaces\":{\"type\":\"Array\",\"defaultValue\":[\"kube-system\",\"gatekeeper-system\",\"azure-arc\"],\"metadata\":{\"description\":\"List of Kubernetes namespaces to exclude from policy evaluation. System namespaces \\\"kube-system\\\", \\\"gatekeeper-system\\\" and \\\"azure-arc\\\" are always excluded by design.\",\"displayName\":\"Namespace exclusions\"}},\"labelSelector\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Label query to select Kubernetes resources for policy evaluation. An empty label selector matches all Kubernetes resources.\",\"displayName\":\"Kubernetes label selector\"}},\"namespaces\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"List of Kubernetes namespaces to only include in policy evaluation. An empty list means the policy is applied to all resources in all namespaces.\",\"displayName\":\"Namespace inclusions\"}}}",
            "policy_rule": "{\"if\":{\"field\":\"type\",\"in\":[\"AKS Engine\",\"Microsoft.Kubernetes/connectedClusters\",\"Microsoft.ContainerService/managedClusters\"]},\"then\":{\"details\":{\"apiGroups\":[\"extensions\",\"networking.k8s.io\"],\"excludedNamespaces\":\"[parameters('excludedNamespaces')]\",\"kinds\":[\"Ingress\"],\"labelSelector\":\"[parameters('labelSelector')]\",\"namespaces\":\"[parameters('namespaces')]\",\"templateInfo\":{\"sourceType\":\"PublicURL\",\"url\":\"https://store.policy.core.windows.net/kubernetes/ingress-https-only/v1/template.yaml\"}},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.",
            "display_name": "Public network access on Azure SQL Database should be disabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.1.0\"}",
            "name": "1b8ca024-1d5c-4dec-8995-b1a932b41780",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machines if the virtual machine image is in the list defined and the agent is not installed.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "name": "1c210e94-a481-4beb-95fa-1571b434fb04",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Event Hub to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.1.0\"}",
            "name": "1f6e93e8-6b31-41b1-83f6-36e449a42579",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventHub/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ArchiveLogs\",\"enabled\":true,\"retentionPolicy\":{\"days\":0,\"enabled\":false}},{\"category\":\"OperationalLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AutoScaleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaCoordinatorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"KafkaUserErrorLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EventHubVNetConnectionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CustomerManagedKeyUserLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventHub/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit key vault accounts.",
            "display_name": "Configure Azure Defender for Key Vaults to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "1f725891-01c0-420a-9059-4fa46cb770b7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"KeyVaults\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"KeyVaults\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/cosmosdb-cmk.",
            "display_name": "Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.1.0\"}",
            "name": "1f905d99-2ab7-462c-a6b0-f709acca6c8f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"exists\":false,\"field\":\"Microsoft.DocumentDB/databaseAccounts/keyVaultKeyUri\"},{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public endpoint allows you to restrict access to your Storage Sync Service resource to requests destined to approved private endpoints on your organization's network. There is nothing inherently insecure about allowing requests to the public endpoint, however, you may wish to disable it to meet regulatory, legal, or organizational policy requirements. You can disable the public endpoint for a Storage Sync Service by setting the incomingTrafficPolicy of the resource to AllowVirtualNetworksOnly.",
            "display_name": "Public network access should be disabled for Azure File Sync",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.0\"}",
            "name": "21a8cd35-125e-4d13-b82d-2e19b7208bb7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.StorageSync/storageSyncServices\",\"field\":\"type\"},{\"field\":\"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\"notEquals\":\"AllowVirtualNetworksOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for DNS provides an additional layer of protection for your cloud resources by continuously monitoring all DNS queries from your Azure resources. Azure Defender alerts you about suspicious activity at the DNS layer. Learn more about the capabilities of Azure Defender for DNS at https://aka.ms/defender-for-dns . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .",
            "display_name": "Configure Azure Defender for DNS to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"Dns\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Dns\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.StreamAnalytics/streamingjobs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Execution\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Authoring\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events",
            "display_name": "Configure Azure Activity logs to stream to specified Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"location\":\"Global\",\"name\":\"subscriptionToLa\",\"properties\":{\"logs\":[{\"category\":\"Administrative\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Security\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ServiceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Alert\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Recommendation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Policy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ResourceHealth\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Insights/diagnosticSettings\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"existenceScope\":\"Subscription\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "[Preview]: Log Analytics Extension should be enabled for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"preview\":true,\"version\":\"2.0.1-preview\"}",
            "name": "32133ab0-ee4b-4b44-98d6-042180979d50",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
          "schema_version": 0,
          "attributes": {
            "description": "Network access to storage accounts should be restricted. Configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges",
            "display_name": "Storage accounts should restrict network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.1.1\"}",
            "name": "34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\"notEquals\":\"Deny\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Defender on your Azure SQL Servers to detect anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases.",
            "display_name": "Configure Azure Defender to be enabled on SQL servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.1.0\"}",
            "name": "36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"serverName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"serverName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-11-01-preview\",\"name\":\"[concat(parameters('serverName'), '/Default')]\",\"properties\":{\"state\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/securityAlertPolicies.state\"},\"name\":\"Default\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/securityAlertPolicies\"},\"effect\":\"DeployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Windows virtual machine scale sets if the virtual machine image is in the list defined and the agent is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machines in the set by updating them.",
            "display_name": "Deploy - Configure Dependency agent to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.1.0\"}",
            "name": "3be22e3b-d919-47aa-805e-8985dbeb0ad9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentWindows\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentWindows\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Windows virtual machine scale sets if the virtual machine image is in the list defined and the extension is not installed. If your scale set upgradePolicy is set to Manual, you need to apply the extension to all the virtual machine in the set by updating them. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Deploy - Configure Log Analytics extension to be enabled on Windows virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.1\"}",
            "name": "3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2016-datacenter-gensecond\",\"2019-Datacenter\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\",\"vmExtensionTypeHandlerVersion\":\"1.0\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for open-source relational databases detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. Learn more about the capabilities of Azure Defender for open-source relational databases at https://aka.ms/AzDforOpenSourceDBsDocu. Important: Enabling this plan will result in charges for protecting your open-source relational databases. Learn about the pricing on Security Center's pricing page: https://aka.ms/pricing-security-center",
            "display_name": "Configure Azure Defender for open-source relational databases to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "44433aa3-7ec2-4002-93ea-65c65ff0310a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"OpenSourceRelationalDatabases\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"OpenSourceRelationalDatabases\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machines if the VM Image (OS) is in the list defined and the agent is not installed.",
            "display_name": "Deploy Dependency agent for Linux virtual machines",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"4.0.0\"}",
            "name": "4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
          "schema_version": 0,
          "attributes": {
            "description": "Private DNS records allow private connections to private endpoints. Private endpoint connections allow secure communication by enabling private connectivity to Batch accounts without a need for public IP addresses at the source or destination. For more information on private endpoints and DNS zones in Batch, see https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints that connect to Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "name": "4ec38ebc-381f-45ee-81a4-acbc4be878f8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private DNS Zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"batchAccount\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"batchAccount-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Configure Azure Defender for SQL servers on machines to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "50ea7265-7d8c-429e-9a7d-ca1f410191c3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"SqlServerVirtualMachines\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServerVirtualMachines\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
          "schema_version": 0,
          "attributes": {
            "description": "Enable the key vault firewall so that the key vault is not accessible by default to any public IPs. You can then configure specific IP ranges to limit access to those networks. Learn more at: https://docs.microsoft.com/azure/key-vault/general/network-security",
            "display_name": "Azure Key Vault should have firewall enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"version\":\"3.0.0\"}",
            "name": "55615ac9-af46-4a59-874e-391cc3dfb490",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/createMode\",\"notEquals\":\"recover\"},{\"field\":\"Microsoft.KeyVault/vaults/networkAcls.defaultAction\",\"notEquals\":\"Deny\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/acr/CMK.",
            "display_name": "Container registries should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.1.2\"}",
            "name": "5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},{\"field\":\"Microsoft.ContainerRegistry/registries/encryption.status\",\"notEquals\":\"enabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the extension is not installed.",
            "display_name": "Log Analytics extension should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "name": "5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for PostgreSQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for PostgreSQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"3.0.0\"}",
            "name": "5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/flexibleServers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/createMode\",\"notEquals\":\"Update\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/flexibleServers/network.privateDnsZoneArmResourceId\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Log Analytics extension for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the extension is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances. Deprecation notice: The Log Analytics agent will not be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Deploy Log Analytics extension for Linux virtual machine scale sets. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"15*\"}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"UbuntuServer\",\"0001-com-ubuntu-server-focal\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18_04*lts-gen2\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04*lts-gen2\"}]}]},{\"allOf\":[{\"equals\":\"credativ\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Debian\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"9*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\",\"vmExtensionTypeHandlerVersion\":\"1.13\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
          "schema_version": 0,
          "attributes": {
            "description": "Customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about customer-managed keys at https://go.microsoft.com/fwlink/?linkid=2121321.",
            "display_name": "Cognitive Services accounts should enable data encryption with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"2.0.0\"}",
            "name": "67121cc7-ff39-4ab8-b7e3-95b84dab487d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},{\"field\":\"Microsoft.CognitiveServices/accounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"},{\"count\":{\"field\":\"Microsoft.CognitiveServices/accounts/capabilities[*]\",\"where\":{\"equals\":\"CustomerManagedKey\",\"field\":\"Microsoft.CognitiveServices/accounts/capabilities[*].name\"}},\"greater\":0}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "name": "69af7d4a-7b18-4044-93a9-2651498ef203",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"MicrosoftMonitoringAgent\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"MicrosoftMonitoringAgent\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"MicrosoftMonitoringAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Kubernetes Service to stream resource logs to a Log Analytics workspace.",
            "display_name": "Deploy - Configure diagnostic settings for Azure Kubernetes Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"3.0.0\"}",
            "name": "6c66c325-74c8-42fd-a286-a74b0e2939d8",
            "parameters": "{\"AllMetrics\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AllMetrics logs to the Log Analytics workspace - True or False\",\"displayName\":\"AllMetrics - Enabled\"}},\"cloud-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cloud-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"cloud-controller-manager - Enabled\"}},\"cluster-autoscaler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream cluster-autoscaler logs to the Log Analytics workspace - True or False\",\"displayName\":\"cluster-autoscaler - Enabled\"}},\"csi-azuredisk-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azuredisk-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azuredisk-controller - Enabled\"}},\"csi-azurefile-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-azurefile-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-azurefile-controller - Enabled\"}},\"csi-snapshot-controller\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream csi-snapshot-controller logs to the Log Analytics workspace - True or False\",\"displayName\":\"csi-snapshot-controller - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"AzureKubernetesDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"guard\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream guard logs to the Log Analytics workspace - True or False\",\"displayName\":\"guard - Enabled\"}},\"kube-apiserver\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-apiserver logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-apiserver - Enabled\"}},\"kube-audit\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit - Enabled\"}},\"kube-audit-admin\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-audit-admin logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-audit-admin - Enabled\"}},\"kube-controller-manager\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-controller-manager logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-controller-manager - Enabled\"}},\"kube-scheduler\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream kube-scheduler logs to the Log Analytics workspace - True or False\",\"displayName\":\"kube-scheduler - Enabled\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the Azure Kubernetes Service should be connected to\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AllMetrics\":{\"value\":\"[parameters('AllMetrics')]\"},\"cloud-controller-manager\":{\"value\":\"[parameters('cloud-controller-manager')]\"},\"cluster-autoscaler\":{\"value\":\"[parameters('cluster-autoscaler')]\"},\"csi-azuredisk-controller\":{\"value\":\"[parameters('csi-azuredisk-controller')]\"},\"csi-azurefile-controller\":{\"value\":\"[parameters('csi-azurefile-controller')]\"},\"csi-snapshot-controller\":{\"value\":\"[parameters('csi-snapshot-controller')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"guard\":{\"value\":\"[parameters('guard')]\"},\"kube-apiserver\":{\"value\":\"[parameters('kube-apiserver')]\"},\"kube-audit\":{\"value\":\"[parameters('kube-audit')]\"},\"kube-audit-admin\":{\"value\":\"[parameters('kube-audit-admin')]\"},\"kube-controller-manager\":{\"value\":\"[parameters('kube-controller-manager')]\"},\"kube-scheduler\":{\"value\":\"[parameters('kube-scheduler')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AllMetrics\":{\"type\":\"string\"},\"cloud-controller-manager\":{\"type\":\"string\"},\"cluster-autoscaler\":{\"type\":\"string\"},\"csi-azuredisk-controller\":{\"type\":\"string\"},\"csi-azurefile-controller\":{\"type\":\"string\"},\"csi-snapshot-controller\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"guard\":{\"type\":\"string\"},\"kube-apiserver\":{\"type\":\"string\"},\"kube-audit\":{\"type\":\"string\"},\"kube-audit-admin\":{\"type\":\"string\"},\"kube-controller-manager\":{\"type\":\"string\"},\"kube-scheduler\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('AllMetrics')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerService/managedClusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"count\":{\"name\":\"logCategoriesParameter\",\"value\":[{\"category\":\"kube-apiserver\",\"enabled\":\"[parameters('kube-apiserver')]\"},{\"category\":\"kube-audit\",\"enabled\":\"[parameters('kube-audit')]\"},{\"category\":\"kube-controller-manager\",\"enabled\":\"[parameters('kube-controller-manager')]\"},{\"category\":\"kube-scheduler\",\"enabled\":\"[parameters('kube-scheduler')]\"},{\"category\":\"cluster-autoscaler\",\"enabled\":\"[parameters('cluster-autoscaler')]\"},{\"category\":\"kube-audit-admin\",\"enabled\":\"[parameters('kube-audit-admin')]\"},{\"category\":\"guard\",\"enabled\":\"[parameters('guard')]\"},{\"category\":\"cloud-controller-manager\",\"enabled\":\"[parameters('cloud-controller-manager')]\"},{\"category\":\"csi-azuredisk-controller\",\"enabled\":\"[parameters('csi-azuredisk-controller')]\"},{\"category\":\"csi-azurefile-controller\",\"enabled\":\"[parameters('csi-azurefile-controller')]\"},{\"category\":\"csi-snapshot-controller\",\"enabled\":\"[parameters('csi-snapshot-controller')]\"}],\"where\":{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[current('logCategoriesParameter').enabled]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"[current('logCategoriesParameter').category]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greater\":0}},\"equals\":11},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"allOf\":[{\"equals\":\"AllMetrics\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('AllMetrics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}},\"greater\":0},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6f8f98a4-f108-47cb-8e98-91a0d85cd474",
          "schema_version": 0,
          "attributes": {
            "description": "Deprecated: This policy did not evaluate correctly and has been separated into policies for each of the nested resources. Please see new policies for storage accounts (id: /providers/Microsoft.Authorization/policyDefinitions/59759c62-9a22-4cdf-ae64-074495983fef), blob services (b4fe1a3b-0715-4c6c-a5ea-ffc33cf823cb), file (25a70cc8-2bd4-47f1-90b6-1478e4662c96), queue (7bd000e3-37c7-4928-9f31-86c4b77c5c45), and table (2fb86bf3-d221-43d1-96d1-2434af34eaa0).",
            "display_name": "[Deprecated]: Configure diagnostic settings for storage accounts to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6f8f98a4-f108-47cb-8e98-91a0d85cd474",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"deprecated\":true,\"version\":\"1.3.0-deprecated\"}",
            "name": "6f8f98a4-f108-47cb-8e98-91a0d85cd474",
            "parameters": "{\"StorageDelete\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream StorageDelete logs to the Log Analytics workspace - True or False\",\"displayName\":\"StorageDelete - Enabled\"}},\"StorageRead\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream StorageRead logs to the Log Analytics workspace - True or False\",\"displayName\":\"StorageRead - Enabled\"}},\"StorageWrite\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream StorageWrite logs to the Log Analytics workspace - True or False\",\"displayName\":\"StorageWrite - Enabled\"}},\"Transaction\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Transaction logs to the Log Analytics workspace - True or False\",\"displayName\":\"Transaction - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"storageAccountsDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the storage account should be connected to.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"servicesToDeploy\":{\"type\":\"Array\",\"allowedValues\":[\"storageAccounts\",\"blobServices\",\"fileServices\",\"tableServices\",\"queueServices\"],\"defaultValue\":[\"storageAccounts\",\"blobServices\",\"fileServices\",\"tableServices\",\"queueServices\"],\"metadata\":{\"description\":\"List of Storage services to deploy\",\"displayName\":\"Storage services to deploy\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"StorageDelete\":{\"value\":\"[parameters('StorageDelete')]\"},\"StorageRead\":{\"value\":\"[parameters('StorageRead')]\"},\"StorageWrite\":{\"value\":\"[parameters('StorageWrite')]\"},\"Transaction\":{\"value\":\"[parameters('Transaction')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('name')]\"},\"servicesToDeploy\":{\"value\":\"[parameters('servicesToDeploy')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"StorageDelete\":{\"type\":\"string\"},\"StorageRead\":{\"type\":\"string\"},\"StorageWrite\":{\"type\":\"string\"},\"Transaction\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"},\"servicesToDeploy\":{\"type\":\"array\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'blobServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/blobServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'fileServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/fileServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'tableServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/tableServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'queueServices')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/default/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"StorageRead\",\"enabled\":\"[parameters('StorageRead')]\"},{\"category\":\"StorageWrite\",\"enabled\":\"[parameters('StorageWrite')]\"},{\"category\":\"StorageDelete\",\"enabled\":\"[parameters('StorageDelete')]\"}],\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/queueServices/providers/diagnosticSettings\"},{\"apiVersion\":\"2017-05-01-preview\",\"condition\":\"[contains(parameters('servicesToDeploy'), 'storageAccounts')]\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"metrics\":[{\"category\":\"Transaction\",\"enabled\":\"[parameters('Transaction')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Storage/storageAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"anyof\":[{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"}]},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
          "schema_version": 0,
          "attributes": {
            "description": "Secure your blob and file storage account with greater flexibility using customer-managed keys. When you specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. Using customer-managed keys provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.",
            "display_name": "Storage accounts should use customer-managed key for encryption",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
            "management_group_name": null,
            "metadata": "{\"category\":\"Storage\",\"version\":\"1.0.3\"}",
            "name": "6fac406b-40ca-413b-bf8e-0bf964659c25",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"not\":{\"equals\":\"Microsoft.Keyvault\",\"field\":\"Microsoft.Storage/storageAccounts/encryption.keySource\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Storage provides detections of unusual and potentially harmful attempts to access or exploit storage accounts.",
            "display_name": "Configure Azure Defender for Storage to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "74c30959-af11-47b3-9ed2-a26e03f427a3",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"StorageAccounts\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"StorageAccounts\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access on a Batch account improves security by ensuring your Batch account can only be accessed from a private endpoint. Learn more about disabling public network access at https://docs.microsoft.com/azure/batch/private-connectivity.",
            "display_name": "Public network access should be disabled for Batch accounts",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.0\"}",
            "name": "74c5a0ae-5e48-4738-b093-65e23a060488",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
          "schema_version": 0,
          "attributes": {
            "description": "Enable resource logs for public IP addressess in diagnostic settings to stream to a Log Analytics workspace. Get detailed visibility into attack traffic and actions taken to mitigate DDoS attacks via notifications, reports and flow logs.",
            "display_name": "Public IP addresses should have resource logs enabled for Azure DDoS Protection Standard",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "752154a7-1e0f-45c6-a880-ac75a7e4f648",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The target Log Analytics workspace for the diagnostic settings\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Enable Logs - True or False\",\"displayName\":\"Enable Logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Enable Metrics - True or False\",\"displayName\":\"Enable Metrics\"}},\"profileName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Profile name for the Azure diagnostic settings resource\",\"displayName\":\"Diagnostic setting name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"name\":{\"value\":\"[field('name')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('name'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"name\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DDoSProtectionNotifications\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationFlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DDoSMitigationReports\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/publicIPAddresses/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('LogsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('MetricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Dependency agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all virtual machines in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Deploy Dependency agent for Linux virtual machine scale sets",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"4.0.0\"}",
            "name": "765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
            "parameters": "{\"listOfImageIdToInclude\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude')]\"},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"0001-com-ubuntu-server-focal\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"20_04-lts\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\",\"12-SP5\",\"15\",\"15-SP1\"]}]}]},{\"allOf\":[{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-12-sp5*\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-15-sp1*\"}]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"gen1\",\"gen2\"]}]},{\"allOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"sles-sap-15-sp1*\"},{\"equals\":\"gen1\",\"field\":\"Microsoft.Compute/imageSKU\"}]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for: ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"[variables('vmExtensionPublisher')]\",\"type\":\"[variables('vmExtensionType')]\",\"typeHandlerVersion\":\"[variables('vmExtensionTypeHandlerVersion')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\",\"vmExtensionTypeHandlerVersion\":\"9.10\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling public network access improves security by ensuring that your CosmosDB account isn't exposed on the public internet. Creating private endpoints can limit exposure of your CosmosDB account. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation.",
            "display_name": "Azure Cosmos DB should disable public network access",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cosmos DB\",\"version\":\"1.0.0\"}",
            "name": "797b37f7-06b8-444c-b1ad-fc62867f335a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.DocumentDB/databaseAccounts/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve app configuration instances. Learn more at: https://aka.ms/appconfig/private-endpoint.",
            "display_name": "Configure private DNS zones for private endpoints connected to App Configuration",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Configuration\",\"version\":\"1.0.0\"}",
            "name": "7a860e27-9ca2-4fc6-822d-c2d248c300df",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"configurationStores\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-azconfig-io\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
          "schema_version": 0,
          "attributes": {
            "description": "Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.",
            "display_name": "Both operating systems and data disks in Azure Kubernetes Service clusters should be encrypted by customer-managed keys",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"1.0.0\"}",
            "name": "7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"'Audit' allows a non-compliant resource to be created or updated, but flags it as non-compliant. 'Deny' blocks the non-compliant resource creation or update. 'Disabled' turns off the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"False\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"},{\"equals\":\"\",\"field\":\"Microsoft.ContainerService/managedClusters/diskEncryptionSetID\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.",
            "display_name": "MySQL servers should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"1.0.4\"}",
            "name": "83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"existenceCondition\":{\"allOf\":[{\"equals\":\"AzureKeyVault\",\"field\":\"Microsoft.DBforMySQL/servers/keys/serverKeyType\"},{\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\",\"notEquals\":\"\"},{\"exists\":\"true\",\"field\":\"Microsoft.DBforMySQL/servers/keys/uri\"}]},\"type\":\"Microsoft.DBforMySQL/servers/keys\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
          "schema_version": 0,
          "attributes": {
            "description": "Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.",
            "display_name": "Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
            "management_group_name": null,
            "metadata": "{\"category\":\"Data Box\",\"version\":\"1.0.0\"}",
            "name": "86efb160-8de7-451d-bc08-5d475b0aadae",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}},\"supportedSKUs\":{\"type\":\"Array\",\"allowedValues\":[\"DataBox\",\"DataBoxHeavy\"],\"defaultValue\":[\"DataBox\",\"DataBoxHeavy\"],\"metadata\":{\"description\":\"The list of SKUs that support customer-managed key encryption key\",\"displayName\":\"Supported SKUs\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DataBox/jobs\",\"field\":\"type\"},{\"field\":\"Microsoft.Databox/jobs/sku.name\",\"in\":\"[parameters('supportedSKUs')]\"},{\"field\":\"Microsoft.DataBox/jobs/details.keyEncryptionKey.kekType\",\"notEquals\":\"CustomerManaged\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.",
            "display_name": "Azure Stream Analytics jobs should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Stream Analytics\",\"version\":\"1.1.0\"}",
            "name": "87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"Audit\",\"deny\",\"Deny\",\"disabled\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy.\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"SystemAccount\",\"field\":\"Microsoft.StreamAnalytics/streamingJobs/contentStoragePolicy\"},{\"equals\":\"Microsoft.StreamAnalytics/streamingJobs\",\"field\":\"type\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
          "schema_version": 0,
          "attributes": {
            "description": "Upgrade to the latest TLS version. We recommend all customers who are still using API Apps to implement the built-in policy called 'App Service apps should use the latest TLS version', which is scoped to include API apps in addition to Web Apps.",
            "display_name": "[Deprecated]: Latest TLS version should be used in your API App",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"deprecated\":true,\"version\":\"1.0.0-deprecated\"}",
            "name": "8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy resource group containing Log Analytics workspace and linked automation account to centralize logs and monitoring. The automation account is aprerequisite for solutions like Updates and Change Tracking.",
            "display_name": "Configure Log Analytics workspace and automation account to centralize logs and monitoring",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "parameters": "{\"automationAccountName\":{\"type\":\"String\",\"defaultValue\":\"CentralAutomationAccount\",\"metadata\":{\"description\":\"Provide name for automation account\",\"displayName\":\"automationAccountName\"}},\"automationRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for automation account\",\"displayName\":\"automationRegion\",\"strongType\":\"location\"}},\"dataRetention\":{\"type\":\"String\",\"defaultValue\":\"30\",\"metadata\":{\"description\":\"Enter the retention period in workspace, can be between 7 to 730 days. Billing is per 30 days at the minimum even when retention is shorter\",\"displayName\":\"dataRetention\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Select DeployIfNotExists to deploy central Log Analytics workspace, Audit or Disable to disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"defaultValue\":\"CentralRG\",\"metadata\":{\"description\":\"Provide name for resource group\",\"displayName\":\"rgName\"}},\"sku\":{\"type\":\"String\",\"allowedValues\":[\"pergb2018\",\"Free\",\"Standalone\",\"PerNode\",\"Standard\",\"Premium\"],\"defaultValue\":\"pergb2018\",\"metadata\":{\"description\":\"Select pricing tier. Legacy tiers (Free, Standalone, PerNode, Standard or Premium) are not available to all customers\",\"displayName\":\"sku\"}},\"workspaceName\":{\"type\":\"String\",\"defaultValue\":\"CentralWorkspace\",\"metadata\":{\"description\":\"Provide name for log analytics workspace\",\"displayName\":\"workspaceName\"}},\"workspaceRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enter Azure region for Log Analytics workspace\",\"displayName\":\"workspaceRegion\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('rgName')]\",\"deployment\":{\"location\":\"West Central US\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"automationAccountName\":{\"value\":\"[parameters('automationAccountName')]\"},\"automationRegion\":{\"value\":\"[parameters('automationRegion')]\"},\"dataRetention\":{\"value\":\"[parameters('dataRetention')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"},\"sku\":{\"value\":\"[parameters('sku')]\"},\"workspaceName\":{\"value\":\"[parameters('workspaceName')]\"},\"workspaceRegion\":{\"value\":\"[parameters('workspaceRegion')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"automationAccountName\":{\"type\":\"String\"},\"automationRegion\":{\"type\":\"String\"},\"dataRetention\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"},\"sku\":{\"type\":\"String\"},\"workspaceName\":{\"type\":\"String\"},\"workspaceRegion\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"log-analytics\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiversion\":\"2015-10-31\",\"comments\":\"Automation account for Log Analytics workapce\",\"location\":\"[parameters('AutomationRegion')]\",\"name\":\"[parameters('AutomationAccountName')]\",\"properties\":{\"sku\":{\"name\":\"OMS\"}},\"type\":\"Microsoft.Automation/automationAccounts\"},{\"apiVersion\":\"2020-08-01\",\"location\":\"[parameters('workspaceRegion')]\",\"name\":\"[parameters('workspaceName')]\",\"properties\":{\"enableLogAccessUsingOnlyResourcePermissions\":true,\"retentionInDays\":\"[parameters('dataRetention')]\",\"sku\":{\"name\":\"[parameters('sku')]\"}},\"resources\":[{\"apiVersion\":\"2020-08-01\",\"dependsOn\":[\"[parameters('workspaceName')]\",\"[parameters('AutomationAccountName')]\"],\"name\":\"Automation\",\"properties\":{\"resourceId\":\"[concat(subscription().id, '/resourceGroups/', parameters('rgName'), '/providers/Microsoft.Automation/automationAccounts/', parameters('AutomationAccountName'))]\"},\"type\":\"linkedServices\"}],\"type\":\"Microsoft.OperationalInsights/workspaces\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"Subscription\",\"existenceScope\":\"resourcegroup\",\"name\":\"[parameters('workspaceName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.OperationalInsights/workspaces\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for servers provides real-time threat protection for server workloads and generates hardening recommendations as well as alerts about suspicious activities.",
            "display_name": "Configure Azure Defender for servers to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"VirtualMachines\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"VirtualMachines\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Windows servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"windows\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-11-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('DaExtensionName'))]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"publisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"settings\":{},\"type\":\"[variables('DaExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"DaExtensionName\":\"DependencyAgentWindows\",\"DaExtensionType\":\"DependencyAgentWindows\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentWindows\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Recovery Services Vaults. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "[Preview]: Configure Azure Recovery Services vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Site Recovery\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "name": "942bd215-1a66-44be-af65-6a1c0318dbe2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone name required to resolve a private DNS Zone to recovery services vault private endpoint records.\",\"displayName\":\"Private DNS zone Id for Azure Recovery vaults resources\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"AzureSiteRecovery\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-siterecovery\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Network\",\"version\":\"1.0.0\"}",
            "name": "94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "parameters": "{\"ddosPlan\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoS Protection Plan resource to be associated to the virtual networks\",\"displayName\":\"DDoS Protection Plan\",\"strongType\":\"Microsoft.Network/ddosProtectionPlans\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Modify\",\"Audit\",\"Disabled\"],\"defaultValue\":\"Modify\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"notEquals\":true},{\"equals\":\"\",\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan\"}]}]},\"then\":{\"details\":{\"conflictEffect\":\"audit\",\"operations\":[{\"field\":\"Microsoft.Network/virtualNetworks/enableDdosProtection\",\"operation\":\"addOrReplace\",\"value\":true},{\"field\":\"Microsoft.Network/virtualNetworks/ddosProtectionPlan.id\",\"operation\":\"addOrReplace\",\"value\":\"[parameters('ddosPlan')]\"}],\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"]},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"9.0.0\"}",
            "name": "98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"auditIfNotExists\",\"AuditIfNotExists\",\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"exclusionTagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding VMs from the scope of this policy. This should be used along with the Exclusion Tag Value parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Name\"}},\"exclusionTagValue\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Value of the tag to use for excluding VMs from the scope of this policy (in case of multiple values, use a comma-separated list). This should be used along with the Exclusion Tag Name parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\",\"displayName\":\"Exclusion Tag Values\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"not\":{\"field\":\"[concat('tags[', parameters('exclusionTagName'), ']')]\",\"in\":\"[parameters('exclusionTagValue')]\"}},{\"field\":\"id\",\"notContains\":\"/resourceGroups/databricks-rg-\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"azureopenshift\"},{\"field\":\"Microsoft.Compute/imagePublisher\",\"notEquals\":\"AzureDatabricks\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\",\"2019-datacenter-gensecond\",\"2022-datacenter-g2\",\"2022-datacenter\",\"2022-datacenter-azure-edition\",\"2022-datacenter-azure-edition-smalldisk\",\"2022-datacenter-azure-edition-core\",\"2022-datacenter-azure-edition-core-smalldisk\",\"2022-datacenter-smalldisk-g2\",\"2022-datacenter-smalldisk\",\"2022-datacenter-core-g2\",\"2022-datacenter-core\",\"2022-datacenter-core-smalldisk-g2\",\"2022-datacenter-core-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2019\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"8*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"12*\"}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"contains\":\"ubuntu\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"14.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"16.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"18.04*LTS\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"*20_04-lts\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"20_04-lts*\"}]}]},{\"allOf\":[{\"equals\":\"Oracle\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Oracle-Linux\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7.*\"}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"CentOS\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"},\"vmRgName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"status\":{\"type\":\"string\",\"value\":\"[concat('Backup enabled successfully for VM:', ' ', parameters('vmName'), 'Backup Vault: ', variables('vaultName'))]\"}},\"parameters\":{\"location\":{\"metadata\":{\"description\":\"Location for VM and Backup vault\"},\"type\":\"string\"},\"vmName\":{\"metadata\":{\"description\":\"Name of Azure Virtual Machines\"},\"type\":\"string\"},\"vmRgName\":{\"metadata\":{\"description\":\"Resource group containing the virtual machines.\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2016-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('vaultName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard\"},\"type\":\"Microsoft.RecoveryServices/vaults\"},{\"apiVersion\":\"2016-12-01\",\"dependsOn\":[\"[resourceId('Microsoft.RecoveryServices/vaults/', variables('vaultName'))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('vaultName'), '/', variables('backupFabric'), '/', variables('v2VmContainer'), concat(parameters('vmRgName'),';',parameters('vmName')), '/', variables('v2Vm'), concat(parameters('vmRgName'),';',parameters('vmName')))]\",\"properties\":{\"policyId\":\"[resourceId('Microsoft.RecoveryServices/vaults/backupPolicies', variables('vaultName'),variables('backupPolicy'))]\",\"protectedItemType\":\"[variables('v2VmType')]\",\"sourceResourceId\":\"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', parameters('vmRgName'), '/providers/Microsoft.Compute/virtualMachines/', parameters('vmName'))]\"},\"type\":\"Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\"}],\"variables\":{\"backupFabric\":\"Azure\",\"backupPolicy\":\"DefaultPolicy\",\"v2Vm\":\"vm;iaasvmcontainerv2;\",\"v2VmContainer\":\"iaasvmcontainer;iaasvmcontainerv2;\",\"v2VmType\":\"Microsoft.Compute/virtualMachines\",\"vaultName\":\"[take(concat('RSVault-', parameters('location'), '-', guid(resourceGroup().id)),50)]\"}}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\"/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\"],\"type\":\"Microsoft.RecoveryServices/backupprotecteditems\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
              "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/Batch-CMK.",
            "display_name": "Azure Batch account should use customer-managed keys to encrypt data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Batch\",\"version\":\"1.0.1\"}",
            "name": "99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"The desired effect of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},{\"field\":\"Microsoft.Batch/batchAccounts/encryption.keySource\",\"notEquals\":\"Microsoft.KeyVault\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Log Analytics virtual machine extension. VM insights uses the Log Analytics agent to collect the guest OS performance data, and provides insights into their performance. See more - https://aka.ms/vminsightsdocs. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date",
            "display_name": "Configure Log Analytics extension on Azure Arc enabled Linux servers. See deprecation notice below",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.1.1\"}",
            "name": "9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"protectedSettings\":{\"workspaceKey\":\"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"},\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{\"stopOnMultipleConnections\":\"true\",\"workspaceId\":\"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"OMSAgentForLinux\",\"vmExtensionPublisher\":\"Microsoft.EnterpriseCloud.Monitoring\",\"vmExtensionType\":\"OmsAgentForLinux\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"OmsAgentForLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.EnterpriseCloud.Monitoring\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\",\"notEquals\":\"Failed\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
          "schema_version": 0,
          "attributes": {
            "description": "Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.",
            "display_name": "Auditing on SQL server should be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "name": "a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"setting\":{\"type\":\"String\",\"allowedValues\":[\"enabled\",\"disabled\"],\"defaultValue\":\"enabled\",\"metadata\":{\"displayName\":\"Desired Auditing setting\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"analytics\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"[parameters('setting')]\",\"field\":\"Microsoft.Sql/auditingSettings.state\"},\"name\":\"default\",\"type\":\"Microsoft.Sql/servers/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
          "schema_version": 0,
          "attributes": {
            "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
            "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "management_group_name": null,
            "metadata": "{\"category\":\"Kubernetes\",\"version\":\"4.0.0\"}",
            "name": "a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerService/managedClusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"clusterName\":{\"value\":\"[field('name')]\"},\"clusterResourceGroupName\":{\"value\":\"[resourceGroup().name]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"clusterName\":{\"type\":\"string\"},\"clusterResourceGroupName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterGetDeploymentName')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"aksCluster\":{\"type\":\"object\",\"value\":\"[reference(resourceId(parameters('clusterResourceGroupName'), 'Microsoft.ContainerService/managedClusters', parameters('clusterName')), '2021-07-01', 'Full')]\"}},\"resources\":[]}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2020-06-01\",\"name\":\"[variables('clusterUpdateDeploymentName')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"aksClusterContent\":{\"value\":\"[reference(variables('clusterGetDeploymentName')).outputs.aksCluster.value]\"},\"aksClusterName\":{\"value\":\"[parameters('clusterName')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"aksClusterContent\":{\"type\":\"object\"},\"aksClusterName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-07-01\",\"location\":\"[parameters('aksClusterContent').location]\",\"name\":\"[parameters('aksClusterName')]\",\"properties\":{\"aadProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'aadProfile'), parameters('aksClusterContent').properties.aadProfile, json('null'))]\",\"addonProfiles\":{\"azurepolicy\":{\"enabled\":true}},\"agentPoolProfiles\":\"[if(contains(parameters('aksClusterContent').properties, 'agentPoolProfiles'), parameters('aksClusterContent').properties.agentPoolProfiles, json('null'))]\",\"apiServerAccessProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'apiServerAccessProfile'), parameters('aksClusterContent').properties.apiServerAccessProfile, json('null'))]\",\"autoScalerProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'autoScalerProfile'), parameters('aksClusterContent').properties.autoScalerProfile, json('null'))]\",\"diskEncryptionSetID\":\"[if(contains(parameters('aksClusterContent').properties, 'diskEncryptionSetID'), parameters('aksClusterContent').properties.diskEncryptionSetID, json('null'))]\",\"dnsPrefix\":\"[parameters('aksClusterContent').properties.dnsPrefix]\",\"enablePodSecurityPolicy\":\"[if(contains(parameters('aksClusterContent').properties, 'enablePodSecurityPolicy'), parameters('aksClusterContent').properties.enablePodSecurityPolicy, json('null'))]\",\"enableRBAC\":\"[if(contains(parameters('aksClusterContent').properties, 'enableRBAC'), parameters('aksClusterContent').properties.enableRBAC, json('null'))]\",\"identityProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'identityProfile'), parameters('aksClusterContent').properties.identityProfile, json('null'))]\",\"kubernetesVersion\":\"[parameters('aksClusterContent').properties.kubernetesVersion]\",\"linuxProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'linuxProfile'), parameters('aksClusterContent').properties.linuxProfile, json('null'))]\",\"networkProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'networkProfile'), parameters('aksClusterContent').properties.networkProfile, json('null'))]\",\"nodeResourceGroup\":\"[parameters('aksClusterContent').properties.nodeResourceGroup]\",\"servicePrincipalProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'servicePrincipalProfile'), parameters('aksClusterContent').properties.servicePrincipalProfile, json('null'))]\",\"windowsProfile\":\"[if(contains(parameters('aksClusterContent').properties, 'windowsProfile'), parameters('aksClusterContent').properties.windowsProfile, json('null'))]\"},\"sku\":\"[parameters('aksClusterContent').sku]\",\"tags\":\"[if(contains(parameters('aksClusterContent'), 'tags'), parameters('aksClusterContent').tags, json('null'))]\",\"type\":\"Microsoft.ContainerService/managedClusters\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"clusterGetDeploymentName\":\"[concat('PolicyDeployment-Get-', parameters('clusterName'))]\",\"clusterUpdateDeploymentName\":\"[concat('PolicyDeployment-Update-', parameters('clusterName'))]\"}}}},\"existenceCondition\":{\"equals\":\"true\",\"field\":\"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\"},\"name\":\"[field('name')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8\",\"/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064\"],\"type\":\"Microsoft.ContainerService/managedClusters\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
              "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to an IoT Hub device provisioning service instance. Learn more at: https://aka.ms/iotdpsvnet.",
            "display_name": "Configure IoT Hub device provisioning instances to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.0.0\"}",
            "name": "aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotDps\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices-provisioning.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to key vault. Learn more at: https://aka.ms/akvprivatelink.",
            "display_name": "[Preview]: Configure Azure Key Vaults to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "management_group_name": null,
            "metadata": "{\"category\":\"Key Vault\",\"preview\":true,\"version\":\"1.0.0-preview\"}",
            "name": "ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"A private DNS zone ID to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"vault\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"keyvault-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure SignalR Service resource. Learn more at: https://aka.ms/asrs/privatelink.",
            "display_name": "Deploy - Configure private DNS zones for private endpoints connect to Azure SignalR Service",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "management_group_name": null,
            "metadata": "{\"category\":\"SignalR\",\"version\":\"1.0.0\"}",
            "name": "b0e86710-7fb7-4a6c-a064-32e9b829509e",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"defaultValue\":\"privatelink.service.signalr.net\",\"metadata\":{\"description\":\"Private DNS zone to integrate with private endpoint.\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"signalr\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-service-signalr-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links a virtual network to an App Service. Learn more at: https://docs.microsoft.com/azure/app-service/networking/private-endpoint#dns.",
            "display_name": "Configure App Service apps to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"1.0.1\"}",
            "name": "b318f84a-b872-429b-ac6d-a01b96814452",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The private DNS zone to deploy in a new private DNS zone group and link to the private endpoint\",\"displayName\":\"Private Dns Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Web/sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"sites\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"websites-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for App Service leverages the scale of the cloud, and the visibility that Azure has as a cloud provider, to monitor for common web app attacks.",
            "display_name": "Configure Azure Defender for App Service to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"AppServices\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"AppServices\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for Resource Manager automatically monitors the resource management operations in your organization. Azure Defender detects threats and alerts you about suspicious activity. Learn more about the capabilities of Azure Defender for Resource Manager at https://aka.ms/defender-for-resource-manager . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .",
            "display_name": "Configure Azure Defender for Resource Manager to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.1\"}",
            "name": "b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"Arm\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Arm\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Databases to stream resource logs to a Log Analytics workspace when any SQL Database which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy - Configure diagnostic settings for SQL Databases to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"4.0.0\"}",
            "name": "b79fa14e-238a-4c2d-b376-442ce508fc84",
            "parameters": "{\"AutomaticTuningEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream AutomaticTuning logs to the Log Analytics workspace - True or False\",\"displayName\":\"AutomaticTuning - Enabled\"}},\"Basic\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Basic metrics to the Log Analytics workspace - True or False\",\"displayName\":\"Basic (metric) - Enabled\"}},\"BlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Blocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Blocks - Enabled\"}},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream DatabaseWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"DatabaseWaitStatistics - Enabled\"}},\"DeadlocksEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Deadlocks logs to the Log Analytics workspace - True or False\",\"displayName\":\"Deadlocks - Enabled\"}},\"ErrorsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Errors logs to the Log Analytics workspace - True or False\",\"displayName\":\"Errors - Enabled\"}},\"InstanceAndAppAdvanced\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream InstanceAndAppAdvanced metrics to the Log Analytics workspace - True or False\",\"displayName\":\"InstanceAndAppAdvanced (metric) - Enabled\"}},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreRuntimeStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreRuntimeStatistics - Enabled\"}},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream QueryStoreWaitStatistics logs to the Log Analytics workspace - True or False\",\"displayName\":\"QueryStoreWaitStatistics - Enabled\"}},\"SQLInsightsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLInsights logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLInsights - Enabled\"}},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream SQLSecurityAuditEvents logs to the Log Analytics workspace - True or False\",\"displayName\":\"SQLSecurityAuditEvents - Enabled\"}},\"TimeoutsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream Timeouts logs to the Log Analytics workspace - True or False\",\"displayName\":\"Timeouts - Enabled\"}},\"WorkloadManagement\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to stream WorkloadManagement metrics to the Log Analytics workspace - True or False\",\"displayName\":\"WorkloadManagement (metric) - Enabled\"}},\"diagnosticsSettingNameToUse\":{\"type\":\"String\",\"defaultValue\":\"SQLDatabaseDiagnosticsLogsToWorkspace\",\"metadata\":{\"description\":\"Name of the diagnostic settings.\",\"displayName\":\"Setting name\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select the Log Analytics workspace from dropdown list\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},{\"field\":\"name\",\"notEquals\":\"master\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"AutomaticTuningEnabled\":{\"value\":\"[parameters('AutomaticTuningEnabled')]\"},\"Basic\":{\"value\":\"[parameters('Basic')]\"},\"BlocksEnabled\":{\"value\":\"[parameters('BlocksEnabled')]\"},\"DatabaseWaitStatisticsEnabled\":{\"value\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},\"DeadlocksEnabled\":{\"value\":\"[parameters('DeadlocksEnabled')]\"},\"ErrorsEnabled\":{\"value\":\"[parameters('ErrorsEnabled')]\"},\"InstanceAndAppAdvanced\":{\"value\":\"[parameters('InstanceAndAppAdvanced')]\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},\"QueryStoreWaitStatisticsEnabled\":{\"value\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},\"SQLInsightsEnabled\":{\"value\":\"[parameters('SQLInsightsEnabled')]\"},\"SQLSecurityAuditEventsEnabled\":{\"value\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"},\"TimeoutsEnabled\":{\"value\":\"[parameters('TimeoutsEnabled')]\"},\"WorkloadManagement\":{\"value\":\"[parameters('WorkloadManagement')]\"},\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('diagnosticsSettingNameToUse')]\"},\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"AutomaticTuningEnabled\":{\"type\":\"string\"},\"Basic\":{\"type\":\"string\"},\"BlocksEnabled\":{\"type\":\"string\"},\"DatabaseWaitStatisticsEnabled\":{\"type\":\"string\"},\"DeadlocksEnabled\":{\"type\":\"string\"},\"ErrorsEnabled\":{\"type\":\"string\"},\"InstanceAndAppAdvanced\":{\"type\":\"string\"},\"QueryStoreRuntimeStatisticsEnabled\":{\"type\":\"string\"},\"QueryStoreWaitStatisticsEnabled\":{\"type\":\"string\"},\"SQLInsightsEnabled\":{\"type\":\"string\"},\"SQLSecurityAuditEventsEnabled\":{\"type\":\"string\"},\"TimeoutsEnabled\":{\"type\":\"string\"},\"WorkloadManagement\":{\"type\":\"string\"},\"diagnosticsSettingNameToUse\":{\"type\":\"string\"},\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('diagnosticsSettingNameToUse'))]\",\"properties\":{\"logs\":[{\"category\":\"SQLInsights\",\"enabled\":\"[parameters('SQLInsightsEnabled')]\"},{\"category\":\"AutomaticTuning\",\"enabled\":\"[parameters('AutomaticTuningEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\"},{\"category\":\"Errors\",\"enabled\":\"[parameters('ErrorsEnabled')]\"},{\"category\":\"DatabaseWaitStatistics\",\"enabled\":\"[parameters('DatabaseWaitStatisticsEnabled')]\"},{\"category\":\"Timeouts\",\"enabled\":\"[parameters('TimeoutsEnabled')]\"},{\"category\":\"Blocks\",\"enabled\":\"[parameters('BlocksEnabled')]\"},{\"category\":\"Deadlocks\",\"enabled\":\"[parameters('DeadlocksEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('SQLSecurityAuditEventsEnabled')]\"}],\"metrics\":[{\"category\":\"Basic\",\"enabled\":\"[parameters('Basic')]\"},{\"category\":\"InstanceAndAppAdvanced\",\"enabled\":\"[parameters('InstanceAndAppAdvanced')]\"},{\"category\":\"WorkloadManagement\",\"enabled\":\"[parameters('WorkloadManagement')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/databases/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"SQLInsights\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLInsightsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"AutomaticTuning\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('AutomaticTuningEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreRuntimeStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreRuntimeStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"QueryStoreWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('QueryStoreWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Errors\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('ErrorsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"DatabaseWaitStatistics\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DatabaseWaitStatisticsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Timeouts\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('TimeoutsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Blocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('BlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"Deadlocks\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('DeadlocksEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]},{\"allOf\":[{\"equals\":\"SQLSecurityAuditEvents\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"},{\"equals\":\"[parameters('SQLSecurityAuditEventsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"}]}]}},\"equals\":10},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Basic\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('Basic')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"InstanceAndAppAdvanced\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('InstanceAndAppAdvanced')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]},{\"allOf\":[{\"equals\":\"WorkloadManagement\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].category\"},{\"equals\":\"[parameters('WorkloadManagement')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}]}]}},\"equals\":3}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Logic Apps to stream to a regional Log Analytics workspace when any Logic Apps which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Logic Apps to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "b889a06c-ec72-4b03-910a-cb169ee18721",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/workflows\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"WorkflowRuntime\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/workflows/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, and discovering and classifying sensitive data.",
            "display_name": "Configure Azure Defender for Azure SQL database to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "b99b73e7-074b-4089-9395-b7236f094491",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"SqlServers\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"SqlServers\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
          "schema_version": 0,
          "attributes": {
            "description": "Manage encryption at rest of Azure Machine Learning workspace data with customer-managed keys. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/azureml-workspaces-cmk.",
            "display_name": "Azure Machine Learning workspaces should be encrypted with a customer-managed key",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.0.3\"}",
            "name": "ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"not\":{\"equals\":\"enabled\",\"field\":\"Microsoft.MachineLearningServices/workspaces/encryption.status\"}}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid topics to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "name": "baf19753-7502-405f-8745-370519b20483",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"topic\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"topic-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to a managed disk. Learn more at: https://aka.ms/disksprivatelinksdoc.",
            "display_name": "Configure disk access resources to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Compute\",\"version\":\"1.0.0\"}",
            "name": "bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for managed disks to resolve a private DNS Zone.\",\"displayName\":\"Private DNS Zone ID for managed disks\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.Compute/diskAccesses\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"disks\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"diskAccess-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Key Vault to stream to a regional Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Key Vault to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"3.0.0\"}",
            "name": "bef3f64c-5290-43b7-85b0-9b254eef4c47",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"matchWorkspace\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":false,\"metadata\":{\"description\":\"Whether to require that the workspace of the diagnostic settings matches the workspace deployed by this policy\",\"displayName\":\"Workspace id must match\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzurePolicyEvaluationDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.KeyVault/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"evaluationDelay\":\"AfterProvisioning\",\"existenceCondition\":{\"allOf\":[{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].enabled\"},{\"equals\":\"AuditEvent\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].category\"}]}},\"greaterOrEquals\":1},{\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*]\",\"where\":{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\"}},\"greaterOrEquals\":1},{\"anyOf\":[{\"equals\":false,\"value\":\"[parameters('matchWorkspace')]\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Cognitive Services accounts. Learn more at: https://go.microsoft.com/fwlink/?linkid=2110097.",
            "display_name": "Configure Cognitive Services accounts to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cognitive Services\",\"version\":\"1.0.0\"}",
            "name": "c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The private DNS zone name required for Cognitive Services to resolve a private DNS Zone to your Cognitive Services account.\",\"displayName\":\"Private DNS Zone ID for Cognitive Services account\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\"where\":{\"allOf\":[{\"contains\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\"},{\"equals\":\"account\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}]}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-cognitiveservices-azure-com\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Diagnostic Settings for Recovery Services Vault to stream to Log Analytics workspace for Resource specific categories. If any of the Resource specific categories are not enabled, a new diagnostic setting is created.",
            "display_name": "Deploy Diagnostic Settings for Recovery Services Vault to Log Analytics workspace for resource specific categories.",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "management_group_name": null,
            "metadata": "{\"category\":\"Backup\",\"version\":\"1.0.2\"}",
            "name": "c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
            "parameters": "{\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}},\"tagName\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Name of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Value parameter.\",\"displayName\":\"Exclusion Tag Name\"}},\"tagValue\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Value of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Name parameter.\",\"displayName\":\"Exclusion Tag Value\"}}}",
            "policy_rule": "{\"if\":{\"allof\":[{\"equals\":\"Microsoft.RecoveryServices/vaults\",\"field\":\"type\"},{\"not\":{\"equals\":\"[parameters('tagValue')]\",\"field\":\"[concat('tags[',parameters('tagName'), ']')]\"}}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"vaultName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat(parameters('logAnalytics'), 'configured for resource logs for ', ': ', parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\"}},\"parameters\":{\"logAnalytics\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"vaultName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"name\":\"[concat(parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logAnalyticsDestinationType\":\"Dedicated\",\"logs\":[{\"category\":\"CoreAzureBackup\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupAlerts\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupJobs\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupPolicy\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupProtectedInstance\",\"enabled\":\"true\"},{\"category\":\"AddonAzureBackupStorage\",\"enabled\":\"true\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.RecoveryServices/vaults/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allof\":[{\"Equals\":6,\"count\":{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*]\",\"where\":{\"allof\":[{\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Category\",\"in\":[\"CoreAzureBackup\",\"AddonAzureBackupJobs\",\"AddonAzureBackupAlerts\",\"AddonAzureBackupPolicy\",\"AddonAzureBackupStorage\",\"AddonAzureBackupProtectedInstance\"]},{\"equals\":\"True\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs[*].Enabled\"}]}}},{\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\",\"notEquals\":\"\"},{\"equals\":\"Dedicated\",\"field\":\"Microsoft.Insights/diagnosticSettings/logAnalyticsDestinationType\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Batch Account to stream to a regional Log Analytics workspace when any Batch Account which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Batch Account to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "c84e5349-db6d-4769-805e-e14037dab9b5",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Batch/batchAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ServiceLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Batch/batchAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
          "schema_version": 0,
          "attributes": {
            "description": "Disabling the public network access property improves security by ensuring your Azure Database for MySQL flexible servers can only be accessed from a private endpoint. This configuration strictly disables access from any public address space outside of Azure IP range and denies all logins that match IP or virtual network-based firewall rules.",
            "display_name": "Public network access should be disabled for MySQL flexible servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
            "management_group_name": null,
            "metadata": "{\"category\":\"SQL\",\"version\":\"2.0.0\"}",
            "name": "c9299215-ae47-4f50-9c54-8a392f68a052",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/flexibleServers\",\"field\":\"type\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.delegatedSubnetResourceId\"},{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/flexibleServers/network.privateDnsZoneResourceId\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Private DNS provides a reliable, secure DNS service to manage and resolve domain names in a virtual network without the need to add a custom DNS solution. You can use private DNS zones to override the DNS resolution by using your own custom domain names for a private endpoint. This policy deploys a private DNS Zone for IoT Hub private endpoints.",
            "display_name": "Deploy - Configure Azure IoT Hubs to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "management_group_name": null,
            "metadata": "{\"category\":\"Internet of Things\",\"version\":\"1.1.0\"}",
            "name": "c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"disabled\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"iotHub\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink.azure-devices.net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
          "schema_version": 0,
          "attributes": {
            "description": "Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.",
            "display_name": "Configure Microsoft Defender for Containers to be enabled",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"1.0.0\"}",
            "name": "c9ddb292-b203-4738-aead-18e2716e858f",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2018-06-01\",\"name\":\"Containers\",\"properties\":{\"pricingTier\":\"Standard\"},\"type\":\"Microsoft.Security/pricings\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"equals\":\"Standard\",\"field\":\"Microsoft.Security/pricings/pricingTier\"},\"existenceScope\":\"subscription\",\"name\":\"Containers\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/pricings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Deploy - Configure Azure Event Grid domains to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Grid\",\"version\":\"1.1.0\"}",
            "name": "d389df0a-e0d7-4607-833c-75a6fdac2c2d",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"deployIfNotExists\",\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"domain\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"domain-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated.",
            "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.0\"}",
            "name": "d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"False\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy_logAnalytics\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"string\"},\"logAnalytics\":{\"type\":\"string\"},\"logsEnabled\":{\"type\":\"string\"},\"metricsEnabled\":{\"type\":\"string\"},\"profileName\":{\"type\":\"string\"},\"resourceName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('logsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('metricsEnabled')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"}]},\"name\":\"[parameters('profileName')]\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
          "schema_version": 0,
          "attributes": {
            "description": "Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.",
            "display_name": "Configure Dependency agent on Azure Arc enabled Linux servers",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "deacecc0-9f84-44d2-bb82-46f32d766d43",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.HybridCompute/machines\",\"field\":\"type\"},{\"equals\":\"linux\",\"field\":\"Microsoft.HybridCompute/machines/osName\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"policy\":{\"type\":\"string\",\"value\":\"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"}},\"parameters\":{\"location\":{\"type\":\"string\"},\"vmName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-12-12\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\"properties\":{\"publisher\":\"[variables('vmExtensionPublisher')]\",\"settings\":{},\"type\":\"[variables('vmExtensionType')]\"},\"type\":\"Microsoft.HybridCompute/machines/extensions\"}],\"variables\":{\"vmExtensionName\":\"DependencyAgentLinux\",\"vmExtensionPublisher\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"vmExtensionType\":\"DependencyAgentLinux\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"DependencyAgentLinux\",\"field\":\"Microsoft.HybridCompute/machines/extensions/type\"},{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.HybridCompute/machines/extensions/publisher\"},{\"equals\":\"Succeeded\",\"field\":\"Microsoft.HybridCompute/machines/extensions/provisioningState\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.HybridCompute/machines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone can be linked to your virtual network to resolve to Azure Cache for Redis. Learn more at: https://aka.ms/privatednszone.",
            "display_name": "Configure Azure Cache for Redis to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "management_group_name": null,
            "metadata": "{\"category\":\"Cache\",\"version\":\"1.0.0\"}",
            "name": "e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource id of the private DNS zone\",\"displayName\":\"Private DNS Zone Id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"redisCache\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"privatelink-redis-cache-windows-net\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
          "schema_version": 0,
          "attributes": {
            "description": "Reports virtual machine scale sets as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.",
            "display_name": "Dependency agent should be enabled in virtual machine scale sets for listed virtual machine images",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.0\"}",
            "name": "e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of virtual machine images that have supported Windows OS to add to scope\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},{\"not\":{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_windows')]\"},{\"field\":\"Microsoft.Compute/imageId\",\"in\":\"[parameters('listOfImageIdToInclude_linux')]\"},{\"anyOf\":[{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2012-Datacenter\",\"2012-Datacenter-smalldisk\",\"2012-R2-Datacenter\",\"2012-R2-Datacenter-smalldisk\",\"2016-Datacenter\",\"2016-Datacenter-Server-Core\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-Datacenter-smalldisk\",\"2016-Datacenter-with-Containers\",\"2016-Datacenter-with-RDSH\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-Datacenter-Core-smalldisk\",\"2019-Datacenter-Core-with-Containers\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-Datacenter-smalldisk\",\"2019-Datacenter-with-Containers\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-Datacenter-zhcn\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerSemiAnnual\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"Datacenter-Core-1709-smalldisk\",\"Datacenter-Core-1709-with-Containers-smalldisk\",\"Datacenter-Core-1803-with-Containers-smalldisk\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServerHPCPack\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftSQLServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2016-BYOL\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"like\":\"*-WS2012R2-BYOL\"}]}]},{\"allOf\":[{\"equals\":\"MicrosoftRServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"MLServer-WS2016\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftVisualStudio\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"VisualStudio\",\"Windows\"]}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-U8\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"MicrosoftDynamicsAX\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Dynamics\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"equals\":\"Pre-Req-AX7-Onebox-V4\",\"field\":\"Microsoft.Compute/imageSKU\"}]},{\"allOf\":[{\"equals\":\"microsoft-ads\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"windows-data-science-vm\",\"field\":\"Microsoft.Compute/imageOffer\"}]},{\"allOf\":[{\"equals\":\"MicrosoftWindowsDesktop\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"Windows-10\",\"field\":\"Microsoft.Compute/imageOffer\"}]}]},{\"allOf\":[{\"equals\":\"RedHat\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"RHEL\",\"RHEL-SAP-HANA\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"SUSE\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"SLES\",\"SLES-HPC\",\"SLES-HPC-Priority\",\"SLES-SAP\",\"SLES-SAP-BYOS\",\"SLES-Priority\",\"SLES-BYOS\",\"SLES-SAPCAL\",\"SLES-Standard\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"12-SP2\",\"12-SP3\",\"12-SP4\"]}]}]},{\"allOf\":[{\"equals\":\"Canonical\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"UbuntuServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"14.04.0-LTS\",\"14.04.1-LTS\",\"14.04.5-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"16.04-LTS\",\"16.04.0-LTS\"]},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"18.04-LTS\"]}]}]},{\"allOf\":[{\"equals\":\"OpenLogic\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"field\":\"Microsoft.Compute/imageOffer\",\"in\":[\"Centos\",\"Centos-LVM\",\"CentOS-SRIOV\"]},{\"anyOf\":[{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"6.*\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]},{\"allOf\":[{\"equals\":\"cloudera\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"cloudera-centos-os\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"like\":\"7*\"}]}]}}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"Microsoft.Azure.Monitoring.DependencyAgent\",\"field\":\"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Container Registry. Learn more at: https://aka.ms/privatednszone and https://aka.ms/acr/private-link.",
            "display_name": "Configure Container registries to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "management_group_name": null,
            "metadata": "{\"category\":\"Container Registry\",\"version\":\"1.0.0\"}",
            "name": "e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint. It should be linked to the private endpoint's associated VNET.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"registry\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"containerRegistry-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Event Hub namespaces. Learn more at: https://docs.microsoft.com/azure/event-hubs/private-link-service.",
            "display_name": "Configure Event Hub namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "management_group_name": null,
            "metadata": "{\"category\":\"Event Hub\",\"version\":\"1.0.0\"}",
            "name": "ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Machine Learning workspaces. Learn more at: https://docs.microsoft.com/azure/machine-learning/how-to-network-security-overview.",
            "display_name": "Configure Azure Machine Learning workspace to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "management_group_name": null,
            "metadata": "{\"category\":\"Machine Learning\",\"version\":\"1.0.0\"}",
            "name": "ee40564d-486e-4f68-a5ca-7a621edae0fb",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"A private DNS zone id to connect to the private endpoint.\",\"displayName\":\"Private DNS Zone id\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"amlworkspace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"amlworkspace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
          "schema_version": 0,
          "attributes": {
            "description": "Upgrade to the latest TLS version.",
            "display_name": "App Service apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.0\"}",
            "name": "f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"notContains\":\"functionapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Service Bus namespaces. Learn more at: https://docs.microsoft.com/azure/service-bus-messaging/private-link-service.",
            "display_name": "Configure Service Bus namespaces to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
            "management_group_name": null,
            "metadata": "{\"category\":\"Service Bus\",\"version\":\"1.0.0\"}",
            "name": "f0fcf93c-c063-4071-9668-c47474bd3564",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS Zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"namespace\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"namespace-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
          "schema_version": 0,
          "attributes": {
            "description": "Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.",
            "display_name": "Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
            "management_group_name": null,
            "metadata": "{\"category\":\"Synapse\",\"version\":\"1.0.0\"}",
            "name": "f7d52b2d-e161-4dfa-a82b-55e564167385",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Synapse/workspaces\",\"field\":\"type\"},{\"exists\":false,\"field\":\"Microsoft.Synapse/workspaces/encryption.cmk.key.name\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
          "schema_version": 0,
          "attributes": {
            "description": "Upgrade to the latest TLS version.",
            "display_name": "Function apps should use the latest TLS version",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
            "management_group_name": null,
            "metadata": "{\"category\":\"App Service\",\"version\":\"2.0.0\"}",
            "name": "f9d614c5-c173-4d56-95a7-b4437057d193",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"field\":\"kind\"},{\"field\":\"kind\",\"notContains\":\"workflowapp\"}]},\"then\":{\"details\":{\"existenceCondition\":{\"equals\":\"1.2\",\"field\":\"Microsoft.Web/sites/config/minTlsVersion\"},\"name\":\"web\",\"type\":\"Microsoft.Web/sites/config\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
          "schema_version": 0,
          "attributes": {
            "description": "Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to your Azure Cognitive Search service. Learn more at: https://aka.ms/azure-cognitive-search/inbound-private-endpoints.",
            "display_name": "Configure Azure Cognitive Search services to use private DNS zones",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
            "management_group_name": null,
            "metadata": "{\"category\":\"Search\",\"version\":\"1.0.0\"}",
            "name": "fbc14a67-53e4-4932-abcc-2049c6706009",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"privateDnsZoneId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the private DNS zone to use to configure private endpoint\",\"displayName\":\"Private DNS zone ID\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/privateEndpoints\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\"where\":{\"equals\":\"searchService\",\"field\":\"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\"}},\"greaterOrEquals\":1}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('privateDnsZoneId')]\"},\"privateEndpointName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"location\":{\"type\":\"string\"},\"privateDnsZoneId\":{\"type\":\"string\"},\"privateEndpointName\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-03-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\"properties\":{\"privateDnsZoneConfigs\":[{\"name\":\"searchService-privateDnsZone\",\"properties\":{\"privateDnsZoneId\":\"[parameters('privateDnsZoneId')]\"}}]},\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"}]}}},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
          "schema_version": 0,
          "attributes": {
            "description": "Enable export to Log Analytics workspace of Microsoft Defender for Cloud data. This policy deploys an export to Log Analytics workspace configuration with your conditions and target workspace on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.",
            "display_name": "Deploy export to Log Analytics workspace for Microsoft Defender for Cloud data",
            "id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
            "management_group_name": null,
            "metadata": "{\"category\":\"Security Center\",\"version\":\"4.1.0\"}",
            "name": "ffb6f416-7bd2-4488-8828-56585fef2be9",
            "parameters": "{\"alertSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security alerts. Determines alert severities. Example: High;Medium;Low;\",\"displayName\":\"Alert severities\"}},\"createResourceGroup\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"If a resource group does not exists in the scope, a new resource group will be created. If the resource group exists and this flag is set to 'true' the policy will re-deploy the resource group. Please note this will reset any Azure Tag on the resource group.\",\"displayName\":\"Create resource group\"}},\"exportedDataTypes\":{\"type\":\"Array\",\"allowedValues\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"defaultValue\":[\"Security recommendations\",\"Security alerts\",\"Overall secure score\",\"Secure score controls\",\"Regulatory compliance\",\"Overall secure score - snapshot\",\"Secure score controls - snapshot\",\"Regulatory compliance - snapshot\",\"Security recommendations - snapshot\",\"Security findings - snapshot\"],\"metadata\":{\"description\":\"The data types to be exported. To export a snapshot (preview) of the data once a week, choose the data types which contains 'snapshot', other data types will be sent in real-time streaming.\",\"displayName\":\"Exported data types\"}},\"isSecurityFindingsEnabled\":{\"type\":\"Boolean\",\"allowedValues\":[true,false],\"defaultValue\":true,\"metadata\":{\"description\":\"Security findings are results from vulnerability assessment solutions, and can be thought of as 'sub' recommendations grouped into a 'parent' recommendation.\",\"displayName\":\"Include security findings\"}},\"recommendationNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. To export all recommendations, leave this empty. To export specific recommendations, enter a list of recommendation IDs separated by semicolons (';'). Recommendation IDs are available through the Assessments API (https://docs.microsoft.com/rest/api/securitycenter/assessments), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/assessments.\",\"displayName\":\"Recommendation IDs\"}},\"recommendationSeverities\":{\"type\":\"Array\",\"allowedValues\":[\"High\",\"Medium\",\"Low\"],\"defaultValue\":[\"High\",\"Medium\",\"Low\"],\"metadata\":{\"description\":\"Applicable only for export of security recommendations. Determines recommendation severities. Example: High;Medium;Low;\",\"displayName\":\"Recommendation severities\"}},\"regulatoryComplianceStandardsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of regulatory compliance. To export all regulatory compliance, leave this empty. To export specific regulatory compliance standards, enter a list of these standards names separated by semicolons (';'). Regulatory compliance standards names are available through the regulatory compliance standards API (https://docs.microsoft.com/rest/api/securitycenter/regulatorycompliancestandards), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/regulatorycompliancestandards.\",\"displayName\":\"Regulatory compliance standards names\"}},\"resourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource group location\",\"strongType\":\"location\"}},\"resourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource group name\"}},\"secureScoreControlsNames\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Applicable only for export of secure score controls. To export all secure score controls, leave this empty. To export specific secure score controls, enter a list of secure score controls IDs separated by semicolons (';'). Secure score controls IDs are available through the Secure score controls API (https://docs.microsoft.com/rest/api/securitycenter/securescorecontrols), or Azure Resource Graph Explorer, choose securityresources and microsoft.security/securescores/securescorecontrols.\",\"displayName\":\"Secure Score Controls IDs\"}},\"workspaceResourceId\":{\"type\":\"String\",\"metadata\":{\"assignPermissions\":true,\"description\":\"The Log Analytics workspace of where the data should be exported to.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"Microsoft.OperationalInsights/workspaces\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('resourceGroupName')]\",\"deployment\":{\"location\":\"westeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"alertSeverities\":{\"value\":\"[parameters('alertSeverities')]\"},\"createResourceGroup\":{\"value\":\"[parameters('createResourceGroup')]\"},\"exportedDataTypes\":{\"value\":\"[parameters('exportedDataTypes')]\"},\"isSecurityFindingsEnabled\":{\"value\":\"[parameters('isSecurityFindingsEnabled')]\"},\"recommendationNames\":{\"value\":\"[parameters('recommendationNames')]\"},\"recommendationSeverities\":{\"value\":\"[parameters('recommendationSeverities')]\"},\"regulatoryComplianceStandardsNames\":{\"value\":\"[parameters('regulatoryComplianceStandardsNames')]\"},\"resourceGroupLocation\":{\"value\":\"[parameters('resourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('resourceGroupName')]\"},\"secureScoreControlsNames\":{\"value\":\"[parameters('secureScoreControlsNames')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('workspaceResourceId')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"alertSeverities\":{\"type\":\"array\"},\"createResourceGroup\":{\"type\":\"bool\"},\"exportedDataTypes\":{\"type\":\"array\"},\"guidValue\":{\"defaultValue\":\"[newGuid()]\",\"type\":\"string\"},\"isSecurityFindingsEnabled\":{\"type\":\"bool\"},\"recommendationNames\":{\"type\":\"array\"},\"recommendationSeverities\":{\"type\":\"array\"},\"regulatoryComplianceStandardsNames\":{\"type\":\"array\"},\"resourceGroupLocation\":{\"type\":\"string\"},\"resourceGroupName\":{\"type\":\"string\"},\"secureScoreControlsNames\":{\"type\":\"array\"},\"workspaceResourceId\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"condition\":\"[parameters('createResourceGroup')]\",\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('resourceGroupName'))]\"],\"name\":\"[concat('nestedAutomationDeployment', '_', parameters('guidValue'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-01-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('resourceGroupLocation')]\",\"name\":\"ExportToWorkspace\",\"properties\":{\"actions\":[{\"actionType\":\"Workspace\",\"workspaceResourceId\":\"[parameters('workspaceResourceId')]\"}],\"description\":\"Export Microsoft Defender for Cloud data to Log Analytics workspace via policy\",\"isEnabled\":true,\"scopes\":[{\"description\":\"[replace(variables('scopeDescription'),'{0}', subscription().subscriptionId)]\",\"scopePath\":\"[subscription().id]\"}],\"sources\":\"[variables('sources')]\"},\"tags\":{},\"type\":\"Microsoft.Security/automations\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"alertSeveritiesLength\":\"[length(parameters('alertSeverities'))]\",\"alertSeveritiesLengthIfEmpty\":\"[if(equals(variables('alertSeveritiesLength'), 0), 1, variables('alertSeveritiesLength'))]\",\"alertSeverityMap\":{\"High\":\"high\",\"Low\":\"low\",\"Medium\":\"medium\"},\"customRuleSetsForRegulatoryComplianceObj\":{\"copy\":[{\"count\":\"[variables('regulatoryComplianceStandardsNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), parameters('regulatoryComplianceStandardsNames')[copyIndex('ruleSetsForRegulatoryCompliancArr')])]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForRegulatoryCompliancArr\"}]},\"customRuleSetsForSecureScoreControlsObj\":{\"copy\":[{\"count\":\"[variables('secureScoreControlsLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), parameters('secureScoreControlsNames')[copyIndex('ruleSetsForSecureScoreControlsArr')])]\",\"operator\":\"Equals\",\"propertyJPath\":\"name\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSecureScoreControlsArr\"}]},\"customRuleSetsForSubAssessmentsObj\":{\"copy\":[{\"count\":\"[variables('recommendationNamesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), replace(variables('subAssessmentRuleExpectedValue'),'{0}', parameters('recommendationNames')[copyIndex('ruleSetsForSubAssessmentsArr')]))]\",\"operator\":\"Contains\",\"propertyJPath\":\"id\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForSubAssessmentsArr\"}]},\"dataTypeMap\":{\"Overall secure score\":\"SecureScores\",\"Overall secure score - snapshot\":\"SecureScoresSnapshot\",\"Regulatory compliance\":\"RegulatoryComplianceAssessment\",\"Regulatory compliance - snapshot\":\"RegulatoryComplianceAssessmentSnapshot\",\"Secure score controls\":\"SecureScoreControls\",\"Secure score controls - snapshot\":\"SecureScoreControlsSnapshot\",\"Security alerts\":\"Alerts\",\"Security findings - snapshot\":\"SubAssessmentsSnapshot\",\"Security recommendations\":\"Assessments\",\"Security recommendations - snapshot\":\"AssessmentsSnapshot\"},\"exportedDataTypesLength\":\"[length(parameters('exportedDataTypes'))]\",\"exportedDataTypesLengthIfEmpty\":\"[if(equals(variables('exportedDataTypesLength'), 0), 1, variables('exportedDataTypesLength'))]\",\"recommendationNamesLength\":\"[length(parameters('recommendationNames'))]\",\"recommendationNamesLengthIfEmpty\":\"[if(equals(variables('recommendationNamesLength'), 0), 1, variables('recommendationNamesLength'))]\",\"recommendationSeveritiesLength\":\"[length(parameters('recommendationSeverities'))]\",\"recommendationSeveritiesLengthIfEmpty\":\"[if(equals(variables('recommendationSeveritiesLength'), 0), 1, variables('recommendationSeveritiesLength'))]\",\"regulatoryComplianceStandardsNamesLength\":\"[length(parameters('regulatoryComplianceStandardsNames'))]\",\"regulatoryComplianceStandardsNamesLengthIfEmpty\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), 1, variables('regulatoryComplianceStandardsNamesLength'))]\",\"ruleSetsForAlertsObj\":{\"copy\":[{\"count\":\"[variables('alertSeveritiesLengthIfEmpty')]\",\"input\":{\"rules\":[{\"expectedValue\":\"[variables('alertSeverityMap')[parameters('alertSeverities')[mod(copyIndex('ruleSetsForAlertsArr'),variables('alertSeveritiesLengthIfEmpty'))]]]\",\"operator\":\"Equals\",\"propertyJPath\":\"Severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAlertsArr\"}]},\"ruleSetsForAssessmentsObj\":{\"copy\":[{\"count\":\"[mul(variables('recommendationNamesLengthIfEmpty'),variables('recommendationSeveritiesLengthIfEmpty'))]\",\"input\":{\"rules\":[{\"expectedValue\":\"[if(equals(variables('recommendationNamesLength'),0),'Microsoft.Security/assessments',parameters('recommendationNames')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationName')),variables('recommendationNamesLength'))])]\",\"operator\":\"Contains\",\"propertyJPath\":\"[if(equals(variables('recommendationNamesLength'),0),'type','name')]\",\"propertyType\":\"string\"},{\"expectedValue\":\"[parameters('recommendationSeverities')[mod(div(copyIndex('ruleSetsForAssessmentsArr'),variables('totalRuleCombinationsForOneRecommendationSeverity')),variables('recommendationSeveritiesLength'))]]\",\"operator\":\"Equals\",\"propertyJPath\":\"properties.metadata.severity\",\"propertyType\":\"string\"}]},\"name\":\"ruleSetsForAssessmentsArr\"}]},\"ruleSetsForSecureRegulatoryComplianceObj\":\"[if(equals(variables('regulatoryComplianceStandardsNamesLength'), 0), json('null'), variables('customRuleSetsForRegulatoryComplianceObj').ruleSetsForRegulatoryCompliancArr)]\",\"ruleSetsForSecureScoreControlsObj\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), json('null'), variables('customRuleSetsForSecureScoreControlsObj').ruleSetsForSecureScoreControlsArr)]\",\"ruleSetsForSubAssessmentsObj\":\"[if(equals(variables('recommendationNamesLength'), 0), json('null'), variables('customRuleSetsForSubAssessmentsObj').ruleSetsForSubAssessmentsArr)]\",\"ruleSetsMap\":{\"Overall secure score\":null,\"Overall secure score - snapshot\":null,\"Regulatory compliance\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Regulatory compliance - snapshot\":\"[variables('ruleSetsForSecureRegulatoryComplianceObj')]\",\"Secure score controls\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Secure score controls - snapshot\":\"[variables('ruleSetsForSecureScoreControlsObj')]\",\"Security alerts\":\"[variables('ruleSetsForAlertsObj').ruleSetsForAlertsArr]\",\"Security findings - snapshot\":\"[variables('ruleSetsForSubAssessmentsObj')]\",\"Security recommendations\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\",\"Security recommendations - snapshot\":\"[variables('ruleSetsForAssessmentsObj').ruleSetsForAssessmentsArr]\"},\"scopeDescription\":\"scope for subscription {0}\",\"secureScoreControlsLengthIfEmpty\":\"[if(equals(variables('secureScoreControlsNamesLength'), 0), 1, variables('secureScoreControlsNamesLength'))]\",\"secureScoreControlsNamesLength\":\"[length(parameters('secureScoreControlsNames'))]\",\"sources\":\"[if(equals(parameters('isSecurityFindingsEnabled'),bool('true')),variables('sourcesWithSubAssessments'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithSubAssessments\":\"[concat(variables('subAssessmentSource'),variables('sourcesWithoutSubAssessments').sources)]\",\"sourcesWithoutSubAssessments\":{\"copy\":[{\"count\":\"[variables('exportedDataTypesLengthIfEmpty')]\",\"input\":{\"eventSource\":\"[variables('dataTypeMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\",\"ruleSets\":\"[variables('ruleSetsMap')[parameters('exportedDataTypes')[copyIndex('sources')]]]\"},\"name\":\"sources\"}]},\"subAssessmentRuleExpectedValue\":\"/assessments/{0}/\",\"subAssessmentSource\":[{\"eventSource\":\"SubAssessments\",\"ruleSets\":\"[variables('ruleSetsForSubAssessmentsObj')]\"}],\"totalRuleCombinationsForOneRecommendationName\":\"[variables('recommendationSeveritiesLengthIfEmpty')]\",\"totalRuleCombinationsForOneRecommendationSeverity\":1}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":true,\"field\":\"Microsoft.Security/automations/isEnabled\"},{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\"},\"equals\":\"[if(parameters('isSecurityFindingsEnabled'),add(length(parameters('exportedDataTypes')),1),length(parameters('exportedDataTypes')))]\"},{\"count\":{\"name\":\"dataType\",\"value\":\"[parameters('exportedDataTypes')]\",\"where\":{\"count\":{\"field\":\"Microsoft.Security/automations/sources[*]\",\"where\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Assessments\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"Alerts\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security alerts\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScores\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControls\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessment\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoresSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Overall secure score - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SecureScoreControlsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Secure score controls - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"RegulatoryComplianceAssessmentSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Regulatory compliance - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"AssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security recommendations - snapshot\",\"value\":\"[current('dataType')]\"}]},{\"allOf\":[{\"equals\":\"SubAssessmentsSnapshot\",\"field\":\"Microsoft.Security/automations/sources[*].eventSource\"},{\"equals\":\"Security findings - snapshot\",\"value\":\"[current('dataType')]\"}]}]}},\"equals\":1}},\"equals\":\"[length(parameters('exportedDataTypes'))]\"}]},\"existenceScope\":\"resourcegroup\",\"name\":\"ExportToWorkspace\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Security/automations\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "BuiltIn",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null,
            "type": "Microsoft.Authorization/policyDefinitions"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "data",
      "type": "azurerm_policy_set_definition",
      "name": "external_lookup",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMs with Azure Monitoring Agent(AMA)",
            "display_name": "Legacy - Enable Azure Monitor for VMs",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"2.0.1\"}",
            "name": "55f3eceb-5573-4f18-9695-226972c6d74a",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VM_Deploy"
              },
              {
                "parameter_values": "",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_HybridVM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VM_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VM_Deploy\"},{\"parameters\":{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VM_Deploy\"},{\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_HybridVM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VM_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        },
        {
          "index_key": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
          "schema_version": 0,
          "attributes": {
            "description": "Legacy - Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Use the new initiative named: Enable Azure Monitor for VMSS with Azure Monitoring Agent(AMA). Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Legacy - Enable Azure Monitor for Virtual Machine Scale Sets",
            "id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
            "management_group_name": null,
            "metadata": "{\"category\":\"Monitoring\",\"version\":\"1.0.2\"}",
            "name": "75714362-cae7-409e-9b99-a8e5075b7fad",
            "parameters": "{\"listOfImageIdToInclude_linux\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Linux OS to add to scope\"}},\"listOfImageIdToInclude_windows\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Example value: '/subscriptions/\\u003csubscriptionId\\u003e/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\",\"displayName\":\"Optional: List of VM images that have supported Windows OS to add to scope\"}},\"logAnalytics_1\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
                "policy_group_names": [],
                "reference_id": "LogAnalyticsExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Windows_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0",
                "policy_group_names": [],
                "reference_id": "DependencyAgentExtension_Linux_VMSS_Deploy"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138",
                "policy_group_names": [],
                "reference_id": "LogAnalytics_OSImage_VMSS_Audit"
              },
              {
                "parameter_values": "{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}}",
                "parameters": {},
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10",
                "policy_group_names": [],
                "reference_id": "DependencyAgent_OSImage_VMSS_Audit"
              }
            ],
            "policy_definitions": "[{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics_1')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\"policyDefinitionReferenceId\":\"LogAnalyticsExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Windows_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\"policyDefinitionReferenceId\":\"DependencyAgentExtension_Linux_VMSS_Deploy\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\"policyDefinitionReferenceId\":\"LogAnalytics_OSImage_VMSS_Audit\"},{\"parameters\":{\"listOfImageIdToInclude_linux\":{\"value\":\"[parameters('listOfImageIdToInclude_linux')]\"},\"listOfImageIdToInclude_windows\":{\"value\":\"[parameters('listOfImageIdToInclude_windows')]\"}},\"policyDefinitionId\":\"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\"policyDefinitionReferenceId\":\"DependencyAgent_OSImage_VMSS_Audit\"}]",
            "policy_type": "BuiltIn",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_automation_account",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_dns_zone",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_express_route_gateway",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall_policy",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_firewall_policy",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_linked_service",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_solution",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_log_analytics_workspace",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_1",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes",
          "schema_version": 0,
          "attributes": {
            "display_name": "VCF OBS CAF LZ Rover",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "name": "vcfes",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
            "subscription_ids": [
              "a9c7991e-521c-4532-93a9-5a37f82ccaed"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-root",
          "schema_version": 0,
          "attributes": {
            "display_name": "VCF OBS CAF LZ Rover",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-root",
            "name": "vcfes-root",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_2",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-decommissioned",
          "schema_version": 0,
          "attributes": {
            "display_name": "Decommissioned",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-decommissioned",
            "name": "vcfes-decommissioned",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
          "schema_version": 0,
          "attributes": {
            "display_name": "Landing Zones",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "name": "vcfes-landing-zones",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
          "schema_version": 0,
          "attributes": {
            "display_name": "Platform",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
            "name": "vcfes-platform",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-sandboxes",
          "schema_version": 0,
          "attributes": {
            "display_name": "Sandboxes",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-sandboxes",
            "name": "vcfes-sandboxes",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_3",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity",
          "schema_version": 0,
          "attributes": {
            "display_name": "Connectivity",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity",
            "name": "vcfes-connectivity",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-corp",
          "schema_version": 0,
          "attributes": {
            "display_name": "Corp",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-corp",
            "name": "vcfes-corp",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
          "schema_version": 0,
          "attributes": {
            "display_name": "Identity",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
            "name": "vcfes-identity",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-management",
          "schema_version": 0,
          "attributes": {
            "display_name": "Management",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-management",
            "name": "vcfes-management",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-platform",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-online",
          "schema_version": 0,
          "attributes": {
            "display_name": "Online",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
            "name": "vcfes-online",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_4",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-corp-non-prod",
          "schema_version": 0,
          "attributes": {
            "display_name": "Non Production",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-corp-non-prod",
            "name": "vcfes-corp-non-prod",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-corp",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-corp-prod",
          "schema_version": 0,
          "attributes": {
            "display_name": "Production",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-corp-prod",
            "name": "vcfes-corp-prod",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-corp",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-online-web",
          "schema_version": 0,
          "attributes": {
            "display_name": "Non Production",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-online-web",
            "name": "vcfes-online-web",
            "parent_management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
            "subscription_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_5",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group",
      "name": "level_6",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group_policy_assignment",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "e3dca87c-4eda-4839-89a8-ea94a494eb06",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:39.4016858Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enable-DDoS-VNET",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-ddos/providers/Microsoft.Network/ddosProtectionPlans/vcfes-ddos-francecentral\"},\"effect\":{\"value\":\"Modify\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies creation of Public IPs under the assigned scope.",
            "display_name": "Deny the creation of public IP",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Public-IP",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:34.9144803Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Public-IP",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows RDP access from Internet.",
            "display_name": "RDP access from the Internet should be blocked",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9300217Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-RDP-From-Internet",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
            "display_name": "Subnets should have a Network Security Group",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9429202Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Subnet-Without-Nsg",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"Deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "337397ea-629a-4e54-84ba-86f1b64a5aac",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:16.2916284Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Backup",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deployIfNotExists\"},\"exclusionTagName\":{\"value\":\"\"},\"exclusionTagValue\":{\"value\":[]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure's check of the source and destination for a network interface. This should be reviewed by the network security team.",
            "display_name": "Network interfaces should disable IP forwarding",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-IP-Forwarding",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9456782Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-IP-Forwarding",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow privileged containers creation in a Kubernetes cluster. This recommendation is part of CIS 5.2.1 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes cluster should not allow privileged containers",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Containers-AKS",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:35.0992108Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Priv-Containers-AKS",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS",
          "schema_version": 0,
          "attributes": {
            "description": "Do not allow containers to run with privilege escalation to root in a Kubernetes cluster. This recommendation is part of CIS 5.2.5 which is intended to improve the security of your Kubernetes environments. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For more information, see https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should not allow container privilege escalation",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Priv-Escalation-AKS",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:11.724707Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Priv-Escalation-AKS",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows RDP access from Internet.",
            "display_name": "RDP access from the Internet should be blocked",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-RDP-From-Internet",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9369267Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-RDP-From-Internet",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
            "display_name": "Secure transfer to storage accounts should be enabled",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Storage-http",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.918587Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Storage-http",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group to protect traffic across subnets.",
            "display_name": "Subnets should have a Network Security Group",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deny-Subnet-Without-Nsg",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9299613Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-Subnet-Without-Nsg",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
          "schema_version": 0,
          "attributes": {
            "description": "Use Azure Policy Add-on to manage and report on the compliance state of your Azure Kubernetes Service (AKS) clusters. For more information, see https://aka.ms/akspolicydoc.",
            "display_name": "Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "2670d7f6-ade2-4981-a7db-8b96887c805a",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:35.7856993Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-AKS-Policy",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing",
          "schema_version": 0,
          "attributes": {
            "description": "Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.",
            "display_name": "Auditing on SQL server should be enabled",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-DB-Auditing",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "8457a13d-58fe-491d-9e92-43304c7215f2",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:54.3246555Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-SQL-DB-Auditing",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
          "schema_version": 0,
          "attributes": {
            "description": "This policy ensures that Threat Detection is enabled on SQL Servers.",
            "display_name": "Deploy Threat Detection on SQL servers",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "95fd991f-4b44-4632-9956-ec717353044f",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:15.5739792Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-SQL-Threat",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce backup for all virtual machines by deploying a recovery services vault in the same location and resource group as the virtual machine. Doing this is useful when different application teams in your organization are allocated separate resource groups and need to manage their own backups and restores. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMAppCentricBackupExcludeTag.",
            "display_name": "Configure backup on virtual machines without a given tag to a new recovery services vault with a default policy",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "b41dd1e8-60ba-413d-8b9e-c730f7f66a8c",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:12.233736Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Backup",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/98d0b9f8-fd90-49c9-88e2-d3baf3b0dd86",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
          "schema_version": 0,
          "attributes": {
            "description": "Protect your virtual networks against volumetric and protocol attacks with Azure DDoS Protection Standard. For more information, visit https://aka.ms/ddosprotectiondocs.",
            "display_name": "Virtual networks should be protected by Azure DDoS Protection Standard",
            "enforce": false,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "e5e508e4-16f8-4917-8d92-736b1713b736",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:54.2619858Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enable-DDoS-VNET",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"ddosPlan\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-ddos/providers/Microsoft.Network/ddosProtectionPlans/vcfes-ddos-francecentral\"},\"effect\":{\"value\":\"Modify\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/94de2ad3-e0c1-4caf-ad78-5d47bbc83d3d",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc.",
            "display_name": "Kubernetes clusters should be accessible only over HTTPS",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-AKS-HTTPS",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:53.9152357Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-AKS-HTTPS",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"effect\":{\"value\":\"deny\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL",
          "schema_version": 0,
          "attributes": {
            "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing exsistense condition require then the combination of Audit.",
            "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "3187194f-5bd4-417f-ad65-e0249d4d9b9b",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:38.723724Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Enforce-TLS-SSL",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy-Log-Analytics.",
            "display_name": "Deploy-Log-Analytics",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "446ee1d3-e350-49d8-8959-063aa4d2869f",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-management",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:39.2609939Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-Log-Analytics",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"automationAccountName\":{\"value\":\"vcfes-automation\"},\"automationRegion\":{\"value\":\"francecentral\"},\"dataRetention\":{\"value\":\"30\"},\"effect\":{\"value\":\"DeployIfNotExists\"},\"rgName\":{\"value\":\"vcfes-mgmt\"},\"sku\":{\"value\":\"pergb2018\"},\"workspaceName\":{\"value\":\"vcfes-la\"},\"workspaceRegion\":{\"value\":\"francecentral\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e3e61b3-0b32-22d5-4edf-55f87fdb5955",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
          "schema_version": 0,
          "attributes": {
            "description": "Specifies the allowed locations (regions) where Resource Groups can be deployed.",
            "display_name": "Limit allowed locations for Resource Groups",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:13:48.3327302Z\",\"updatedBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"updatedOn\":\"2022-09-18T12:57:34.1976276Z\"}",
            "name": "Deny-RSG-Locations",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"francecentral\",\"francesouth\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations",
          "schema_version": 0,
          "attributes": {
            "description": "Specifies the allowed locations (regions) where Resources can be deployed.",
            "display_name": "Limit allowed locations for Resources",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-online/providers/Microsoft.Authorization/policyAssignments/Deny-Resource-Locations",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-online",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:13:48.3810603Z\",\"updatedBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"updatedOn\":\"2022-09-18T12:57:34.1904776Z\"}",
            "name": "Deny-Resource-Locations",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"francecentral\",\"francesouth\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
          "schema_version": 0,
          "attributes": {
            "description": "Specifies the allowed locations (regions) where Resource Groups can be deployed.",
            "display_name": "Limit allowed locations for Resource Groups",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyAssignments/Deny-RSG-Locations",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-root",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T14:24:39.2662673Z\",\"updatedBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"updatedOn\":\"2022-09-18T14:30:10.5036766Z\"}",
            "name": "Deny-RSG-Locations",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"eastus\",\"eastus2\",\"westus\",\"northcentralus\",\"southcentralus\",\"francecentral\",\"francesouth\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Monitoring in Azure Security Center.",
            "display_name": "Enable Monitoring in Azure Security Center",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-ASC-Monitoring",
            "identity": [],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:32.7113911Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-ASC-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"aadAuthenticationInSqlServerMonitoringEffect\":{\"value\":\"Disabled\"},\"diskEncryptionMonitoringEffect\":{\"value\":\"Disabled\"},\"encryptionOfAutomationAccountMonitoringEffect\":{\"value\":\"Disabled\"},\"identityDesignateLessThanOwnersMonitoringEffect\":{\"value\":\"Disabled\"},\"identityDesignateMoreThanOneOwnerMonitoringEffect\":{\"value\":\"Disabled\"},\"identityEnableMFAForWritePermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveDeprecatedAccountMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\":{\"value\":\"Disabled\"},\"jitNetworkAccessMonitoringEffect\":{\"value\":\"Disabled\"},\"networkSecurityGroupsOnSubnetsMonitoringEffect\":{\"value\":\"AuditIfNotExists\"},\"sqlDbEncryptionMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlServerAdvancedDataSecurityEmailAdminsMonitoringEffect\":{\"value\":\"Disabled\"},\"sqlServerAdvancedDataSecurityMonitoringEffect\":{\"value\":\"Disabled\"},\"systemUpdatesMonitoringEffect\":{\"value\":\"Disabled\"},\"useRbacRulesMonitoringEffect\":{\"value\":\"Disabled\"},\"vmssSystemUpdatesMonitoringEffect\":{\"value\":\"Disabled\"},\"windowsDefenderExploitGuardMonitoringEffect\":{\"value\":\"Disabled\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
          "schema_version": 0,
          "attributes": {
            "description": "Ensures that Activity Log Diagnostics settings are set to push logs into Log Analytics workspace.",
            "display_name": "Deploy Diagnostic Settings for Activity Log to Log Analytics workspace",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "d6e1bc35-0ca2-4548-960c-7e0fd459f27c",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:35.946828Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-AzActivity-Log",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-LX-Arc-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy-Linux-Arc-Monitoring.",
            "display_name": "Deploy-Linux-Arc-Monitoring",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-LX-Arc-Monitoring",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "326a98f6-e2ef-4a24-a680-4bfc73e4dd8a",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:14.0532074Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-LX-Arc-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud and Security Contacts",
            "display_name": "Deploy Microsoft Defender for Cloud configuration",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "d06972c8-86ed-4280-b446-1c6f06f7f49b",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:57:54.3150265Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-MDFC-Config",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"ascExportResourceGroupLocation\":{\"value\":\"francecentral\"},\"ascExportResourceGroupName\":{\"value\":\"vcfes-asc-export\"},\"emailSecurityContact\":{\"value\":\"security_contact@replace_me\"},\"enableAscForAppServices\":{\"value\":\"DeployIfNotExists\"},\"enableAscForArm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForContainers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForDns\":{\"value\":\"DeployIfNotExists\"},\"enableAscForKeyVault\":{\"value\":\"DeployIfNotExists\"},\"enableAscForOssDb\":{\"value\":\"DeployIfNotExists\"},\"enableAscForServers\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSql\":{\"value\":\"DeployIfNotExists\"},\"enableAscForSqlOnVm\":{\"value\":\"DeployIfNotExists\"},\"enableAscForStorage\":{\"value\":\"DeployIfNotExists\"},\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag",
          "schema_version": 0,
          "attributes": {
            "description": "Ensures that Azure resources are configured to forward diagnostic logs and metrics to an Azure Log Analytics workspace.",
            "display_name": "Deploy-Resource-Diag",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "149b5d6b-5dcf-4170-b8b6-068c64e65db1",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:13.8351139Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-Resource-Diag",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Monitor for the virtual machines (VMs) in the specified scope (management group, subscription or resource group). Takes Log Analytics workspace as parameter.",
            "display_name": "Enable Azure Monitor for VMs",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "5f378ab8-6e7a-4757-b8f0-a31145b39f55",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:38.0105742Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VM-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Enable Azure Monitor for the Virtual Machine Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.",
            "display_name": "Enable Azure Monitor for Virtual Machine Scale Sets",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "1f6143ea-79c0-4005-a2d6-670ec56d86e6",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T12:01:16.5153098Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-VMSS-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics_1\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-WS-Arc-Monitoring",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the Log Analytics agent to Windows Azure Arc machines if the agent isn't installed.",
            "display_name": "Deploy-Windows-Arc-Monitoring",
            "enforce": true,
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-WS-Arc-Monitoring",
            "identity": [
              {
                "identity_ids": [],
                "principal_id": "d446ce0e-2340-49e3-8e98-014320208b3e",
                "tenant_id": "482c21b6-ee9f-4d24-9bf0-6c9258fc2003",
                "type": "SystemAssigned"
              }
            ],
            "location": "francecentral",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:59:33.642278Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deploy-WS-Arc-Monitoring",
            "non_compliance_message": [],
            "not_scopes": [],
            "parameters": "{\"logAnalytics\":{\"value\":\"/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/vcfes-mgmt/providers/Microsoft.OperationalInsights/workspaces/vcfes-la\"}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_management_group_subscription_association",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_network_ddos_protection_plan",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/Enforce-RG-Tags",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce mandatory 'Owner' and 'Department' tags on Resource Groups",
            "display_name": "Resource groups must have mandatory tagging applied",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-root/providers/Microsoft.Authorization/policyDefinitions/Enforce-RG-Tags",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes-root",
            "metadata": "{\"category\":\"Tags\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T17:23:26.4812393Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Enforce-RG-Tags",
            "parameters": "{\"Department\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the Department that the Resource Group belongs to\",\"displayName\":\"Department\"}},\"Owner\":{\"type\":\"String\",\"metadata\":{\"description\":\"Specifies the Owner of the Resource Group'\",\"displayName\":\"Owner\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions/resourceGroups\",\"field\":\"type\"},{\"anyof\":[{\"exists\":\"false\",\"field\":\"[concat('tags[', parameters('Owner'), ']')]\"},{\"exists\":\"false\",\"field\":\"[concat('tags[', parameters('Department'), ']')]\"}]}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
          "schema_version": 0,
          "attributes": {
            "description": "Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.",
            "display_name": "AppService append enable https only setting to enforce https setting.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.6802249Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Append-AppService-httpsonly",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"notequals\":true}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/httpsOnly\",\"value\":true}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Append the AppService sites object to ensure that min Tls version is set to required minimum TLS version. Please note Append does not enforce compliance use then deny.",
            "display_name": "AppService append sites with minimum TLS version to enforce.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.3576005Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Append-AppService-latestTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"Select version minimum TLS Web App config\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites/config\",\"field\":\"type\"},{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"notEquals\":\"[parameters('minTlsVersion')]\"}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Web/sites/config/minTlsVersion\",\"value\":\"[parameters('minTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added.",
            "display_name": "KeyVault SoftDelete should be enabled",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Key Vault\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.5648353Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-KV-SoftDelete",
            "parameters": "",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.KeyVault/vaults\",\"field\":\"type\"},{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"notEquals\":true}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.KeyVault/vaults/enableSoftDelete\",\"value\":true}],\"effect\":\"append\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Cache for Redis Append and the enforcement that enableNonSslPort is disabled.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Cache\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.386986Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-Redis-disableNonSslPort",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\",\"Modify\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\",\"value\":false}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Append a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Cache for Redis Append a specific min TLS version requirement and enforce TLS.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Cache\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.8616813Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Append-Redis-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Cache for Redis\",\"displayName\":\"Effect Azure Cache for Redis\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Cache for Redis to enforce\",\"displayName\":\"Select version for Redis server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":[{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"value\":\"[parameters('minimumTlsVersion')]\"}],\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
          "schema_version": 0,
          "attributes": {
            "description": "Audit private endpoints that are created in other subscriptions and/or tenants for Azure Machine Learning.",
            "display_name": "Control private endpoint connections to Azure Machine Learning",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Audit-MachineLearning-PrivateEndpointId",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:19.0321205Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Audit-MachineLearning-PrivateEndpointId",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections\",\"field\":\"type\"},{\"equals\":\"Approved\",\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateLinkServiceConnectionState.status\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id\"},{\"notEquals\":\"[subscription().subscriptionId]\",\"value\":\"[split(concat(field('Microsoft.MachineLearningServices/workspaces/privateEndpointConnections/privateEndpoint.id'), '//'), '/')[2]]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of child resources on the Automation Account",
            "display_name": "No child resources in Automation Account",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Automation\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:49.8329248Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AA-child-resources",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"field\":\"type\",\"in\":[\"Microsoft.Automation/automationAccounts/runbooks\",\"Microsoft.Automation/automationAccounts/variables\",\"Microsoft.Automation/automationAccounts/modules\",\"Microsoft.Automation/automationAccounts/credentials\",\"Microsoft.Automation/automationAccounts/connections\",\"Microsoft.Automation/automationAccounts/certificates\"]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
          "schema_version": 0,
          "attributes": {
            "description": "This policy enables you to restrict that Application Gateways is always deployed with WAF enabled",
            "display_name": "Application Gateway should be deployed with WAF enabled",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.8818907Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppGW-Without-WAF",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/applicationGateways/sku.name\",\"notequals\":\"WAF_v2\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "API App should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:15.6067285Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceApiApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"*api\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "Function App should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:44.3702506Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceFunctionApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"functionapp*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
          "schema_version": 0,
          "attributes": {
            "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
            "display_name": "Web Application should only be accessible over HTTPS",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"App Service\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.9623788Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-AppServiceWebApp-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"field\":\"kind\",\"like\":\"app*\"},{\"equals\":\"false\",\"field\":\"Microsoft.Web/sites/httpsOnly\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
          "schema_version": 0,
          "attributes": {
            "description": "Denies the deployment of workspaces that do not use the noPublicIp feature to host Databricks clusters without public IPs.",
            "display_name": "Deny public IPs for Databricks cluster",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-NoPublicIp",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Databricks\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.8372514Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-NoPublicIp",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/parameters.enableNoPublicIp.value\",\"notEquals\":true}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of Premium Databricks workspaces to make sure appropriate security features are available including Databricks Access Controls, Credential Passthrough and SCIM provisioning for AAD.",
            "display_name": "Deny non-premium Databricks sku",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-Sku",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Databricks\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.35968Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-Sku",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.DataBricks/workspaces/sku.name\",\"notEquals\":\"premium\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces the use of vnet injection for Databricks workspaces.",
            "display_name": "Deny Databricks workspaces without Vnet injection",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Databricks-VirtualNetwork",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Databricks\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:10.9513932Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Databricks-VirtualNetwork",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customVirtualNetworkId.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPublicSubnetName.value\"},{\"exists\":false,\"field\":\"Microsoft.DataBricks/workspaces/parameters.customPrivateSubnetName.value\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
          "schema_version": 0,
          "attributes": {
            "description": "Deny AKS cluster creation in Azure Machine Learning and enforce connecting to existing clusters.",
            "display_name": "Deny AKS cluster creation in Azure Machine Learning",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Aks",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:49.6564916Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Aks",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AKS\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/resourceId\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/resourceId'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances.",
            "display_name": "Enforce subnet connectivity for Azure Machine Learning compute clusters and compute instances",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-SubnetId",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.8262253Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Compute-SubnetId",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/subnet.id\"},{\"equals\":true,\"value\":\"[empty(field('Microsoft.MachineLearningServices/workspaces/computes/subnet.id'))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
          "schema_version": 0,
          "attributes": {
            "description": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances.",
            "display_name": "Limit allowed vm sizes for Azure Machine Learning compute clusters and compute instances",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-Compute-VmSize",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Budget\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:48.2571454Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-Compute-VmSize",
            "parameters": "{\"allowedVmSizes\":{\"type\":\"Array\",\"defaultValue\":[\"Standard_D1_v2\",\"Standard_D2_v2\",\"Standard_D3_v2\",\"Standard_D4_v2\",\"Standard_D11_v2\",\"Standard_D12_v2\",\"Standard_D13_v2\",\"Standard_D14_v2\",\"Standard_DS1_v2\",\"Standard_DS2_v2\",\"Standard_DS3_v2\",\"Standard_DS4_v2\",\"Standard_DS5_v2\",\"Standard_DS11_v2\",\"Standard_DS12_v2\",\"Standard_DS13_v2\",\"Standard_DS14_v2\",\"Standard_M8-2ms\",\"Standard_M8-4ms\",\"Standard_M8ms\",\"Standard_M16-4ms\",\"Standard_M16-8ms\",\"Standard_M16ms\",\"Standard_M32-8ms\",\"Standard_M32-16ms\",\"Standard_M32ls\",\"Standard_M32ms\",\"Standard_M32ts\",\"Standard_M64-16ms\",\"Standard_M64-32ms\",\"Standard_M64ls\",\"Standard_M64ms\",\"Standard_M64s\",\"Standard_M128-32ms\",\"Standard_M128-64ms\",\"Standard_M128ms\",\"Standard_M128s\",\"Standard_M64\",\"Standard_M64m\",\"Standard_M128\",\"Standard_M128m\",\"Standard_D1\",\"Standard_D2\",\"Standard_D3\",\"Standard_D4\",\"Standard_D11\",\"Standard_D12\",\"Standard_D13\",\"Standard_D14\",\"Standard_DS15_v2\",\"Standard_NV6\",\"Standard_NV12\",\"Standard_NV24\",\"Standard_F2s_v2\",\"Standard_F4s_v2\",\"Standard_F8s_v2\",\"Standard_F16s_v2\",\"Standard_F32s_v2\",\"Standard_F64s_v2\",\"Standard_F72s_v2\",\"Standard_NC6s_v3\",\"Standard_NC12s_v3\",\"Standard_NC24rs_v3\",\"Standard_NC24s_v3\",\"Standard_NC6\",\"Standard_NC12\",\"Standard_NC24\",\"Standard_NC24r\",\"Standard_ND6s\",\"Standard_ND12s\",\"Standard_ND24rs\",\"Standard_ND24s\",\"Standard_NC6s_v2\",\"Standard_NC12s_v2\",\"Standard_NC24rs_v2\",\"Standard_NC24s_v2\",\"Standard_ND40rs_v2\",\"Standard_NV12s_v3\",\"Standard_NV24s_v3\",\"Standard_NV48s_v3\"],\"metadata\":{\"description\":\"Specifies the allowed VM Sizes for Aml Compute Clusters and Instances\",\"displayName\":\"Allowed VM Sizes for Aml Compute Clusters and Instances\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\",\"in\":[\"AmlCompute\",\"ComputeInstance\"]},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/vmSize\",\"notIn\":\"[parameters('allowedVmSizes')]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
          "schema_version": 0,
          "attributes": {
            "description": "Deny public access of Azure Machine Learning clusters via SSH.",
            "display_name": "Deny public access of Azure Machine Learning clusters via SSH",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:19.1383045Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deny-MachineLearning-ComputeCluster-RemoteLoginPortPublicAccess",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/remoteLoginPortPublicAccess\",\"notEquals\":\"Disabled\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
          "schema_version": 0,
          "attributes": {
            "description": "Enforce scale settings for Azure Machine Learning compute clusters.",
            "display_name": "Enforce scale settings for Azure Machine Learning compute clusters",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-ComputeCluster-Scale",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Budget\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:23.0919624Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-ComputeCluster-Scale",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"maxNodeCount\":{\"type\":\"Integer\",\"defaultValue\":10,\"metadata\":{\"description\":\"Specifies the maximum node count of AML Clusters\",\"displayName\":\"Maximum Node Count\"}},\"maxNodeIdleTimeInSecondsBeforeScaleDown\":{\"type\":\"Integer\",\"defaultValue\":900,\"metadata\":{\"description\":\"Specifies the maximum node idle time in seconds before scaledown\",\"displayName\":\"Maximum Node Idle Time in Seconds Before Scaledown\"}},\"minNodeCount\":{\"type\":\"Integer\",\"defaultValue\":0,\"metadata\":{\"description\":\"Specifies the minimum node count of AML Clusters\",\"displayName\":\"Minimum Node Count\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces/computes\",\"field\":\"type\"},{\"equals\":\"AmlCompute\",\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/computeType\"},{\"anyOf\":[{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.maxNodeCount\",\"greater\":\"[parameters('maxNodeCount')]\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.minNodeCount\",\"greater\":\"[parameters('minNodeCount')]\"},{\"greater\":\"[parameters('maxNodeIdleTimeInSecondsBeforeScaleDown')]\",\"value\":\"[int(last(split(replace(replace(replace(replace(replace(replace(replace(field('Microsoft.MachineLearningServices/workspaces/computes/scaleSettings.nodeIdleTimeBeforeScaleDown'), 'P', '/'), 'Y', '/'), 'M', '/'), 'D', '/'), 'T', '/'), 'H', '/'), 'S', ''), '/')))]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Enforces high business impact Azure Machine Learning workspaces.",
            "display_name": "Enforces high business impact Azure Machine Learning Workspaces",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-HbiWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:38.4018458Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-HbiWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/hbiWorkspace\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
          "schema_version": 0,
          "attributes": {
            "description": "Deny public access behind vnet to Azure Machine Learning workspaces.",
            "display_name": "Deny public acces behind vnet to Azure Machine Learning workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.3880305Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-PublicAccessWhenBehindVnet",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":false,\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/allowPublicAccessWhenBehindVnet\",\"notEquals\":false}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
          "schema_version": 0,
          "attributes": {
            "description": "Denies public network access for Azure Machine Learning workspaces.",
            "display_name": "Azure Machine Learning should have disabled public network access",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MachineLearning-PublicNetworkAccess",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Machine Learning\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.9777722Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MachineLearning-PublicNetworkAccess",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},{\"field\":\"Microsoft.MachineLearningServices/workspaces/publicNetworkAccess\",\"notEquals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "MySQL database servers enforce SSL connections.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.4004421Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-MySql-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
          "schema_version": 0,
          "attributes": {
            "description": "Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "PostgreSQL database servers enforce SSL connection.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.3184857Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "Deny-PostgreSql-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription",
            "display_name": "Deny the creation of private DNS",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.0947279Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Private-DNS-Zones",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/privateDnsZones\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of Maria DB accounts with exposed public endpoints",
            "display_name": "Public network access should be disabled for MariaDB",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.7674958Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-PublicEndpoint-MariaDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.DBforMariaDB/servers/publicNetworkAccess\",\"notequals\":\"Disabled\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies creation of Public IPs under the assigned scope.",
            "display_name": "Deny the creation of public IP",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.3577568Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-PublicIP",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/publicIPAddresses\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies any network security rule that allows RDP access from Internet",
            "display_name": "RDP access from the Internet should be blocked",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:46.8470894Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-RDP-From-Internet",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups/securityRules\",\"field\":\"type\"},{\"allOf\":[{\"equals\":\"Allow\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/access\"},{\"equals\":\"Inbound\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/direction\"},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"3389\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\"},{\"equals\":\"true\",\"value\":\"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]\"},{\"count\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"where\":{\"equals\":\"true\",\"value\":\"[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]\"}},\"greater\":0},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\"notEquals\":\"3389\"}}]},{\"anyOf\":[{\"equals\":\"*\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"equals\":\"Internet\",\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\"},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"*\"}},{\"not\":{\"field\":\"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\"notEquals\":\"Internet\"}}]}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
          "schema_version": 0,
          "attributes": {
            "description": "Audit enabling of only connections via SSL to Azure Cache for Redis. Validate both minimum TLS version and enableNonSslPort is disabled. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Azure Cache for Redis only secure connections should be enabled",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Cache\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.1264631Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Redis-http",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select minimum TLS version for Azure Cache for Redis.\",\"displayName\":\"Select minumum TLS version for Azure Cache for Redis.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},{\"anyOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Cache/Redis/enableNonSslPort\"},{\"field\":\"Microsoft.Cache/Redis/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
            "display_name": "Azure SQL Database should have the minimal TLS version set to the highest version",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.1457915Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Sql-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not reccomended since they have well documented security vunerabilities.",
            "display_name": "SQL Managed Instance should have the minimal TLS version set to the highest version",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.9538002Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-SqlMi-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking",
            "display_name": "Storage Account set to minimum TLS and Secure transfer should be enabled",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Storage\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.6806057Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deny-Storage-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"The effect determines what happens when the policy rule is evaluated to match\",\"displayName\":\"Effect\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"allOf\":[{\"less\":\"2019-04-01\",\"value\":\"[requestContext().apiVersion]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"}]},{\"equals\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notequals\":\"[parameters('minimumTlsVersion')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a Network Security Group. NSG help to protect traffic across subnet-level.",
            "display_name": "Subnets should have a Network Security Group",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.6447517Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "Deny-Subnet-Without-Nsg",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"GatewaySubnet\",\"AzureFirewallSubnet\",\"AzureFirewallManagementSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of a subnet without a User Defined Route (UDR).",
            "display_name": "Subnets should have a User Defined Route",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Udr",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:19.2955445Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"2.0.0\"}",
            "mode": "All",
            "name": "Deny-Subnet-Without-Udr",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"excludedSubnets\":{\"type\":\"Array\",\"defaultValue\":[\"AzureBastionSubnet\"],\"metadata\":{\"description\":\"Array of subnet names that are excluded from this policy\",\"displayName\":\"Excluded Subnets\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"count\":{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*]\",\"where\":{\"allOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].routeTable.id\"},{\"field\":\"Microsoft.Network/virtualNetworks/subnets[*].name\",\"notIn\":\"[parameters('excludedSubnets')]\"}]}},\"notEquals\":0}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/subnets\",\"field\":\"type\"},{\"field\":\"name\",\"notIn\":\"[parameters('excludedSubnets')]\"},{\"exists\":\"false\",\"field\":\"Microsoft.Network/virtualNetworks/subnets/routeTable.id\"}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings outside of the same subscriptions under the assigned scope.",
            "display_name": "Deny vNet peering cross subscription.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peer-Cross-Sub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.5187856Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deny-VNET-Peer-Cross-Sub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"notcontains\":\"[subscription().id]\"}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings to non-approved vNets under the assigned scope.",
            "display_name": "Deny vNet peering to non-approved vNets",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNET-Peering-To-Non-Approved-VNETs",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:41.0036627Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deny-VNET-Peering-To-Non-Approved-VNETs",
            "parameters": "{\"allowedVnets\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Array of allowed vNets that can be peered with. Must be entered using their resource ID. Example: /subscriptions/{subId}/resourceGroups/{resourceGroupName}/providers/Microsoft.Network/virtualNetworks/{vnetName}\",\"displayName\":\"Allowed vNets to peer with\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"anyOf\":[{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings/remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}}]},{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"not\":{\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\",\"in\":\"[parameters('allowedVnets')]\"}},{\"not\":{\"exists\":false,\"field\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings[*].remoteVirtualNetwork.id\"}}]}]},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of vNet Peerings under the assigned scope.",
            "display_name": "Deny vNet peering ",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-VNet-Peering",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:17.7260765Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "All",
            "name": "Deny-VNet-Peering",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\",\"field\":\"type\"},\"then\":{\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Azure Security Center Security Contacts",
            "display_name": "Deploy Azure Security Center Security Contacts",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Security Center\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.3985266Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deploy-ASC-SecurityContacts",
            "parameters": "{\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Azure Security Center contact details\",\"displayName\":\"Security contacts email address\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"emailSecurityContact\":{\"metadata\":{\"description\":\"Security contacts email address\"},\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2020-01-01-preview\",\"name\":\"default\",\"properties\":{\"alertNotifications\":{\"minimalSeverity\":\"High\",\"state\":\"On\"},\"emails\":\"[parameters('emailSecurityContact')]\",\"notificationsByRole\":{\"roles\":[\"Owner\"],\"state\":\"On\"}},\"type\":\"Microsoft.Security/securityContacts\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"contains\":\"[parameters('emailSecurityContact')]\",\"field\":\"Microsoft.Security/securityContacts/email\"},{\"equals\":\"Microsoft.Security/securityContacts\",\"field\":\"type\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertNotifications\"},{\"equals\":\"On\",\"field\":\"Microsoft.Security/securityContacts/alertsToAdmins\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"],\"type\":\"Microsoft.Security/securityContacts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a default budget on all subscriptions under the assigned scope",
            "display_name": "Deploy a default budget on all subscriptions under the assigned scope",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Budget\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.3816051Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-Budget",
            "parameters": "{\"amount\":{\"type\":\"String\",\"defaultValue\":\"1000\",\"metadata\":{\"description\":\"The total amount of cost or usage to track with the budget\"}},\"budgetName\":{\"type\":\"String\",\"defaultValue\":\"budget-set-by-policy\",\"metadata\":{\"description\":\"The name for the budget to be created\"}},\"contactEmails\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"contactGroups\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.\"}},\"contactRoles\":{\"type\":\"Array\",\"defaultValue\":[\"Owner\",\"Contributor\"],\"metadata\":{\"description\":\"The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\"}},\"firstThreshold\":{\"type\":\"String\",\"defaultValue\":\"90\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"secondThreshold\":{\"type\":\"String\",\"defaultValue\":\"100\",\"metadata\":{\"description\":\"Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.\"}},\"timeGrain\":{\"type\":\"String\",\"allowedValues\":[\"Monthly\",\"Quarterly\",\"Annually\",\"BillingMonth\",\"BillingQuarter\",\"BillingAnnual\"],\"defaultValue\":\"Monthly\",\"metadata\":{\"description\":\"The time covered by a budget. Tracking of the amount will be reset based on the time grain.\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"amount\":{\"value\":\"[parameters('amount')]\"},\"budgetName\":{\"value\":\"[parameters('budgetName')]\"},\"contactEmails\":{\"value\":\"[parameters('contactEmails')]\"},\"contactGroups\":{\"value\":\"[parameters('contactGroups')]\"},\"contactRoles\":{\"value\":\"[parameters('contactRoles')]\"},\"firstThreshold\":{\"value\":\"[parameters('firstThreshold')]\"},\"secondThreshold\":{\"value\":\"[parameters('secondThreshold')]\"},\"timeGrain\":{\"value\":\"[parameters('timeGrain')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"amount\":{\"type\":\"String\"},\"budgetName\":{\"type\":\"String\"},\"contactEmails\":{\"type\":\"Array\"},\"contactGroups\":{\"type\":\"Array\"},\"contactRoles\":{\"type\":\"Array\"},\"firstThreshold\":{\"type\":\"String\"},\"secondThreshold\":{\"type\":\"String\"},\"startDate\":{\"defaultValue\":\"[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]\",\"type\":\"String\"},\"timeGrain\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[parameters('budgetName')]\",\"properties\":{\"amount\":\"[parameters('amount')]\",\"category\":\"Cost\",\"notifications\":{\"NotificationForExceededBudget1\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('firstThreshold')]\"},\"NotificationForExceededBudget2\":{\"contactEmails\":\"[parameters('contactEmails')]\",\"contactGroups\":\"[parameters('contactGroups')]\",\"contactRoles\":\"[parameters('contactRoles')]\",\"enabled\":true,\"operator\":\"GreaterThan\",\"threshold\":\"[parameters('secondThreshold')]\"}},\"timeGrain\":\"[parameters('timeGrain')]\",\"timePeriod\":{\"startDate\":\"[parameters('startDate')]\"}},\"type\":\"Microsoft.Consumption/budgets\"}]}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('amount')]\",\"field\":\"Microsoft.Consumption/budgets/amount\"},{\"equals\":\"[parameters('timeGrain')]\",\"field\":\"Microsoft.Consumption/budgets/timeGrain\"},{\"equals\":\"Cost\",\"field\":\"Microsoft.Consumption/budgets/category\"}]},\"existenceScope\":\"subscription\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Consumption/budgets\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys a route table with specific user defined routes when one does not exist. The route table deployed by the policy must be manually associated to subnet(s)",
            "display_name": "Deploy a route table with specific user defined routes",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Custom-Route-Table",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:41.8461111Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Custom-Route-Table",
            "parameters": "{\"disableBgpPropagation\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Disable BGP Propagation\",\"displayName\":\"DisableBgpPropagation\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"requiredRoutes\":{\"type\":\"Array\",\"metadata\":{\"description\":\"Routes that must exist in compliant route tables deployed by this policy\",\"displayName\":\"requiredRoutes\"}},\"routeTableName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the route table automatically deployed by this policy\",\"displayName\":\"routeTableName\"}},\"vnetRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Only VNets in this region will be evaluated against this policy\",\"displayName\":\"vnetRegion\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},{\"equals\":\"[parameters('vnetRegion')]\",\"field\":\"location\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"name\":\"routeTableDepl\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"disableBgpPropagation\":{\"value\":\"[parameters('disableBgpPropagation')]\"},\"requiredRoutes\":{\"value\":\"[parameters('requiredRoutes')]\"},\"routeTableName\":{\"value\":\"[parameters('routeTableName')]\"},\"vnetRegion\":{\"value\":\"[parameters('vnetRegion')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"parameters\":{\"disableBgpPropagation\":{\"type\":\"bool\"},\"requiredRoutes\":{\"type\":\"array\"},\"routeTableName\":{\"type\":\"string\"},\"vnetRegion\":{\"type\":\"string\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"location\":\"[[parameters('vnetRegion')]\",\"name\":\"[[parameters('routeTableName')]\",\"properties\":{\"copy\":\"[variables('copyLoop')]\",\"disableBgpRoutePropagation\":\"[[parameters('disableBgpPropagation')]\"},\"type\":\"Microsoft.Network/routeTables\"}]}},\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"copyLoop\":[{\"count\":\"[[length(parameters('requiredRoutes'))]\",\"input\":{\"name\":\"[[concat('route-',copyIndex('routes'))]\",\"properties\":{\"addressPrefix\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[0]]\",\"nextHopIpAddress\":\"[[if(equals(toLower(split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]),'virtualappliance'),split(parameters('requiredRoutes')[copyIndex('routes')], ';')[2], null())]\",\"nextHopType\":\"[[split(parameters('requiredRoutes')[copyIndex('routes')], ';')[1]]\"}},\"name\":\"routes\"}]}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('routeTableName')]\",\"field\":\"name\"},{\"count\":{\"field\":\"Microsoft.Network/routeTables/routes[*]\",\"where\":{\"in\":\"[parameters('requiredRoutes')]\",\"value\":\"[concat(current('Microsoft.Network/routeTables/routes[*].addressPrefix'), ';', current('Microsoft.Network/routeTables/routes[*].nextHopType'), if(equals(toLower(current('Microsoft.Network/routeTables/routes[*].nextHopType')),'virtualappliance'), concat(';', current('Microsoft.Network/routeTables/routes[*].nextHopIpAddress')), ''))]\"}},\"equals\":\"[length(parameters('requiredRoutes'))]\"}]},\"roleDefinitionIds\":[\"/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/routeTables\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/subscriptions/e867a45d-e513-44ac-931e-4741cef80b24/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys an Azure DDoS Protection Standard plan",
            "display_name": "Deploy an Azure DDoS Protection Standard plan",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.2277031Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deploy-DDoSProtection",
            "parameters": "{\"ddosName\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet\",\"displayName\":\"ddosName\"}},\"ddosRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"DDoSVnet location\",\"displayName\":\"ddosRegion\",\"strongType\":\"location\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"ddosname\":{\"value\":\"[parameters('ddosname')]\"},\"ddosregion\":{\"value\":\"[parameters('ddosRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"ddosRegion\":{\"type\":\"String\"},\"ddosname\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"ddosprotection\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-12-01\",\"location\":\"[parameters('ddosRegion')]\",\"name\":\"[parameters('ddosName')]\",\"properties\":{},\"type\":\"Microsoft.Network/ddosProtectionPlans\"}]}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('ddosName')]\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"],\"type\":\"Microsoft.Network/ddosProtectionPlans\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Automation to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.6321248Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AA",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Automation/automationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"JobLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobStreams\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DscNodeStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AuditEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Automation/automationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.",
            "display_name": "Deploy Diagnostic Settings for Container Instances to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.7066742Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ACI",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerInstance/containerGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.",
            "display_name": "Deploy Diagnostic Settings for Container Registry to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:17.3817881Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ACR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ContainerRegistry/registries\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ContainerRegistryLoginEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ContainerRegistryRepositoryEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ContainerRegistry/registries/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for API Management to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:12.9028486Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-APIMgmt",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.ApiManagement/service\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"WebSocketConnectionLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.ApiManagement/service/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any Scaling Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.629783Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AVDScalingPlans",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/scalingplans\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Autoscale\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/scalingplans/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:39.7548507Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-AnalysisService",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.AnalysisServices/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Service\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.AnalysisServices/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.3297396Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ApiForFHIR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HealthcareApis/services\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HealthcareApis/services/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.4199431Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ApplicationGateway",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/applicationGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ApplicationGatewayAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayPerformanceLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ApplicationGatewayFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/applicationGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Azure Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.741446Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Bastion",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/bastionHosts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"BastionAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/bastionHosts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:48.9461895Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CDNEndpoints",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cdn/profiles/endpoints\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"CoreAnalytics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.7971105Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CognitiveServices",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.CognitiveServices/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RequestResponse\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Trace\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.CognitiveServices/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:46.7942035Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-CosmosDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DocumentDB/databaseAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DataPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MongoRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PartitionKeyRUConsumption\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ControlPlaneRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"CassandraRequests\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"GremlinRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"Requests\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:12.123882Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DLAnalytics",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataLakeAnalytics/accounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Audit\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Requests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.4682663Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DataExplorerCluster",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Kusto/Clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"SucceededIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FailedIngestion\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IngestionBatching\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Command\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Query\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableUsageStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TableDetails\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Kusto/Clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Data Factory to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.38409Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-DataFactory",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DataFactory/factories\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ActivityRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TriggerRuns\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessages\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutableStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageEventMessageContext\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionComponentPhases\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISPackageExecutionDataStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SSISIntegrationRuntimeLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DataFactory/factories/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Databricks to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.408338Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Databricks",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Databricks/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"dbfs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"clusters\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"accounts\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"jobs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"notebook\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ssh\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"workspace\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"secrets\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"sqlPermissions\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"instancePools\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Databricks/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.506137Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridSub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/eventSubscriptions\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.3064026Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridSystemTopic",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/systemTopics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/systemTopics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.2439406Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-EventGridTopic",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.EventGrid/topics\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"DeliveryFailures\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PublishFailures\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.EventGrid/topics/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:10.7332986Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-ExpressRoute",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/expressRouteCircuits\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PeeringRouteLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Firewall to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.9949713Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Firewall",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/azureFirewalls\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AzureFirewallApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AzureFirewallDnsProxy\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRule\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWThreatIntel\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWIdpsSignature\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWDnsQuery\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWFqdnResolveFailure\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWApplicationRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNetworkRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AZFWNatRuleAggregation\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/azureFirewalls/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Front Door to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.7688138Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-FrontDoor",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/frontDoors\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FrontdoorAccessLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FrontdoorWebApplicationFirewallLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/frontDoors/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:45.6236795Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Function",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"contains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"FunctionAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for HDInsight to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:42.1790743Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-HDInsight",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.HDInsight/clusters\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.HDInsight/clusters/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.7485976Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LoadBalancer",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/loadBalancers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"LoadBalancerAlertEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"LoadBalancerProbeHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/loadBalancers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:41:40.362251Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-LogicAppsISE",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Logic/integrationAccounts\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"IntegrationAccountTrackingEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Logic/integrationAccounts/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for MariaDB to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:46.6843839Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MariaDB",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMariaDB/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMariaDB/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.7993494Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MediaService",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Media/mediaServices\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"KeyDeliveryRequests\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Media/mediaServices/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.398413Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MlWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.MachineLearningServices/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AmlComputeClusterEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeClusterNodeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeJobEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlComputeCpuGpuUtilization\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AmlRunStatusChangedEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ModelsActionEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeploymentEventAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationAKS\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"InferencingOperationACI\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataLabelReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"ComputeInstanceEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataStoreReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DataSetReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"PipelineReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RunReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentChangeEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"EnvironmentReadEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.4861736Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-MySQL",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"MySqlSlowLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"MySqlAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforMySQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:20.1915252Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-NIC",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkInterfaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkInterfaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:51.5400816Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-NetworkSecurityGroups",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"NetworkSecurityGroupEvent\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkSecurityGroupRuleCounter\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:15.1640565Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-PostgreSQL",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"PostgreSQLLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreRuntimeStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"QueryStoreWaitStatistics\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:10.9079465Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-PowerBIEmbedded",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.PowerBIDedicated/capacities\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Engine\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.0067075Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-RedisCache",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Cache/redis\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Cache/redis/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Relay to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:37.3947246Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Relay",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Relay/namespaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"HybridConnectionsEvent\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Relay/namespaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.6093617Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SQLElasticPools",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/elasticPools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('fullName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.0106559Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SQLMI",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ResourceUsageStats\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SQLSecurityAuditEvents\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DevOpsOperationsAudit\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Sql/managedInstances/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for SignalR to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.4170944Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-SignalR",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.SignalRService/SignalR\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AllLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.SignalRService/SignalR/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:50.03583Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-TimeSeriesInsights",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.TimeSeriesInsights/environments\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Ingress\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.9033275Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-TrafficManager",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/trafficManagerProfiles\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"ProbeHealthStatusEvents\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:09.5667077Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VM",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachines/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:14.3930062Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VMSS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Compute/virtualMachineScaleSets\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.",
            "display_name": "Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:50.1043775Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VNetGW",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworkGateways\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"GatewayDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"IKEDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"P2SDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"RouteDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TunnelDiagnosticLog\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:14.2509008Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-VirtualNetwork",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Network/virtualNetworks\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"VMProtectionAlerts\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false}}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Network/virtualNetworks/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Application group to stream to a Log Analytics workspace when any application group which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Application group to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.9179339Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDAppGroup",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/applicationGroups\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/applicationGroups/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Host Pools to stream to a Log Analytics workspace when any Host Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Host Pools to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:46.2521086Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDHostPools",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/hostpools\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Connection\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"HostRegistration\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AgentHealthStatus\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"NetworkData\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"SessionHostManagement\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/hostpools/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all and categorys enabled.",
            "display_name": "Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.2759449Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.1\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WVDWorkspace",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.DesktopVirtualization/workspaces\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Checkpoint\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Error\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Management\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Feed\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.DesktopVirtualization/workspaces/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:15.408111Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-WebServerFarm",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Web/serverfarms\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/serverfarms/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for App Service to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:38:38.3473793Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-Website",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Web/sites\",\"field\":\"type\"},{\"notContains\":\"functionapp\",\"value\":\"[field('kind')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"AppServiceAntivirusScanAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceConsoleLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceHTTPLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAppLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceFileAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServiceIPSecAuditLogs\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"AppServicePlatformLogs\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Web/sites/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled",
            "display_name": "Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.926626Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Diagnostics-iotHub",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"logsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable logs stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable logs\"}},\"metricsEnabled\":{\"type\":\"String\",\"allowedValues\":[\"True\",\"False\"],\"defaultValue\":\"True\",\"metadata\":{\"description\":\"Whether to enable metrics stream to the Log Analytics workspace - True or False\",\"displayName\":\"Enable metrics\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Devices/IotHubs\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"logsEnabled\":{\"value\":\"[parameters('logsEnabled')]\"},\"metricsEnabled\":{\"value\":\"[parameters('metricsEnabled')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"logAnalytics\":{\"type\":\"String\"},\"logsEnabled\":{\"type\":\"String\"},\"metricsEnabled\":{\"type\":\"String\"},\"profileName\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-05-01-preview\",\"dependsOn\":[],\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\"properties\":{\"logs\":[{\"category\":\"Connections\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceTelemetry\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DCommands\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceIdentityOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"FileUploadOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Routes\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"D2CTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"C2DTwinOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"TwinQueries\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"JobsOperations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DirectMethods\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DistributedTracing\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"Configurations\",\"enabled\":\"[parameters('logsEnabled')]\"},{\"category\":\"DeviceStreams\",\"enabled\":\"[parameters('logsEnabled')]\"}],\"metrics\":[{\"category\":\"AllMetrics\",\"enabled\":\"[parameters('metricsEnabled')]\",\"retentionPolicy\":{\"days\":0,\"enabled\":false},\"timeGrain\":null}],\"workspaceId\":\"[parameters('logAnalytics')]\"},\"type\":\"Microsoft.Devices/IotHubs/providers/diagnosticSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/logs.enabled\"},{\"equals\":\"true\",\"field\":\"Microsoft.Insights/diagnosticSettings/metrics.enabled\"},{\"equals\":\"[parameters('logAnalytics')]\",\"field\":\"Microsoft.Insights/diagnosticSettings/workspaceId\"}]},\"name\":\"setByPolicy\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"],\"type\":\"Microsoft.Insights/diagnosticSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
              "/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys Azure Firewall Manager policy in subscription where the policy is assigned.",
            "display_name": "Deploy Azure Firewall Manager policy in the subscription",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:52:18.7521354Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "Deploy-FirewallPolicy",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"fwPolicyRegion\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Azure region for Azure Firewall Policy\",\"displayName\":\"fwPolicyRegion\",\"strongType\":\"location\"}},\"fwpolicy\":{\"type\":\"Object\",\"defaultValue\":{},\"metadata\":{\"description\":\"Object describing Azure Firewall Policy\",\"displayName\":\"fwpolicy\"}},\"rgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Provide name for resource group.\",\"displayName\":\"rgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"fwPolicy\":{\"value\":\"[parameters('fwPolicy')]\"},\"fwPolicyRegion\":{\"value\":\"[parameters('fwPolicyRegion')]\"},\"rgName\":{\"value\":\"[parameters('rgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"fwPolicy\":{\"type\":\"object\"},\"fwPolicyRegion\":{\"type\":\"String\"},\"rgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-05-01\",\"location\":\"[deployment().location]\",\"name\":\"[parameters('rgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"},{\"apiVersion\":\"2018-05-01\",\"dependsOn\":[\"[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]\"],\"name\":\"fwpolicies\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[],\"location\":\"[parameters('fwpolicy').location]\",\"name\":\"[parameters('fwpolicy').firewallPolicyName]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-09-01\",\"dependsOn\":[\"[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]\"],\"name\":\"[parameters('fwpolicy').ruleGroups.name]\",\"properties\":{\"priority\":\"[parameters('fwpolicy').ruleGroups.properties.priority]\",\"rules\":\"[parameters('fwpolicy').ruleGroups.properties.rules]\"},\"type\":\"ruleGroups\"}],\"tags\":{},\"type\":\"Microsoft.Network/firewallPolicies\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('rgName')]\",\"type\":\"Microsoft.Resources/deployments\"}]}}},\"deploymentScope\":\"subscription\",\"existenceScope\":\"resourceGroup\",\"resourceGroupName\":\"[parameters('rgName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/firewallPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Database for MySQL server deploy a specific min TLS version and enforce SSL.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:53:49.9404431Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-MySQL-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for MySQL server\",\"displayName\":\"Effect minimum TLS version Azure Database for MySQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"Select version minimum TLS for MySQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforMySQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforMySQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforMySQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforMySQL/servers/minimalTlsVersion\"}]},\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforMySQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys NSG flow logs and traffic analytics to Log Analytics with a specfied retention period.",
            "display_name": "Deploys NSG flow logs and traffic analytics to Log Analytics",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs-to-LA",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.9974683Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Nsg-FlowLogs-to-LA",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"interval\":{\"type\":\"Integer\",\"defaultValue\":60,\"metadata\":{\"displayName\":\"Traffic Analytics processing interval mins (10/60)\"}},\"retention\":{\"type\":\"Integer\",\"defaultValue\":5,\"metadata\":{\"displayName\":\"Retention\"}},\"workspace\":{\"type\":\"String\",\"defaultValue\":\"\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Resource ID of Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Network/networkSecurityGroups\",\"field\":\"type\"}]},\"then\":{\"details\":{\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"interval\":{\"value\":\"[parameters('interval')]\"},\"location\":{\"value\":\"[field('location')]\"},\"networkSecurityGroup\":{\"value\":\"[field('id')]\"},\"retention\":{\"value\":\"[parameters('retention')]\"},\"workspace\":{\"value\":\"[parameters('workspace')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"interval\":{\"type\":\"int\"},\"location\":{\"type\":\"String\"},\"networkSecurityGroup\":{\"type\":\"String\"},\"retention\":{\"type\":\"int\"},\"time\":{\"defaultValue\":\"[utcNow()]\",\"type\":\"String\"},\"workspace\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-10-01\",\"name\":\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2019-06-01\",\"kind\":\"StorageV2\",\"location\":\"[parameters('location')]\",\"name\":\"[variables('storageAccountName')]\",\"properties\":{},\"sku\":{\"name\":\"Standard_LRS\",\"tier\":\"Standard\"},\"type\":\"Microsoft.Storage/storageAccounts\"}]}},\"resourceGroup\":\"[variables('resourceGroupName')]\",\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2019-10-01\",\"dependsOn\":[\"[concat(variables('resourceGroupName'), '.', variables('securityGroupName'))]\"],\"name\":\"[concat('NetworkWatcherRG', '.', variables('securityGroupName'))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"resources\":[{\"apiVersion\":\"2020-05-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat('NetworkWatcher_', toLower(parameters('location')))]\",\"properties\":{},\"resources\":[{\"apiVersion\":\"2019-11-01\",\"dependsOn\":[\"[concat('NetworkWatcher_', toLower(parameters('location')))]\"],\"location\":\"[parameters('location')]\",\"name\":\"[concat(variables('securityGroupName'), '-Network-flowlog')]\",\"properties\":{\"enabled\":true,\"flowAnalyticsConfiguration\":{\"networkWatcherFlowAnalyticsConfiguration\":{\"enabled\":true,\"trafficAnalyticsInterval\":\"[parameters('interval')]\",\"workspaceResourceId\":\"[parameters('workspace')]\"}},\"format\":{\"type\":\"JSON\",\"version\":2},\"retentionPolicy\":{\"days\":\"[parameters('retention')]\",\"enabled\":true},\"storageId\":\"[concat(subscription().id, '/resourceGroups/', variables('resourceGroupName'), '/providers/Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]\",\"targetResourceId\":\"[parameters('networkSecurityGroup')]\"},\"type\":\"flowLogs\"}],\"type\":\"Microsoft.Network/networkWatchers\"}]}},\"resourceGroup\":\"NetworkWatcherRG\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{\"resourceGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[4]]\",\"securityGroupName\":\"[split(parameters('networkSecurityGroup'), '/')[8]]\",\"storageAccountName\":\"[concat('es', uniqueString(variables('securityGroupName'), parameters('time')))]\"}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Network/networkWatchers/flowLogs/enabled\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\"resourceGroupName\":\"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), 'NetworkWatcherRG', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\"/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12\",\"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\",\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/networkWatchers/flowlogs\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
              "/providers/Microsoft.Authorization/roleDefinitions/81a9662b-bebf-436f-a333-f67b29880f12",
              "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
              "/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab",
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "Azure Database for PostgreSQL server deploy a specific min TLS version requirement and enforce SSL ",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:47.3810566Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-PostgreSQL-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure Database for PostgreSQL server\",\"displayName\":\"Effect Azure Database for PostgreSQL server\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure Database for PostgreSQL server to enforce\",\"displayName\":\"Select version for PostgreSQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.DBforPostgreSQL/servers\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\",\"notEquals\":\"Enabled\"},{\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\",\"notEquals\":\"[parameters('minimalTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-12-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\",\"sslEnforcement\":\"[if(equals(parameters('minimalTlsVersion'), 'TLSEnforcementDisabled'),'Disabled', 'Enabled')]\"},\"type\":\"Microsoft.DBforPostgreSQL/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.DBforPostgreSQL/servers/sslEnforcement\"},{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.DBforPostgreSQL/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.DBforPostgreSQL/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploys a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "SQL servers deploys a specific min TLS version requirement.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:50:46.578164Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-SQL-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/servers\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/servers\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/servers/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/servers\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy auditing settings to SQL Database when it not exist in the deployment",
            "display_name": "Deploy SQL database auditing settings",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:44:43.6233326Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-AuditingSettings",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"auditActionsAndGroups\":[\"BATCH_COMPLETED_GROUP\",\"DATABASE_OBJECT_CHANGE_GROUP\",\"SCHEMA_OBJECT_CHANGE_GROUP\",\"BACKUP_RESTORE_GROUP\",\"APPLICATION_ROLE_CHANGE_PASSWORD_GROUP\",\"DATABASE_PRINCIPAL_CHANGE_GROUP\",\"DATABASE_PRINCIPAL_IMPERSONATION_GROUP\",\"DATABASE_ROLE_MEMBER_CHANGE_GROUP\",\"USER_CHANGE_PASSWORD_GROUP\",\"DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP\",\"DATABASE_OBJECT_PERMISSION_CHANGE_GROUP\",\"DATABASE_PERMISSION_CHANGE_GROUP\",\"SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP\",\"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\",\"FAILED_DATABASE_AUTHENTICATION_GROUP\"],\"isAzureMonitorTargetEnabled\":true,\"state\":\"enabled\"},\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"enabled\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/state\"},{\"equals\":\"true\",\"field\":\"Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled\"}]},\"name\":\"default\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/auditingSettings\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration",
            "display_name": "Deploy SQL Database security Alert Policies configuration with email admin accounts",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:47:44.5298274Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-SecurityAlertPolicies",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2018-06-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"disabledAlerts\":[\"\"],\"emailAccountAdmins\":true,\"emailAddresses\":[\"admin@contoso.com\"],\"retentionDays\":0,\"state\":\"Enabled\",\"storageAccountAccessKey\":\"\",\"storageEndpoint\":null},\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/servers/databases/securityAlertPolicies/state\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/securityAlertPolicies\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy the Transparent Data Encryption when it is not enabled in the deployment",
            "display_name": "Deploy SQL Database Transparent Data Encryption ",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:40:08.5442016Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-Tde",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2014-04-01\",\"name\":\"[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]\",\"properties\":{\"status\":\"Enabled\"},\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"Enabled\",\"field\":\"Microsoft.Sql/transparentDataEncryption.status\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"],\"type\":\"Microsoft.Sql/servers/databases/transparentDataEncryption\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters",
            "display_name": "Deploy SQL Database vulnerability Assessments",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:13.8476331Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Sql-vulnerabilityAssessments",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
            "policy_rule": "{\"if\":{\"equals\":\"Microsoft.Sql/servers/databases\",\"field\":\"type\"},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"sqlServerDataBaseName\":{\"value\":\"[field('name')]\"},\"sqlServerName\":{\"value\":\"[first(split(field('fullname'),'/'))]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"sqlServerDataBaseName\":{\"type\":\"String\"},\"sqlServerName\":{\"type\":\"String\"},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\"},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2017-03-01-preview\",\"name\":\"[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]\",\"properties\":{\"recurringScans\":{\"emailSubscriptionAdmins\":false,\"emails\":[\"[parameters('vulnerabilityAssessmentsEmail')]\"],\"isEnabled\":true},\"storageAccountAccessKey\":\"[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]\",\"storageContainerPath\":\"[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]\"},\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('vulnerabilityAssessmentsEmail')]\",\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails\"},{\"equals\":true,\"field\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\"/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\"],\"type\":\"Microsoft.Sql/servers/databases/vulnerabilityAssessments\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
              "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on SQL managed instances. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.",
            "display_name": "SQL managed instances deploy a specific min TLS version requirement.",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:11.737443Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-SqlMi-minTLS",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version SQL servers\",\"displayName\":\"Effect SQL servers\"}},\"minimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.1\",\"1.0\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version minimum TLS version SQL servers to enforce\",\"displayName\":\"Select version for SQL server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Sql/managedInstances\",\"field\":\"type\"},{\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\",\"notequals\":\"[parameters('minimalTlsVersion')]\"}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('minimalTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimalTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2020-02-02-preview\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimalTlsVersion\":\"[parameters('minimalTlsVersion')]\"},\"type\":\"Microsoft.Sql/managedInstances\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"[parameters('minimalTlsVersion')]\",\"field\":\"Microsoft.Sql/managedInstances/minimalTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Sql/managedInstances\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy a specific min TLS version requirement and enforce SSL on Azure Storage. Enables secure server to client by enforce minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your Azure Storage.",
            "display_name": "Azure Storage deploy a specific min TLS version requirement and enforce SSL/HTTPS ",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Storage\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:43:12.2508415Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Storage-sslEnforcement",
            "parameters": "{\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy minimum TLS version Azure STorage\",\"displayName\":\"Effect Azure Storage\"}},\"minimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version minimum TLS version Azure STorage to enforce\",\"displayName\":\"Select TLS version for Azure Storage server\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Storage/storageAccounts\",\"field\":\"type\"},{\"anyOf\":[{\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\"notEquals\":\"true\"},{\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\",\"notEquals\":\"[parameters('minimumTlsVersion')]\"}]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"location\":{\"value\":\"[field('location')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('minimumTlsVersion')]\"},\"resourceName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"location\":{\"type\":\"String\"},\"minimumTlsVersion\":{\"type\":\"String\"},\"resourceName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2019-06-01\",\"location\":\"[parameters('location')]\",\"name\":\"[concat(parameters('resourceName'))]\",\"properties\":{\"minimumTlsVersion\":\"[parameters('minimumTlsVersion')]\",\"supportsHttpsTrafficOnly\":true},\"type\":\"Microsoft.Storage/storageAccounts\"}],\"variables\":{}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"true\",\"field\":\"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\"},{\"equals\":\"[parameters('minimumTlsVersion')]\",\"field\":\"Microsoft.Storage/storageAccounts/minimumTlsVersion\"}]},\"name\":\"current\",\"roleDefinitionIds\":[\"/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635\"],\"type\":\"Microsoft.Storage/storageAccounts\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/microsoft.authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
          "schema_version": 0,
          "attributes": {
            "description": "This policy deploys virtual network and peer to the hub",
            "display_name": "Deploy Virtual Network with peering to the hub",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:49:16.867536Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "mode": "All",
            "name": "Deploy-VNET-HubSpoke",
            "parameters": "{\"dnsServers\":{\"type\":\"Array\",\"defaultValue\":[],\"metadata\":{\"description\":\"Default domain servers for the vNET.\",\"displayName\":\"DNSServers\"}},\"hubResourceId\":{\"type\":\"String\",\"metadata\":{\"description\":\"Resource ID for the HUB vNet\",\"displayName\":\"hubResourceId\"}},\"vNetCidrRange\":{\"type\":\"String\",\"metadata\":{\"description\":\"CIDR Range for the vNet\",\"displayName\":\"vNetCidrRange\"}},\"vNetLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"Location for the vNet\",\"displayName\":\"vNetLocation\"}},\"vNetName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet\",\"displayName\":\"vNetName\"}},\"vNetPeerUseRemoteGateway\":{\"type\":\"Boolean\",\"defaultValue\":false,\"metadata\":{\"description\":\"Enable gateway transit for the LZ network\",\"displayName\":\"vNetPeerUseRemoteGateway\"}},\"vNetRgName\":{\"type\":\"String\",\"metadata\":{\"description\":\"Name of the landing zone vNet RG\",\"displayName\":\"vNetRgName\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/subscriptions\",\"field\":\"type\"}]},\"then\":{\"details\":{\"ResourceGroupName\":\"[parameters('vNetRgName')]\",\"deployment\":{\"location\":\"northeurope\",\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"dnsServers\":{\"value\":\"[parameters('dnsServers')]\"},\"hubResourceId\":{\"value\":\"[parameters('hubResourceId')]\"},\"vNetCidrRange\":{\"value\":\"[parameters('vNetCidrRange')]\"},\"vNetLocation\":{\"value\":\"[parameters('vNetLocation')]\"},\"vNetName\":{\"value\":\"[parameters('vNetName')]\"},\"vNetPeerUseRemoteGateway\":{\"value\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"vNetRgName\":{\"value\":\"[parameters('vNetRgName')]\"}},\"template\":{\"$schema\":\"http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"dnsServers\":{\"defaultValue\":[],\"type\":\"Array\"},\"hubResourceId\":{\"type\":\"String\"},\"vNetCidrRange\":{\"type\":\"String\"},\"vNetLocation\":{\"type\":\"String\"},\"vNetName\":{\"type\":\"String\"},\"vNetPeerUseRemoteGateway\":{\"defaultValue\":false,\"type\":\"bool\"},\"vNetRgName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6),'-rg')]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-04-01\",\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetRgName')]\",\"properties\":{},\"type\":\"Microsoft.Resources/resourceGroups\"}],\"variables\":{}}},\"type\":\"Microsoft.Resources/deployments\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6),'-rg')]\"],\"name\":\"[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6))]\",\"properties\":{\"mode\":\"Incremental\",\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[],\"location\":\"[parameters('vNetLocation')]\",\"name\":\"[parameters('vNetName')]\",\"properties\":{\"addressSpace\":{\"addressPrefixes\":[\"[parameters('vNetCidrRange')]\"]},\"dhcpOptions\":{\"dnsServers\":\"[parameters('dnsServers')]\"}},\"type\":\"Microsoft.Network/virtualNetworks\"},{\"apiVersion\":\"2021-02-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat(parameters('vNetName'), '/peerToHub')]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":false,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[parameters('hubResourceId')]\"},\"useRemoteGateways\":\"[parameters('vNetPeerUseRemoteGateway')]\"},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"},{\"apiVersion\":\"2021-04-01\",\"dependsOn\":[\"[parameters('vNetName')]\"],\"name\":\"[concat('es-lz-hub-',substring(uniqueString(subscription().id),0,6),'-peering')]\",\"properties\":{\"expressionEvaluationOptions\":{\"scope\":\"inner\"},\"mode\":\"Incremental\",\"parameters\":{\"hubName\":{\"value\":\"[split(parameters('hubResourceId'),'/')[8]]\"},\"remoteVirtualNetwork\":{\"value\":\"[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"hubName\":{\"defaultValue\":false,\"type\":\"String\"},\"remoteVirtualNetwork\":{\"defaultValue\":false,\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2021-02-01\",\"name\":\"[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]\",\"properties\":{\"allowForwardedTraffic\":true,\"allowGatewayTransit\":true,\"allowVirtualNetworkAccess\":true,\"remoteVirtualNetwork\":{\"id\":\"[[parameters('remoteVirtualNetwork')]\"},\"useRemoteGateways\":false},\"type\":\"Microsoft.Network/virtualNetworks/virtualNetworkPeerings\"}],\"variables\":{}}},\"resourceGroup\":\"[split(parameters('hubResourceId'),'/')[4]]\",\"subscriptionId\":\"[split(parameters('hubResourceId'),'/')[2]]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}},\"resourceGroup\":\"[parameters('vNetRgName')]\",\"type\":\"Microsoft.Resources/deployments\"}],\"variables\":{}}}},\"deploymentScope\":\"subscription\",\"existenceCondition\":{\"allOf\":[{\"field\":\"name\",\"like\":\"[parameters('vNetName')]\"},{\"equals\":\"[parameters('vNetLocation')]\",\"field\":\"location\"}]},\"existenceScope\":\"resourceGroup\",\"name\":\"[parameters('vNetName')]\",\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"],\"type\":\"Microsoft.Network/virtualNetworks\"},\"effect\":\"deployIfNotExists\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine",
            "display_name": "Deploy Windows Domain Join Extension with keyvault configuration",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Guest Configuration\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:46:14.6677295Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "Deploy-Windows-DomainJoin",
            "parameters": "{\"domainFQDN\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainFQDN\"}},\"domainOUPath\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainOUPath\"}},\"domainPassword\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainPassword\"}},\"domainUsername\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"domainUsername\"}},\"effect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"keyVaultResourceId\":{\"type\":\"String\",\"metadata\":{\"displayName\":\"keyVaultResourceId\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"equals\":\"MicrosoftWindowsServer\",\"field\":\"Microsoft.Compute/imagePublisher\"},{\"equals\":\"WindowsServer\",\"field\":\"Microsoft.Compute/imageOffer\"},{\"field\":\"Microsoft.Compute/imageSKU\",\"in\":[\"2008-R2-SP1\",\"2008-R2-SP1-smalldisk\",\"2008-R2-SP1-zhcn\",\"2012-Datacenter\",\"2012-datacenter-gensecond\",\"2012-Datacenter-smalldisk\",\"2012-datacenter-smalldisk-g2\",\"2012-Datacenter-zhcn\",\"2012-datacenter-zhcn-g2\",\"2012-R2-Datacenter\",\"2012-r2-datacenter-gensecond\",\"2012-R2-Datacenter-smalldisk\",\"2012-r2-datacenter-smalldisk-g2\",\"2012-R2-Datacenter-zhcn\",\"2012-r2-datacenter-zhcn-g2\",\"2016-Datacenter\",\"2016-datacenter-gensecond\",\"2016-datacenter-gs\",\"2016-Datacenter-Server-Core\",\"2016-datacenter-server-core-g2\",\"2016-Datacenter-Server-Core-smalldisk\",\"2016-datacenter-server-core-smalldisk-g2\",\"2016-Datacenter-smalldisk\",\"2016-datacenter-smalldisk-g2\",\"2016-Datacenter-with-Containers\",\"2016-datacenter-with-containers-g2\",\"2016-Datacenter-with-RDSH\",\"2016-Datacenter-zhcn\",\"2016-datacenter-zhcn-g2\",\"2019-Datacenter\",\"2019-Datacenter-Core\",\"2019-datacenter-core-g2\",\"2019-Datacenter-Core-smalldisk\",\"2019-datacenter-core-smalldisk-g2\",\"2019-Datacenter-Core-with-Containers\",\"2019-datacenter-core-with-containers-g2\",\"2019-Datacenter-Core-with-Containers-smalldisk\",\"2019-datacenter-core-with-containers-smalldisk-g2\",\"2019-datacenter-gensecond\",\"2019-datacenter-gs\",\"2019-Datacenter-smalldisk\",\"2019-datacenter-smalldisk-g2\",\"2019-Datacenter-with-Containers\",\"2019-datacenter-with-containers-g2\",\"2019-Datacenter-with-Containers-smalldisk\",\"2019-datacenter-with-containers-smalldisk-g2\",\"2019-Datacenter-zhcn\",\"2019-datacenter-zhcn-g2\",\"Datacenter-Core-1803-with-Containers-smalldisk\",\"datacenter-core-1803-with-containers-smalldisk-g2\",\"Datacenter-Core-1809-with-Containers-smalldisk\",\"datacenter-core-1809-with-containers-smalldisk-g2\",\"Datacenter-Core-1903-with-Containers-smalldisk\",\"datacenter-core-1903-with-containers-smalldisk-g2\",\"datacenter-core-1909-with-containers-smalldisk\",\"datacenter-core-1909-with-containers-smalldisk-g1\",\"datacenter-core-1909-with-containers-smalldisk-g2\"]}]},\"then\":{\"details\":{\"deployment\":{\"properties\":{\"mode\":\"Incremental\",\"parameters\":{\"domainFQDN\":{\"value\":\"[parameters('domainFQDN')]\"},\"domainOUPath\":{\"value\":\"[parameters('domainOUPath')]\"},\"domainPassword\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainPassword')]\"}},\"domainUsername\":{\"reference\":{\"keyVault\":{\"id\":\"[parameters('keyVaultResourceId')]\"},\"secretName\":\"[parameters('domainUsername')]\"}},\"keyVaultResourceId\":{\"value\":\"[parameters('keyVaultResourceId')]\"},\"location\":{\"value\":\"[field('location')]\"},\"vmName\":{\"value\":\"[field('name')]\"}},\"template\":{\"$schema\":\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{},\"parameters\":{\"domainFQDN\":{\"type\":\"String\"},\"domainOUPath\":{\"type\":\"String\"},\"domainPassword\":{\"type\":\"securestring\"},\"domainUsername\":{\"type\":\"String\"},\"keyVaultResourceId\":{\"type\":\"String\"},\"location\":{\"type\":\"String\"},\"vmName\":{\"type\":\"String\"}},\"resources\":[{\"apiVersion\":\"2015-06-15\",\"location\":\"[resourceGroup().location]\",\"name\":\"[concat(variables('vmName'),'/joindomain')]\",\"properties\":{\"autoUpgradeMinorVersion\":true,\"protectedSettings\":{\"Password\":\"[parameters('domainPassword')]\"},\"publisher\":\"Microsoft.Compute\",\"settings\":{\"Name\":\"[parameters('domainFQDN')]\",\"OUPath\":\"[parameters('domainOUPath')]\",\"Options\":\"[variables('domainJoinOptions')]\",\"Restart\":\"true\",\"User\":\"[parameters('domainUserName')]\"},\"type\":\"JsonADDomainExtension\",\"typeHandlerVersion\":\"1.3\"},\"type\":\"Microsoft.Compute/virtualMachines/extensions\"}],\"variables\":{\"domainJoinOptions\":3,\"vmName\":\"[parameters('vmName')]\"}}}},\"existenceCondition\":{\"allOf\":[{\"equals\":\"JsonADDomainExtension\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/type\"},{\"equals\":\"Microsoft.Compute\",\"field\":\"Microsoft.Compute/virtualMachines/extensions/publisher\"}]},\"roleDefinitionIds\":[\"/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"],\"type\":\"Microsoft.Compute/virtualMachines/extensions\"},\"effect\":\"[parameters('effect')]\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [
              "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c"
            ],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_policy_set_definition",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that prevents creation of Azure PaaS services with exposed public endpoints",
            "display_name": "Public network access should be disabled for PaaS services",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.295052Z\",\"updatedBy\":null,\"updatedOn\":null}",
            "name": "Deny-PublicPaaSEndpoints",
            "parameters": "{\"ACRPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure Container Registires with exposed public endpoints \",\"displayName\":\"Public network access on Azure Container Registry disabled\"}},\"AFSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies the creation of Azure File Sync instances with exposed public endpoints \",\"displayName\":\"Public network access on Azure File Sync disabled\"}},\"AKSPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies  the creation of  Azure Kubernetes Service non-private clusters\",\"displayName\":\"Public network access on AKS API should be disabled\"}},\"BatchPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Azure Batch Instances with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for Azure Batch Instances\"}},\"CosmosPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies that  Cosmos database accounts  are created with out public network access is disabled.\",\"displayName\":\"Public network access should be disabled for CosmosDB\"}},\"KeyVaultPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access should be disabled for KeyVault\"}},\"MySQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of MySql Flexible Server DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for MySQL Flexible Server\"}},\"PostgreSQLFlexPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Postgre SQL Flexible DB accounts with exposed public endpoints\",\"displayName\":\"Public network access should be disabled for PostgreSql Flexible Server\"}},\"SqlServerPublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of Sql servers with exposed public endpoints\",\"displayName\":\"Public network access on Azure SQL Database should be disabled\"}},\"StoragePublicIpDenyEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Deny\",\"metadata\":{\"description\":\"This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints\",\"displayName\":\"Public network access onStorage accounts should be disabled\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
                "policy_group_names": [],
                "reference_id": "CosmosDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
                "policy_group_names": [],
                "reference_id": "KeyVaultDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
                "policy_group_names": [],
                "reference_id": "SqlServerDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StoragePublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
                "policy_group_names": [],
                "reference_id": "StorageDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
                "policy_group_names": [],
                "reference_id": "AKSDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
                "policy_group_names": [],
                "reference_id": "ACRDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AFSPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
                "policy_group_names": [],
                "reference_id": "AFSDenyPaasPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLFlexPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
                "policy_group_names": [],
                "reference_id": "PostgreSQLFlexDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLFlexPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
                "policy_group_names": [],
                "reference_id": "MySQLFlexDenyPublicIP"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchPublicIpDenyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
                "policy_group_names": [],
                "reference_id": "BatchDenyPublicIP"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
          "schema_version": 0,
          "attributes": {
            "description": "This policy set deploys the configurations of application Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace. See the list of policies of the services that are included ",
            "display_name": "Deploy Diagnostic Settings to Azure Services",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Monitoring\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.353357Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.1.0\"}",
            "name": "Deploy-Diagnostics-LogAnalytics",
            "parameters": "{\"ACILogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy willset the diagnostic with all metrics enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Instances to Log Analytics workspace\"}},\"ACRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics  enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Container Registry to Log Analytics workspace\"}},\"AKSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace\"}},\"APIMgmtLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for API Management to Log Analytics workspace\"}},\"APIforFHIRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure API for FHIR to stream to a Log Analytics workspace when any Azure API for FHIR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure API for FHIR to Log Analytics workspace\"}},\"AVDScalingPlansLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Scaling Plans to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Scaling Plans to Log Analytics workspace\"}},\"AnalysisServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace\"}},\"AppServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace\"}},\"AppServiceWebappLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for App Service to Log Analytics workspace\"}},\"ApplicationGatewayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace\"}},\"AutomationLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Automation to Log Analytics workspace\"}},\"BastionLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Bastion to stream to a Log Analytics workspace when any Bastion which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Bastion to Log Analytics workspace\"}},\"BatchLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Batch to Log Analytics workspace\"}},\"CDNEndpointsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace\"}},\"CognitiveServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace\"}},\"CosmosLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace\"}},\"DataExplorerClusterLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Explorer Cluster to stream to a Log Analytics workspace when any Azure Data Explorer Cluster which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Explorer Cluster to Log Analytics workspace\"}},\"DataFactoryLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Factory to Log Analytics workspace\"}},\"DataLakeAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace\"}},\"DataLakeStoreLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace\"}},\"DatabricksLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Databricks to Log Analytics workspace\"}},\"EventGridSubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace\"}},\"EventGridTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace\"}},\"EventHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace\"}},\"EventSystemTopicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace\"}},\"ExpressRouteLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace\"}},\"FirewallLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Firewall to Log Analytics workspace\"}},\"FrontDoorLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Front Door to Log Analytics workspace\"}},\"FunctionAppLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace\"}},\"HDInsightLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for HDInsight to Log Analytics workspace\"}},\"IotHubLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace\"}},\"KeyVaultLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Key Vault to Log Analytics workspace\"}},\"LoadBalancerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace\"}},\"LogicAppsISELogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace\"}},\"LogicAppsWFLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Logic Apps Workflows to stream to a Log Analytics workspace when any Logic Apps Workflows which are missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Logic Apps Workflows to Log Analytics workspace\"}},\"MariaDBLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for MariaDB to Log Analytics workspace\"}},\"MediaServiceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Azure Media Service to stream to a Log Analytics workspace when any Azure Media Service which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Azure Media Service to Log Analytics workspace\"}},\"MlWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace\"}},\"MySQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace\"}},\"NetworkNICLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace\"}},\"NetworkPublicIPNicLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace\"}},\"NetworkSecurityGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace\"}},\"PostgreSQLLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace\"}},\"PowerBIEmbeddedLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace\"}},\"RedisCacheLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace\"}},\"RelayLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Relay to Log Analytics workspace\"}},\"SQLDBsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace\"}},\"SQLElasticPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace\"}},\"SQLMLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace\"}},\"SearchServicesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Search Services to Log Analytics workspace\"}},\"ServiceBusLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace\"}},\"SignalRLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for SignalR to Log Analytics workspace\"}},\"StorageAccountsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Storage Accounts to stream to a Log Analytics workspace when any storage account which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Storage Accounts to Log Analytics workspace\"}},\"StreamAnalyticsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\"}},\"TimeSeriesInsightsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace\"}},\"TrafficManagerLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace\"}},\"VMSSLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace\"}},\"VNetGWLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled.\",\"displayName\":\"Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace\"}},\"VirtualMachinesLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace\"}},\"VirtualNetworkLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace\"}},\"WVDAppGroupsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Application groups to stream to a Log Analytics workspace when any application groups which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Application Groups to Log Analytics workspace\"}},\"WVDHostPoolsLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Host pools to stream to a Log Analytics workspace when any host pool which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Host pools to Log Analytics workspace\"}},\"WVDWorkspaceLogAnalyticsEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploys the diagnostic settings for AVD Workspace to stream to a Log Analytics workspace when any Workspace which is missing this diagnostic settings is created or updated. The Policy will set the diagnostic with all metrics and category enabled\",\"displayName\":\"Deploy Diagnostic Settings for AVD Workspace to Log Analytics workspace\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}},\"profileName\":{\"type\":\"String\",\"defaultValue\":\"setbypolicy\",\"metadata\":{\"description\":\"The diagnostic settings profile name\",\"displayName\":\"Profile name\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageAccountsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6f8f98a4-f108-47cb-8e98-91a0d85cd474",
                "policy_group_names": [],
                "reference_id": "StorageAccountDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AVDScalingPlansLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AVDScalingPlans",
                "policy_group_names": [],
                "reference_id": "AVDScalingPlansDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDAppGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDAppGroup",
                "policy_group_names": [],
                "reference_id": "WVDAppGroupDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDWorkspace",
                "policy_group_names": [],
                "reference_id": "WVDWorkspaceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WVDHostPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WVDHostPools",
                "policy_group_names": [],
                "reference_id": "WVDHostPoolsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACILogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI",
                "policy_group_names": [],
                "reference_id": "ACIDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR",
                "policy_group_names": [],
                "reference_id": "ACRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('AKSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6c66c325-74c8-42fd-a286-a74b0e2939d8",
                "policy_group_names": [],
                "reference_id": "AKSDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AnalysisServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService",
                "policy_group_names": [],
                "reference_id": "AnalysisServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIforFHIRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApiForFHIR",
                "policy_group_names": [],
                "reference_id": "APIforFHIRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIMgmtLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt",
                "policy_group_names": [],
                "reference_id": "APIMgmtDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ApplicationGatewayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway",
                "policy_group_names": [],
                "reference_id": "ApplicationGatewayDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AutomationLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA",
                "policy_group_names": [],
                "reference_id": "AutomationDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BastionLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Bastion",
                "policy_group_names": [],
                "reference_id": "BastionDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('BatchLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5",
                "policy_group_names": [],
                "reference_id": "BatchDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CDNEndpointsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints",
                "policy_group_names": [],
                "reference_id": "CDNEndpointsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices",
                "policy_group_names": [],
                "reference_id": "CognitiveServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB",
                "policy_group_names": [],
                "reference_id": "CosmosDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DatabricksLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks",
                "policy_group_names": [],
                "reference_id": "DatabricksDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataExplorerClusterLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataExplorerCluster",
                "policy_group_names": [],
                "reference_id": "DataExplorerClusterDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataFactoryLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory",
                "policy_group_names": [],
                "reference_id": "DataFactoryDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeStoreLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03",
                "policy_group_names": [],
                "reference_id": "DataLakeStoreDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataLakeAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics",
                "policy_group_names": [],
                "reference_id": "DataLakeAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridSubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub",
                "policy_group_names": [],
                "reference_id": "EventGridSubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventGridTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic",
                "policy_group_names": [],
                "reference_id": "EventGridTopicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579",
                "policy_group_names": [],
                "reference_id": "EventHubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EventSystemTopicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic",
                "policy_group_names": [],
                "reference_id": "EventSystemTopicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ExpressRouteLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute",
                "policy_group_names": [],
                "reference_id": "ExpressRouteDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FirewallLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall",
                "policy_group_names": [],
                "reference_id": "FirewallDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FrontDoorLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor",
                "policy_group_names": [],
                "reference_id": "FrontDoorDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionAppLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function",
                "policy_group_names": [],
                "reference_id": "FunctionAppDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('HDInsightLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight",
                "policy_group_names": [],
                "reference_id": "HDInsightDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('IotHubLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub",
                "policy_group_names": [],
                "reference_id": "IotHubDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('KeyVaultLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47",
                "policy_group_names": [],
                "reference_id": "KeyVaultDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LoadBalancerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer",
                "policy_group_names": [],
                "reference_id": "LoadBalancerDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsISELogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE",
                "policy_group_names": [],
                "reference_id": "LogicAppsISEDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('LogicAppsWFLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721",
                "policy_group_names": [],
                "reference_id": "LogicAppsWFDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MariaDBLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB",
                "policy_group_names": [],
                "reference_id": "MariaDBDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MediaServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MediaService",
                "policy_group_names": [],
                "reference_id": "MediaServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MlWorkspaceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace",
                "policy_group_names": [],
                "reference_id": "MlWorkspaceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL",
                "policy_group_names": [],
                "reference_id": "MySQLDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkSecurityGroupsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups",
                "policy_group_names": [],
                "reference_id": "NetworkSecurityGroupsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkNICLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC",
                "policy_group_names": [],
                "reference_id": "NetworkNICDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL",
                "policy_group_names": [],
                "reference_id": "PostgreSQLDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PowerBIEmbeddedLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded",
                "policy_group_names": [],
                "reference_id": "PowerBIEmbeddedDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('NetworkPublicIPNicLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"metricsEnabled\":{\"value\":\"True\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/752154a7-1e0f-45c6-a880-ac75a7e4f648",
                "policy_group_names": [],
                "reference_id": "NetworkPublicIPNicDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3",
                "policy_group_names": [],
                "reference_id": "RecoveryVaultDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisCacheLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache",
                "policy_group_names": [],
                "reference_id": "RedisCacheDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RelayLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay",
                "policy_group_names": [],
                "reference_id": "RelayDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SearchServicesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d",
                "policy_group_names": [],
                "reference_id": "SearchServicesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ServiceBusLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e",
                "policy_group_names": [],
                "reference_id": "ServiceBusDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SignalRLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR",
                "policy_group_names": [],
                "reference_id": "SignalRDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"diagnosticsSettingNameToUse\":{\"value\":\"[parameters('profileName')]\"},\"effect\":{\"value\":\"[parameters('SQLDBsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b79fa14e-238a-4c2d-b376-442ce508fc84",
                "policy_group_names": [],
                "reference_id": "SQLDatabaseDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLElasticPoolsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools",
                "policy_group_names": [],
                "reference_id": "SQLElasticPoolsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLMLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI",
                "policy_group_names": [],
                "reference_id": "SQLMDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673",
                "policy_group_names": [],
                "reference_id": "StreamAnalyticsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('TimeSeriesInsightsLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights",
                "policy_group_names": [],
                "reference_id": "TimeSeriesInsightsDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('TrafficManagerLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager",
                "policy_group_names": [],
                "reference_id": "TrafficManagerDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualNetworkLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork",
                "policy_group_names": [],
                "reference_id": "VirtualNetworkDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VirtualMachinesLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM",
                "policy_group_names": [],
                "reference_id": "VirtualMachinesDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VMSSLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS",
                "policy_group_names": [],
                "reference_id": "VMSSDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('VNetGWLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW",
                "policy_group_names": [],
                "reference_id": "VNetGWDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm",
                "policy_group_names": [],
                "reference_id": "AppServiceDeployDiagnosticLogDeployLogAnalytics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceWebappLogAnalyticsEffect')]\"},\"logAnalytics\":{\"value\":\"[parameters('logAnalytics')]\"},\"profileName\":{\"value\":\"[parameters('profileName')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website",
                "policy_group_names": [],
                "reference_id": "AppServiceWebappDeployDiagnosticLogDeployLogAnalytics"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy Microsoft Defender for Cloud configuration",
            "display_name": "Deploy Microsoft Defender for Cloud configuration",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Security Center\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.2398675Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"3.0.0\"}",
            "name": "Deploy-MDFC-Config",
            "parameters": "{\"ascExportResourceGroupLocation\":{\"type\":\"String\",\"metadata\":{\"description\":\"The location where the resource group and the export to Log Analytics workspace configuration are created.\",\"displayName\":\"Resource Group location for the export to Log Analytics workspace configuration\"}},\"ascExportResourceGroupName\":{\"type\":\"String\",\"metadata\":{\"description\":\"The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn't exist, it'll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\",\"displayName\":\"Resource Group name for the export to Log Analytics workspace configuration\"}},\"emailSecurityContact\":{\"type\":\"string\",\"metadata\":{\"description\":\"Provide email address for Microsoft Defender for Cloud contact details\",\"displayName\":\"Security contacts email address\"}},\"enableAscForAppServices\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForArm\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForContainers\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForDns\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForKeyVault\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForOssDb\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForServers\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSql\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForSqlOnVm\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"enableAscForStorage\":{\"type\":\"String\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"logAnalytics\":{\"type\":\"String\",\"metadata\":{\"description\":\"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\"displayName\":\"Primary Log Analytics workspace\",\"strongType\":\"omsWorkspace\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForOssDb')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
                "policy_group_names": [],
                "reference_id": "defenderForOssDb"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForServers')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8e86a5b6-b9bd-49d1-8e21-4bb8a0862222",
                "policy_group_names": [],
                "reference_id": "defenderForVM"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSqlOnVm')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
                "policy_group_names": [],
                "reference_id": "defenderForSqlServerVirtualMachines"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForAppServices')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
                "policy_group_names": [],
                "reference_id": "defenderForAppServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForStorage')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/74c30959-af11-47b3-9ed2-a26e03f427a3",
                "policy_group_names": [],
                "reference_id": "defenderForStorageAccounts"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForContainers')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
                "policy_group_names": [],
                "reference_id": "defenderforContainers"
              },
              {
                "parameter_values": "{\"Effect\":{\"value\":\"[parameters('enableAscForKeyVault')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
                "policy_group_names": [],
                "reference_id": "defenderForKeyVaults"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForDns')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
                "policy_group_names": [],
                "reference_id": "defenderForDns"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForArm')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
                "policy_group_names": [],
                "reference_id": "defenderForArm"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('enableAscForSql')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
                "policy_group_names": [],
                "reference_id": "defenderForSqlPaas"
              },
              {
                "parameter_values": "{\"emailSecurityContact\":{\"value\":\"[parameters('emailSecurityContact')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-SecurityContacts",
                "policy_group_names": [],
                "reference_id": "securityEmailContact"
              },
              {
                "parameter_values": "{\"resourceGroupLocation\":{\"value\":\"[parameters('ascExportResourceGroupLocation')]\"},\"resourceGroupName\":{\"value\":\"[parameters('ascExportResourceGroupName')]\"},\"workspaceResourceId\":{\"value\":\"[parameters('logAnalytics')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9",
                "policy_group_names": [],
                "reference_id": "ascExport"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
          "schema_version": 0,
          "attributes": {
            "description": "This policy initiative is a group of policies that ensures private endpoints to Azure PaaS services are integrated with Azure Private DNS zones",
            "display_name": "Configure Azure PaaS services to use private DNS zones",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Network\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.3947574Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Deploy-Private-DNS-Zones",
            "parameters": "{\"azureAcrPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAcrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAppServicesPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAppServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureAsrPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureAsrPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureBatchPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureBatchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveSearchPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveSearchPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureCognitiveServicesPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureCognitiveServicesPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureDiskAccessPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureDiskAccessPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridDomainsPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridDomainsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventGridTopicsPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventGridTopicsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureEventHubNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureEventHubNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureFilePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureFilePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotHubsPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotHubsPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureIotPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureIotPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureKeyVaultPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureKeyVaultPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureMachineLearningWorkspacePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureMachineLearningWorkspacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureRedisCachePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureRedisCachePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureServiceBusNamespacePrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureServiceBusNamespacePrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureSignalRPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureSignalRPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"azureWebPrivateDnsZoneId\":{\"type\":\"string\",\"metadata\":{\"description\":\"Private DNS Zone Identifier\",\"displayName\":\"azureWebPrivateDnsZoneId\",\"strongType\":\"Microsoft.Network/privateDnsZones\"}},\"effect\":{\"type\":\"string\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}},\"effect1\":{\"type\":\"string\",\"allowedValues\":[\"deployIfNotExists\",\"Disabled\"],\"defaultValue\":\"deployIfNotExists\",\"metadata\":{\"description\":\"Enable or disable the execution of the policy\",\"displayName\":\"Effect\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureFileprivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-File-Sync"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureWebPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Web"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureBatchPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/4ec38ebc-381f-45ee-81a4-acbc4be878f8",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Batch"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7a860e27-9ca2-4fc6-822d-c2d248c300df",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-App"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAsrPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/942bd215-1a66-44be-af65-6a1c0318dbe2",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-Site-Recovery"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/aaa64d2d-2fa3-45e5-b332-0b031b9b30e8",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-IoT"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureKeyVaultPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ac673a9a-f77d-4846-b2d8-a57f8e1c01d4",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-KeyVault"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureSignalRPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b0e86710-7fb7-4a6c-a064-32e9b829509e",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-SignalR"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAppServicesPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/b318f84a-b872-429b-ac6d-a01b96814452",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-AppServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridTopicsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/baf19753-7502-405f-8745-370519b20483",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-EventGridTopics"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureDiskAccessPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/bc05b96c-0b36-4ca9-82f0-5c53f96ce05a",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-DiskAccess"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveServicesPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c4bc6f10-cb41-49eb-b000-d5ab82e2a091",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-CognitiveServices"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureIotHubsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/c99ce9c1-ced7-4c3e-aca0-10e69ce0cb02",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-IoTHubs"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect1')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventGridDomainsPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/d389df0a-e0d7-4607-833c-75a6fdac2c2d",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-EventGridDomains"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureRedisCachePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e016b22b-e0eb-436d-8fd7-160c4eaed6e2",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-RedisCache"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureAcrPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e9585a95-5b8c-4d03-b193-dc7eb5ac4c32",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-ACR"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureEventHubNamespacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ed66d4f5-8220-45dc-ab4a-20d1749c74e6",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-EventHubNamespace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureMachineLearningWorkspacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ee40564d-486e-4f68-a5ca-7a621edae0fb",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-MachineLearningWorkspace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureServiceBusNamespacePrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0fcf93c-c063-4071-9668-c47474bd3564",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-ServiceBusNamespace"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('effect')]\"},\"privateDnsZoneId\":{\"value\":\"[parameters('azureCognitiveSearchPrivateDnsZoneId')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/fbc14a67-53e4-4932-abcc-2049c6706009",
                "policy_group_names": [],
                "reference_id": "DINE-Private-DNS-Azure-CognitiveSearch"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
          "schema_version": 0,
          "attributes": {
            "description": "Deploy auditing, Alert, TDE and SQL vulnerability to SQL Databases when it not exist in the deployment",
            "display_name": "Deploy SQL Database built-in SQL security configuration",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"SQL\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:51.6155236Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Deploy-Sql-Security",
            "parameters": "{\"SqlDbAuditingSettingsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy auditing settings to SQL Database when it not exist in the deployment\",\"displayName\":\"Deploy SQL database auditing settings\"}},\"SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration\",\"displayName\":\"Deploy SQL Database security Alert Policies configuration with email admin accounts\"}},\"SqlDbTdeDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy the Transparent Data Encryption when it is not enabled in the deployment\",\"displayName\":\"Deploy SQL Database Transparent Data Encryption \"}},\"SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters\",\"displayName\":\"Deploy SQL Database vulnerability Assessments\"}},\"vulnerabilityAssessmentsEmail\":{\"type\":\"String\",\"metadata\":{\"description\":\"The email address to send alerts\",\"displayName\":\"The email address to send alerts\"}},\"vulnerabilityAssessmentsStorageID\":{\"type\":\"String\",\"metadata\":{\"description\":\"The storage account ID to store assessments\",\"displayName\":\"The storage account ID to store assessments\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbTdeDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde",
                "policy_group_names": [],
                "reference_id": "SqlDbTdeDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbSecurityAlertPoliciesDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies",
                "policy_group_names": [],
                "reference_id": "SqlDbSecurityAlertPoliciesDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbAuditingSettingsDeploySqlSecurityEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings",
                "policy_group_names": [],
                "reference_id": "SqlDbAuditingSettingsDeploySqlSecurity"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlDbVulnerabilityAssessmentsDeploySqlSecurityEffect')]\"},\"vulnerabilityAssessmentsEmail\":{\"value\":\"[parameters('vulnerabilityAssessmentsEmail')]\"},\"vulnerabilityAssessmentsStorageID\":{\"value\":\"[parameters('vulnerabilityAssessmentsStorageID')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments",
                "policy_group_names": [],
                "reference_id": "SqlDbVulnerabilityAssessmentsDeploySqlSecurity"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
          "schema_version": 0,
          "attributes": {
            "description": "Choose either Deploy if not exist and append in combination with audit or Select Deny in the Policy effect. Deny polices shift left. Deploy if not exist and append enforce but can be changed, and because missing exsistense condition require then the combination of Audit. ",
            "display_name": "Deny or Deploy and append TLS requirements and SSL enforcement on resources without Encryption in transit",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Encryption\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.3892497Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Enforce-EncryptTransit",
            "parameters": "{\"AKSIngressHttpsOnlyEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"deny\",\"metadata\":{\"description\":\"This policy enforces HTTPS ingress in a Kubernetes cluster. This policy is generally available for Kubernetes Service (AKS), and preview for AKS Engine and Azure Arc enabled Kubernetes. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\",\"displayName\":\"AKS Service. Enforce HTTPS ingress in Kubernetes cluster\"}},\"APIAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service API App. API App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"APIAppServiceLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"App Service API App. Only Audit, deny not possible as it is a related resource.  Upgrade to the latest TLS version.\",\"displayName\":\"App Service API App. Latest TLS version should be used in your API App\"}},\"AppServiceHttpEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Append the AppService sites object to ensure that min Tls version is set to required TLS version. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService sites config WebApp, APIApp, Function App with TLS version selected below\"}},\"AppServiceTlsVersionEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"App Service. Appends the AppService sites object to ensure that  HTTPS only is enabled for  server/service authentication and protects data in transit from network layer eavesdropping attacks. Please note Append does not enforce compliance use then deny.\",\"displayName\":\"App Service. Appends the AppService WebApp, APIApp, Function App to enable https only\"}},\"AppServiceminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"App Service. Select version  minimum TLS version for a  Web App config to enforce\",\"displayName\":\"App Service. Select version minimum TLS Web App config\"}},\"FunctionLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Function App. Latest TLS version should be used in your Function App\"}},\"FunctionServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"App Service Function App. Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Function App. Function App should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"MySQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for MySQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Deploy if not exist set minimum TLS version Azure Database for MySQL server\"}},\"MySQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"MySQL database servers. Enforce SSL connection should be enabled for MySQL database servers\"}},\"MySQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"MySQL database servers. Select version minimum TLS for MySQL server\"}},\"PostgreSQLEnableSSLDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Database for PostgreSQL server. Enforce the Server to client applications using minimum version of Tls to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Deploy if not exist set minimum TLS version Azure Database for PostgreSQL server\"}},\"PostgreSQLEnableSSLEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Database for PostgreSQL supports connecting your Azure Database for PostgreSQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"PostgreSQL database servers. Enforce SSL connection should be enabled for PostgreSQL database servers\"}},\"PostgreSQLminimalTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_0\",\"TLS1_1\",\"TLSEnforcementDisabled\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"PostgreSQL database servers. Select version  minimum TLS version Azure Database for MySQL server to enforce\",\"displayName\":\"PostgreSQL database servers. Select version minimum TLS for MySQL server\"}},\"RedisMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for a Azure Cache for Redis to enforce\",\"displayName\":\"Azure Cache for Redis.Select version minimum TLS for Azure Cache for Redis\"}},\"RedisTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"Append\",\"Disabled\"],\"defaultValue\":\"Append\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on Azure Cache for Redis. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Cache for Redis. Deploy a specific min TLS version requirement and enforce SSL Azure Cache for Redis\"}},\"RedisTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Azure Cache for Redis. Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.\",\"displayName\":\"Azure Cache for Redis. Only secure connections to your Azure Cache for Redis should be enabled\"}},\"SQLManagedInstanceMinTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure Managed Instanceto to  enforce\",\"displayName\":\"Azure Managed Instance.Select version minimum TLS for Azure Managed Instance\"}},\"SQLManagedInstanceTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure Managed Instance. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLManagedInstanceTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your SQL Managed Instance can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"SQL Managed Instance should have the minimal TLS version of 1.2\"}},\"SQLServerTLSDeployEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Deploy a specific min TLS version requirement and enforce SSL on SQL servers. Enables secure server to client by enforce  minimal Tls Version to secure the connection between your database server and your client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and your application. This configuration enforces that SSL is always enabled for accessing your database server.\",\"displayName\":\"Azure SQL Database. Deploy a specific min TLS version requirement and enforce SSL on SQL servers\"}},\"SQLServerTLSEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\"displayName\":\"Azure SQL Database should have the minimal TLS version of 1.2\"}},\"SQLServerminTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"1.2\",\"1.0\",\"1.1\"],\"defaultValue\":\"1.2\",\"metadata\":{\"description\":\"Select version  minimum TLS version for Azure SQL Database to enforce\",\"displayName\":\"Azure SQL Database.Select version minimum TLS for Azure SQL Database\"}},\"StorageDeployHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"DeployIfNotExists\",\"Disabled\"],\"defaultValue\":\"DeployIfNotExists\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Deploy Secure transfer to storage accounts should be enabled\"}},\"StorageHttpsEnabledEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\"displayName\":\"Azure Storage Account. Secure transfer to storage accounts should be enabled\"}},\"StorageminimumTlsVersion\":{\"type\":\"String\",\"allowedValues\":[\"TLS1_2\",\"TLS1_1\",\"TLS1_0\"],\"defaultValue\":\"TLS1_2\",\"metadata\":{\"description\":\"Select version  minimum TLS version on Azure Storage Account to enforce\",\"displayName\":\"Storage Account select minimum TLS version\"}},\"WebAppServiceHttpsEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\",\"Deny\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Choose Deny or Audit in combination with Append policy. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\"displayName\":\"App Service Web App. Web Application should only be accessible over HTTPS. Choose Deny or Audit in combination with Append policy.\"}},\"WebAppServiceLatestTlsEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Only Audit, deny not possible as it is a related resource. Upgrade to the latest TLS version.\",\"displayName\":\"App Service Web App. Latest TLS version should be used in your Web App\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceHttpEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-httpsonly",
                "policy_group_names": [],
                "reference_id": "AppServiceHttpEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AppServiceTlsVersionEffect')]\"},\"minTlsVersion\":{\"value\":\"[parameters('AppServiceminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-AppService-latestTLS",
                "policy_group_names": [],
                "reference_id": "AppServiceminTlsVersion"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
                "policy_group_names": [],
                "reference_id": "APIAppServiceLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
                "policy_group_names": [],
                "reference_id": "FunctionLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceLatestTlsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
                "policy_group_names": [],
                "reference_id": "WebAppServiceLatestTlsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('APIAppServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceApiApp-http",
                "policy_group_names": [],
                "reference_id": "APIAppServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('FunctionServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceFunctionApp-http",
                "policy_group_names": [],
                "reference_id": "FunctionServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WebAppServiceHttpsEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-AppServiceWebApp-http",
                "policy_group_names": [],
                "reference_id": "WebAppServiceHttpsEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AKSIngressHttpsOnlyEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
                "policy_group_names": [],
                "reference_id": "AKSIngressHttpsOnlyEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-MySQL-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "MySQLEnableSSLDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('MySQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-MySql-http",
                "policy_group_names": [],
                "reference_id": "MySQLEnableSSLEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-PostgreSQL-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "PostgreSQLEnableSSLDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLEnableSSLEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('PostgreSQLminimalTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-PostgreSql-http",
                "policy_group_names": [],
                "reference_id": "PostgreSQLEnableSSLEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "RedisTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSDeployEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Append-Redis-disableNonSslPort",
                "policy_group_names": [],
                "reference_id": "RedisdisableNonSslPort"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('RedisTLSEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('RedisMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Redis-http",
                "policy_group_names": [],
                "reference_id": "RedisDenyhttps"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SqlMi-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLManagedInstanceTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLManagedInstanceTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLManagedInstanceMinTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-SqlMi-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLManagedInstanceTLSEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSDeployEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-SQL-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLServerTLSDeployEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SQLServerTLSEffect')]\"},\"minimalTlsVersion\":{\"value\":\"[parameters('SQLServerminTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Sql-minTLS",
                "policy_group_names": [],
                "reference_id": "SQLServerTLSEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deny-Storage-minTLS",
                "policy_group_names": [],
                "reference_id": "StorageHttpsEnabledEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageDeployHttpsEnabledEffect')]\"},\"minimumTlsVersion\":{\"value\":\"[parameters('StorageMinimumTlsVersion')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyDefinitions/Deploy-Storage-sslEnforcement",
                "policy_group_names": [],
                "reference_id": "StorageDeployHttpsEnabledEffect"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
          "schema_version": 0,
          "attributes": {
            "description": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
            "display_name": "Deny or Audit resources without Encryption with a customer-managed key (CMK)",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK",
            "management_group_id": "/providers/Microsoft.Management/managementGroups/vcfes",
            "metadata": "{\"category\":\"Encryption\",\"createdBy\":\"fa02198b-0bc8-45c8-87c2-aad3c5d9a5d3\",\"createdOn\":\"2022-09-18T11:55:52.3073887Z\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "Enforce-Encryption-CMK",
            "parameters": "{\"ACRCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of the contents of your registries. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/acr/CMK.\",\"displayName\":\"Container registries should be encrypted with a customer-managed key (CMK)\"}},\"AksCmkEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Encrypting OS and data disks using customer-managed keys provides more control and greater flexibility in key management. This is a common requirement in many regulatory and industry compliance standards.\",\"displayName\":\"Azure Kubernetes Service clusters both operating systems and data disks should be encrypted by customer-managed keys\"}},\"AzureBatchCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys (CMKs) to manage the encryption at rest of your Batch account's data. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/Batch-CMK.\",\"displayName\":\"Azure Batch account should use customer-managed keys to encrypt data\"}},\"CognitiveServicesCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data stored in Cognitive Services to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Cognitive Services accounts should enable data encryption with a customer-managed key (CMK)\"}},\"CosmosCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\"displayName\":\"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\"}},\"DataBoxCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption of the device unlock password for Azure Data Box. Customer-managed keys also help manage access to the device unlock password by the Data Box service in order to prepare the device and copy data in an automated manner. The data on the device itself is already encrypted at rest with Advanced Encryption Standard 256-bit encryption, and the device unlock password is encrypted by default with a Microsoft managed key.\",\"displayName\":\"Azure Data Box jobs should use a customer-managed key to encrypt the device unlock password\"}},\"EncryptedVMDisksEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\"displayName\":\"Disk encryption should be applied on virtual machines\"}},\"HealthcareAPIsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.\",\"displayName\":\"Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest\"}},\"MySQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your MySQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure MySQL servers bring your own key data protection should be enabled\"}},\"PostgreSQLCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\"displayName\":\"Azure PostgreSQL servers bring your own key data protection should be enabled\"}},\"SqlServerTDECMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"AuditIfNotExists\",\"Disabled\"],\"defaultValue\":\"AuditIfNotExists\",\"metadata\":{\"description\":\"Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\"displayName\":\"SQL servers should use customer-managed keys to encrypt data at rest\"}},\"StorageCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Secure your storage account with greater flexibility using customer-managed keys (CMKs). When you specify a CMK, that key is used to protect and control access to the key that encrypts your data. Using CMKs provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.\",\"displayName\":\"Storage accounts should use customer-managed key (CMK) for encryption, no deny as this would result in not able to create storage account because the first need of MSI for encryption\"}},\"StreamAnalyticsCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"audit\",\"deny\",\"disabled\"],\"defaultValue\":\"audit\",\"metadata\":{\"description\":\"Use customer-managed keys when you want to securely store any metadata and private data assets of your Stream Analytics jobs in your storage account. This gives you total control over how your Stream Analytics data is encrypted.\",\"displayName\":\"Azure Stream Analytics jobs should use customer-managed keys to encrypt data\"}},\"SynapseWorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Use customer-managed keys to control the encryption at rest of the data stored in Azure Synapse workspaces. Customer-managed keys deliver double encryption by adding a second layer of encryption on top of the default encryption with service-managed keys.\",\"displayName\":\"Azure Synapse workspaces should use customer-managed keys to encrypt data at rest\"}},\"WorkspaceCMKEffect\":{\"type\":\"String\",\"allowedValues\":[\"Audit\",\"Deny\",\"Disabled\"],\"defaultValue\":\"Audit\",\"metadata\":{\"description\":\"Manage encryption at rest of your Azure Machine Learning workspace data with customer-managed keys (CMK). By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/azureml-workspaces-cmk.\",\"displayName\":\"Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)\"}}}",
            "policy_definition_group": [],
            "policy_definition_reference": [
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('ACRCmkEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
                "policy_group_names": [],
                "reference_id": "ACRCmkDeny"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AksCmkEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
                "policy_group_names": [],
                "reference_id": "AksCmkDeny"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('WorkspaceCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
                "policy_group_names": [],
                "reference_id": "WorkspaceCMK"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CognitiveServicesCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
                "policy_group_names": [],
                "reference_id": "CognitiveServicesCMK"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('CosmosCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
                "policy_group_names": [],
                "reference_id": "CosmosCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('DataBoxCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/86efb160-8de7-451d-bc08-5d475b0aadae",
                "policy_group_names": [],
                "reference_id": "DataBoxCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StreamAnalyticsCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
                "policy_group_names": [],
                "reference_id": "StreamAnalyticsCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SynapseWorkspaceCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
                "policy_group_names": [],
                "reference_id": "SynapseWorkspaceCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('StorageCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
                "policy_group_names": [],
                "reference_id": "StorageCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('MySQLCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
                "policy_group_names": [],
                "reference_id": "MySQLCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('PostgreSQLCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
                "policy_group_names": [],
                "reference_id": "PostgreSQLCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('SqlServerTDECMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
                "policy_group_names": [],
                "reference_id": "SqlServerTDECMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('HealthcareAPIsCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119",
                "policy_group_names": [],
                "reference_id": "HealthcareAPIsCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('AzureBatchCMKEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/99e9ccd8-3db9-4592-b0d1-14b1715a4d8a",
                "policy_group_names": [],
                "reference_id": "AzureBatchCMKEffect"
              },
              {
                "parameter_values": "{\"effect\":{\"value\":\"[parameters('EncryptedVMDisksEffect')]\"}}",
                "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
                "policy_group_names": [],
                "reference_id": "EncryptedVMDisksEffect"
              }
            ],
            "policy_type": "Custom",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_private_dns_zone",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_private_dns_zone_virtual_network_link",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_public_ip",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "management",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "policy_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_role_definition",
      "name": "enterprise_scale",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/vcfes"
            ],
            "description": "Contributor role granted for application/operations team at resource group level",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8|/providers/Microsoft.Management/managementGroups/vcfes",
            "name": "[VCFES] Application-Owners",
            "permissions": [
              {
                "actions": [
                  "*"
                ],
                "data_actions": [],
                "not_actions": [
                  "Microsoft.Authorization/*/write",
                  "Microsoft.Network/publicIPAddresses/write",
                  "Microsoft.Network/virtualNetworks/write",
                  "Microsoft.KeyVault/locations/deletedVaults/purge/action"
                ],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "24206246-503f-51f2-b19d-2beb6a57fcb8",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/vcfes"
            ],
            "description": "Security Administrator role with a horizontal view across the entire Azure estate and the Azure Key Vault purge policy.",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d|/providers/Microsoft.Management/managementGroups/vcfes",
            "name": "[VCFES] Security-Operations",
            "permissions": [
              {
                "actions": [
                  "*/read",
                  "*/register/action",
                  "Microsoft.KeyVault/locations/deletedVaults/purge/action",
                  "Microsoft.PolicyInsights/*",
                  "Microsoft.Authorization/policyAssignments/*",
                  "Microsoft.Authorization/policyDefinitions/*",
                  "Microsoft.Authorization/policyExemptions/*",
                  "Microsoft.Authorization/policySetDefinitions/*",
                  "Microsoft.Insights/alertRules/*",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Security/*",
                  "Microsoft.Support/*"
                ],
                "data_actions": [],
                "not_actions": [],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "db98be45-ff1e-5a92-81fb-14fd94ec162d",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/vcfes"
            ],
            "description": "Platform-wide global connectivity management: virtual networks, UDRs, NSGs, NVAs, VPN, Azure ExpressRoute, and others",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a|/providers/Microsoft.Management/managementGroups/vcfes",
            "name": "[VCFES] Network-Management",
            "permissions": [
              {
                "actions": [
                  "*/read",
                  "Microsoft.Network/*",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Support/*"
                ],
                "data_actions": [],
                "not_actions": [],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "f9521a0d-afd3-581b-be01-62b7f06c2d2a",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/vcfes"
            ],
            "description": "Delegated role for subscription owner generated from subscription Owner role",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99|/providers/Microsoft.Management/managementGroups/vcfes",
            "name": "[VCFES] Subscription-Owner",
            "permissions": [
              {
                "actions": [
                  "*"
                ],
                "data_actions": [],
                "not_actions": [
                  "Microsoft.Authorization/*/write",
                  "Microsoft.Network/vpnGateways/*",
                  "Microsoft.Network/expressRouteCircuits/*",
                  "Microsoft.Network/routeTables/write",
                  "Microsoft.Network/vpnSites/*"
                ],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "fb0a57af-518e-57b6-98c0-62ab07f3ca99",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9",
          "schema_version": 1,
          "attributes": {
            "assignable_scopes": [
              "/providers/Microsoft.Management/managementGroups/vcfes"
            ],
            "description": "Enterprise-scale custom Role Definition. Grants full access to manage Virtual Network subnets, but no other network resources.",
            "id": "/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9|/providers/Microsoft.Management/managementGroups/vcfes",
            "name": "[VCFES] Network-Subnet-Contributor",
            "permissions": [
              {
                "actions": [
                  "Microsoft.Authorization/*/read",
                  "Microsoft.Insights/alertRules/*",
                  "Microsoft.ResourceHealth/availabilityStatuses/read",
                  "Microsoft.Resources/deployments/*",
                  "Microsoft.Resources/subscriptions/resourceGroups/read",
                  "Microsoft.Support/*",
                  "Microsoft.Network/*/read",
                  "Microsoft.Network/virtualNetworks/subnets/*"
                ],
                "data_actions": [],
                "not_actions": [],
                "not_data_actions": []
              }
            ],
            "role_definition_id": "fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9",
            "role_definition_resource_id": "/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjozNjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_subscription_template_deployment",
      "name": "telemetry_core",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "debug_level": "",
            "id": "/subscriptions/a9c7991e-521c-4532-93a9-5a37f82ccaed/providers/Microsoft.Resources/deployments/pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v2.3.1_0011_a46919ce",
            "location": "francecentral",
            "name": "pid-36dcde81-8c33-4da0-8dc3-265381502ccb_v2.3.1_0011_a46919ce",
            "output_content": "{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}}",
            "parameters_content": "{}",
            "tags": {},
            "template_content": "{\"$schema\":\"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\"contentVersion\":\"1.0.0.0\",\"outputs\":{\"telemetry\":{\"type\":\"String\",\"value\":\"For more information, see https://aka.ms/alz/tf/telemetry\"}},\"parameters\":{},\"resources\":[],\"variables\":{}}",
            "template_spec_version_id": "",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMDgwMDAwMDAwMDAwMCwiZGVsZXRlIjoxMDgwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEwODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.random_id.telem"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_hub",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_hub_connection",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_network",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_network_gateway",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_network_peering",
      "name": "connectivity",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_virtual_wan",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "azurerm_vpn_gateway",
      "name": "virtual_wan",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "random_id",
      "name": "telem",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "b64_std": "pGkZzg==",
            "b64_url": "pGkZzg",
            "byte_length": 4,
            "dec": "2758351310",
            "hex": "a46919ce",
            "id": "pGkZzg",
            "keepers": null,
            "prefix": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_management_group",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2022-09-18T14:24:39Z",
            "triggers": {
              "azurerm_management_group_level_1": "[\"/providers/Microsoft.Management/managementGroups/vcfes\",\"/providers/Microsoft.Management/managementGroups/vcfes-root\"]",
              "azurerm_management_group_level_2": "[\"/providers/Microsoft.Management/managementGroups/vcfes-decommissioned\",\"/providers/Microsoft.Management/managementGroups/vcfes-landing-zones\",\"/providers/Microsoft.Management/managementGroups/vcfes-platform\",\"/providers/Microsoft.Management/managementGroups/vcfes-sandboxes\"]",
              "azurerm_management_group_level_3": "[\"/providers/Microsoft.Management/managementGroups/vcfes-connectivity\",\"/providers/Microsoft.Management/managementGroups/vcfes-corp\",\"/providers/Microsoft.Management/managementGroups/vcfes-identity\",\"/providers/Microsoft.Management/managementGroups/vcfes-management\",\"/providers/Microsoft.Management/managementGroups/vcfes-online\"]",
              "azurerm_management_group_level_4": "[\"/providers/Microsoft.Management/managementGroups/vcfes-corp-non-prod\",\"/providers/Microsoft.Management/managementGroups/vcfes-corp-prod\",\"/providers/Microsoft.Management/managementGroups/vcfes-online-web\"]",
              "azurerm_management_group_level_5": "[]",
              "azurerm_management_group_level_6": "[]"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_policy_set_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "30s",
            "destroy_duration": "0s",
            "id": "2022-09-18T11:57:53Z",
            "triggers": {
              "azurerm_policy_set_definition_enterprise_scale": "[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deny-PublicPaaSEndpoints\",\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Diagnostics-LogAnalytics\",\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-MDFC-Config\",\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Private-DNS-Zones\",\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Deploy-Sql-Security\",\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-EncryptTransit\",\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policySetDefinitions/Enforce-Encryption-CMK\"]"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": []
    },
    {
      "module": "module.enterprise_scale",
      "mode": "managed",
      "type": "time_sleep",
      "name": "after_azurerm_role_definition",
      "provider": "provider[\"registry.terraform.io/hashicorp/time\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "create_duration": "60s",
            "destroy_duration": "0s",
            "id": "2022-09-18T11:54:51Z",
            "triggers": {
              "azurerm_role_definition_enterprise_scale": "[\"/providers/Microsoft.Authorization/roleDefinitions/24206246-503f-51f2-b19d-2beb6a57fcb8\",\"/providers/Microsoft.Authorization/roleDefinitions/db98be45-ff1e-5a92-81fb-14fd94ec162d\",\"/providers/Microsoft.Authorization/roleDefinitions/f9521a0d-afd3-581b-be01-62b7f06c2d2a\",\"/providers/Microsoft.Authorization/roleDefinitions/fb0a57af-518e-57b6-98c0-62ab07f3ca99\",\"/providers/Microsoft.Authorization/roleDefinitions/fc2537ed-c3fe-5b4f-9a2c-86895b0e3ca9\"]"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_role_definition.enterprise_scale",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/roleAssignments/028e4ae6-a922-5301-a205-e87a31f52028",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity/providers/Microsoft.Authorization/roleAssignments/028e4ae6-a922-5301-a205-e87a31f52028",
            "name": "028e4ae6-a922-5301-a205-e87a31f52028",
            "principal_id": "e3dca87c-4eda-4839-89a8-ea94a494eb06",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-connectivity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/3f191ce5-8482-58ee-a7c6-3e9b73c12bd7",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/3f191ce5-8482-58ee-a7c6-3e9b73c12bd7",
            "name": "3f191ce5-8482-58ee-a7c6-3e9b73c12bd7",
            "principal_id": "337397ea-629a-4e54-84ba-86f1b64a5aac",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
            "role_definition_name": "Backup Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/5917d705-5588-5e72-af0a-6839056caac1",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-identity/providers/Microsoft.Authorization/roleAssignments/5917d705-5588-5e72-af0a-6839056caac1",
            "name": "5917d705-5588-5e72-af0a-6839056caac1",
            "principal_id": "337397ea-629a-4e54-84ba-86f1b64a5aac",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-identity",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-AKS-Policy\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/10d0f6f2-2551-5965-80d0-788f9756b4e4",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/10d0f6f2-2551-5965-80d0-788f9756b4e4",
            "name": "10d0f6f2-2551-5965-80d0-788f9756b4e4",
            "principal_id": "2670d7f6-ade2-4981-a7db-8b96887c805a",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064",
            "role_definition_name": "Azure Kubernetes Service Policy Add-on Deployment",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/132d36b5-3244-5877-bc0f-eff7b5e025e8",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/132d36b5-3244-5877-bc0f-eff7b5e025e8",
            "name": "132d36b5-3244-5877-bc0f-eff7b5e025e8",
            "principal_id": "2670d7f6-ade2-4981-a7db-8b96887c805a",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8",
            "role_definition_name": "Azure Kubernetes Service Contributor Role",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-SQL-Threat\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/cceb009d-6f8c-5e2a-8a97-2ed5ba42d98a",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/cceb009d-6f8c-5e2a-8a97-2ed5ba42d98a",
            "name": "cceb009d-6f8c-5e2a-8a97-2ed5ba42d98a",
            "principal_id": "95fd991f-4b44-4632-9956-ec717353044f",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3",
            "role_definition_name": "SQL Security Manager",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Backup\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/3765ef65-d837-589b-bcb7-f80fd9e06ae5",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/3765ef65-d837-589b-bcb7-f80fd9e06ae5",
            "name": "3765ef65-d837-589b-bcb7-f80fd9e06ae5",
            "principal_id": "b41dd1e8-60ba-413d-8b9e-c730f7f66a8c",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/9d0082f2-c983-5321-b25e-f1e82e52dfdb",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/9d0082f2-c983-5321-b25e-f1e82e52dfdb",
            "name": "9d0082f2-c983-5321-b25e-f1e82e52dfdb",
            "principal_id": "b41dd1e8-60ba-413d-8b9e-c730f7f66a8c",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b",
            "role_definition_name": "Backup Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enable-DDoS-VNET\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/077a6b5a-1486-53b9-bf53-ccdc66e4c97d",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/077a6b5a-1486-53b9-bf53-ccdc66e4c97d",
            "name": "077a6b5a-1486-53b9-bf53-ccdc66e4c97d",
            "principal_id": "e5e508e4-16f8-4917-8d92-736b1713b736",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/policyAssignments/Enforce-TLS-SSL\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/386e08bd-4951-5610-8481-4efa031400b9",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones/providers/Microsoft.Authorization/roleAssignments/386e08bd-4951-5610-8481-4efa031400b9",
            "name": "386e08bd-4951-5610-8481-4efa031400b9",
            "principal_id": "3187194f-5bd4-417f-ad65-e0249d4d9b9b",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/8e3af657-a8ff-443c-a75c-2fe8c4bcb635",
            "role_definition_name": "Owner",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-landing-zones",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/policyAssignments/Deploy-Log-Analytics\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/roleAssignments/755732f5-ad4f-503f-8b6d-87a7eb9cf3c7",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes-management/providers/Microsoft.Authorization/roleAssignments/755732f5-ad4f-503f-8b6d-87a7eb9cf3c7",
            "name": "755732f5-ad4f-503f-8b6d-87a7eb9cf3c7",
            "principal_id": "446ee1d3-e350-49d8-8959-063aa4d2869f",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes-management",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-AzActivity-Log\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/016bfe06-1570-5466-b41b-60d812bd394c",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/016bfe06-1570-5466-b41b-60d812bd394c",
            "name": "016bfe06-1570-5466-b41b-60d812bd394c",
            "principal_id": "d6e1bc35-0ca2-4548-960c-7e0fd459f27c",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
            "role_definition_name": "Monitoring Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/4c06a3b1-cc33-5720-8e41-731989c6065f",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/4c06a3b1-cc33-5720-8e41-731989c6065f",
            "name": "4c06a3b1-cc33-5720-8e41-731989c6065f",
            "principal_id": "d6e1bc35-0ca2-4548-960c-7e0fd459f27c",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-LX-Arc-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/1ffdcdde-4093-5b0d-88a2-89a7dfa9e8d5",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/1ffdcdde-4093-5b0d-88a2-89a7dfa9e8d5",
            "name": "1ffdcdde-4093-5b0d-88a2-89a7dfa9e8d5",
            "principal_id": "326a98f6-e2ef-4a24-a680-4bfc73e4dd8a",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-MDFC-Config\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/91995f36-f926-55d1-beff-11f099a406c3",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/91995f36-f926-55d1-beff-11f099a406c3",
            "name": "91995f36-f926-55d1-beff-11f099a406c3",
            "principal_id": "d06972c8-86ed-4280-b446-1c6f06f7f49b",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/ccde9c1e-f66c-5db2-8b76-6b1aefce5725",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/ccde9c1e-f66c-5db2-8b76-6b1aefce5725",
            "name": "ccde9c1e-f66c-5db2-8b76-6b1aefce5725",
            "principal_id": "d06972c8-86ed-4280-b446-1c6f06f7f49b",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd",
            "role_definition_name": "Security Admin",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-Resource-Diag\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/384d3363-057a-5faf-8f04-1861554dd8b3",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/384d3363-057a-5faf-8f04-1861554dd8b3",
            "name": "384d3363-057a-5faf-8f04-1861554dd8b3",
            "principal_id": "149b5d6b-5dcf-4170-b8b6-068c64e65db1",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa",
            "role_definition_name": "Monitoring Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/7d7071a2-cea0-5785-8e35-bc134e360f1a",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/7d7071a2-cea0-5785-8e35-bc134e360f1a",
            "name": "7d7071a2-cea0-5785-8e35-bc134e360f1a",
            "principal_id": "149b5d6b-5dcf-4170-b8b6-068c64e65db1",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VM-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e1be750f-59c4-52f6-a958-c8508fe2c3f0",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e1be750f-59c4-52f6-a958-c8508fe2c3f0",
            "name": "e1be750f-59c4-52f6-a958-c8508fe2c3f0",
            "principal_id": "5f378ab8-6e7a-4757-b8f0-a31145b39f55",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-VMSS-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/bb1fb7b2-d6ad-548a-92d5-05e0104b0dcb",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/bb1fb7b2-d6ad-548a-92d5-05e0104b0dcb",
            "name": "bb1fb7b2-d6ad-548a-92d5-05e0104b0dcb",
            "principal_id": "1f6143ea-79c0-4005-a2d6-670ec56d86e6",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c",
            "role_definition_name": "Virtual Machine Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        },
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e825572c-42bd-5f1d-8c21-9a351b37b98e",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/e825572c-42bd-5f1d-8c21-9a351b37b98e",
            "name": "e825572c-42bd-5f1d-8c21-9a351b37b98e",
            "principal_id": "1f6143ea-79c0-4005-a2d6-670ec56d86e6",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    },
    {
      "module": "module.enterprise_scale.module.role_assignments_for_policy[\"/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/policyAssignments/Deploy-WS-Arc-Monitoring\"]",
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "for_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/869b0b16-638a-5689-8c10-396418361fce",
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/providers/Microsoft.Management/managementGroups/vcfes/providers/Microsoft.Authorization/roleAssignments/869b0b16-638a-5689-8c10-396418361fce",
            "name": "869b0b16-638a-5689-8c10-396418361fce",
            "principal_id": "d446ce0e-2340-49e3-8e98-014320208b3e",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293",
            "role_definition_name": "Log Analytics Contributor",
            "scope": "/providers/Microsoft.Management/managementGroups/vcfes",
            "skip_service_principal_aad_check": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current",
            "data.external.reconcile_susbscription_ids_from_management_groups",
            "data.terraform_remote_state.remote",
            "module.enterprise_scale.azurerm_management_group.level_1",
            "module.enterprise_scale.azurerm_management_group.level_2",
            "module.enterprise_scale.azurerm_management_group.level_3",
            "module.enterprise_scale.azurerm_management_group.level_4",
            "module.enterprise_scale.azurerm_management_group.level_5",
            "module.enterprise_scale.azurerm_management_group.level_6",
            "module.enterprise_scale.azurerm_management_group_policy_assignment.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_policy_set_definition.enterprise_scale",
            "module.enterprise_scale.azurerm_role_assignment.policy_assignment",
            "module.enterprise_scale.data.azurerm_policy_definition.external_lookup",
            "module.enterprise_scale.data.azurerm_policy_set_definition.external_lookup",
            "module.enterprise_scale.time_sleep.after_azurerm_management_group",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_assignment",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_definition",
            "module.enterprise_scale.time_sleep.after_azurerm_policy_set_definition"
          ]
        }
      ]
    }
  ]
}
